=====================================================================
* Evidence acquisition *
************************

Получение доказательств (Evidence acquisition)	-	критически важный этап в цифровой криминалистике, включающий сбор цифровых артефактов и данных из различных источников для сохранения потенциальных доказательств для анализа.
Этот процесс требует специализированных инструментов и методов для обеспечения целостности, подлинности и допустимости собранных доказательств.
Ниже приведен обзор методов получения доказательств, обычно используемых в цифровой криминалистике:

	-	Forensic Imaging
	-	Extracting Host-based Evidence & Rapid Triage
	-	Extracting Network Evidence

Чтож, давайте рассмотрим каждый из методов (в том числе на примерах)
Хочу сразу сказать, что утилиты, используемые в каждом методе могут быть как универсальны для других методов, так и специфичны для конкретного метода

	++++++++++++++++++++
	+ Forensic Imaging +
	++++++++++++++++++++

	Forensic imaging	-	это фундаментальный процесс в цифровой криминалистике, который включает в себя создание точной, побитовой копии цифровых носителей информации, таких как жесткие диски, твердотельные накопители, USB-накопители и карты памяти.
	Этот процесс имеет решающее значение для сохранения исходного состояния данных, обеспечения целостности данных и поддержания допустимости доказательств в судебных разбирательствах.
	Криминалистическая визуализация играет важную роль в расследованиях, позволяя аналитикам изучать доказательства, не изменяя и не ставя под угрозу исходные данные.

	Ниже приведены некоторые инструменты и решения для создания образов для Forensic imaging:

		-	FTK Imager
			Разработанная AccessData (теперь приобретен Exterro) GUI утилита
			FTK Imager является одним из наиболее широко используемых инструментов создания образов дисков в области кибербезопасности. 
			Он позволяет нам создавать идеальные копии (или образы) компьютерных дисков для анализа, сохраняя целостность доказательств.
			Также он позволяет просматривать и анализировать содержимое устройств хранения данных, не изменяя данные.

			Интеренет ресурсы:
	
				https://www.exterro.com/digital-forensics-software/ftk-imager
				https://www.exterro.com/ftk-product-downloads/ftk-imager-4-7-3-81
				https://www.exterro.com/digital-forensics-software/ftk-imager-temp
				https://medium.com/@tojopthomas/ftk-imager-5df0c870074

		-	AFF4 Imager
			Бесплатный инструмент с открытым исходным кодом, созданный для создания и дублирования образов дисков для судебной экспертизы.
			Он удобен в использовании и совместим с многочисленными файловыми системами.
			Преимуществом AFF4 Imager является его способность извлекать файлы на основе времени их создания, сегментировать тома и сокращать время, необходимое для создания образа, за счет сжатия.

			Интернет ресурсы:

				https://github.com/Velocidex/c-aff4
				https://www.magnetforensics.com/blog/aff4-aff4-l-an-open-standard-for-forensic-imaging/
				https://aff4-imager.readthedocs.io/en/latest/index.html
				https://www.forensicfocus.com/webinars/the-aff4-evidence-container-why-and-whats-next/

		-	DD и DCFLDD
			Оба являются утилитами командной строки, доступными в системах на базе Unix (включая Linux и MacOS).
			DD — это универсальный инструмент, включенный в большинство систем на базе Unix по умолчанию
			В то время как DCFLDD — это расширенная версия DD с функциями, специально полезными для судебной экспертизы, такими как хеширование.

		-	Virtualization Tools
			Учитывая распространенное использование виртуализации в современных системах, специалистам по реагированию на инциденты часто требуется собирать доказательства из виртуальных сред.
			В зависимости от конкретного решения виртуализации, доказательства можно собрать, временно остановив (halt not stop) систему и перенеся каталог, в котором они находятся.
			Другой метод — использовать возможность моментального снимка, присутствующую в многочисленных программных инструментах виртуализации.
			К примеру, образ виратульной машина на базе VMWare будет иметь расширение <file_name>.vmdk

		-	Arsenal Image Mounter
			GUI утилита, используемая для работы с образами жистких дисков (как правило для их монтажа)
			Arsenal Image Mounter монтирует содержимое образов дисков как полные (также известные как «физические» или «реальные») диски в Windows®, позволяя пользователям использовать такие специфичные для дисков функции, как:

				*	интеграция с Disk Manager
				*	запуск виртуальных машин (и затем обход аутентификации Windows и DPAPI)
				*	управление томами, защищенными BitLocker
				*	монтирование теневых копий томов и многое
				*	многое другое

			Интернет ресурсы:

				https://arsenalrecon.com/
				https://arsenalrecon.com/downloads
				https://arsenalrecon.com/products/arsenal-image-mounter

	Теперь рассмотрим это все на примерах

		///////////////////////////////////////////////////
		/// Example 1: Forensic Imaging with FTK Imager ///
		///////////////////////////////////////////////////

		Как было упомянуто выше, FTK Imager - это утилта в графической оболчке.
		Поэтому, для понимания дейсвтий, описанных в данном примере, Вам необходимо либо смотреть аналогичные youtube-видео, либо практиковаться на виртуальной машине

		Итак, приступим (запускаем FTK Imager)....
		
		Давайте рассмотрим использование FTK Imager для создания образа диска.
		!!!	Помните, что вам понадобится вспомогательный носитель, например внешний жесткий диск или USB-флеш-накопитель, чтобы сохранить полученный образ диска.
		
			1)	Select File -> Create Disk Image

			2)	Далее выберите источник носителя (media source).
				Обычно это либо физический диск, либо логический диск.

			3)	Выберите диск, с которого вы хотите создать образ.

			4)	Укажите место назначения изображения.
				Под полем "Image Destination(s)" необходимо нажать на кнопку Add

			5)	Выберите тип образа, в который вы хотите сохранить

			6)	Добавьте пояснительную информацию

			7)	Выберите папку назначения и имя файла для изображения.
				На этом этапе вы также можете настроить параметры фрагментации и сжатия изображения.

			8)	После подтверждения всех настроек нажмите кнопку «Start».
				Вы будете наблюдать ход процесса получения изображения.
				***	Если вы выбрали проверку изображения, вы также увидите ход проверки.

			9)	После проверки изображения вы получите сводку изображений.
				Теперь вы готовы проанализировать этот дамп.

		///////////////////////////////////////////////////////////////////
		/// Example 2: Mounting a Disk Image with Arsenal Image Mounter ///
		///////////////////////////////////////////////////////////////////

		Давайте теперь посмотрим демонстрацию использования Arsenal Image Mounter для монтирования образа диска из скомпрометированной виртуальной машины (ВМ), работающей на VMWare.
		Виртуальный жесткий диск ВМ был сохранен как <file_name>.vmdk
		***	После установки Arsenal Image Mounter давайте убедимся, что мы запускаем его с правами администратора.
		
			1)	В главном окне Arsenal Image Mounter нажмите кнопку Mount disk image.

			2)	Оттуда мы перейдем к местоположению нашего файла .VMDK и выберем его.

			3)	После чего Arsenal Image Mounter начнет анализ файла VMDK.
				У нас также будет возможность решить, хотим ли мы смонтировать диск как "read-only" или "read-write", в зависимости от наших конкретных требований.

				Выбор монтирования образа диска как "read-only" является основополагающим шагом в цифровой криминалистике и реагировании на инциденты.
				Этот подход жизненно важен для сохранения исходного состояния доказательств, гарантируя, что их подлинность и целостность останутся нетронутыми.

			4)	После монтирования, образ будет отображаться как диск, которому будет присвоена буква (к примеру - D:\)

	+++++++++++++++++++++++++++++++++++++++++++++++++
	+ Extracting Host-based Evidence & Rapid Triage +
	+++++++++++++++++++++++++++++++++++++++++++++++++

	Хотя, изначально этот метод был указан как один целый, но в действительности он состоит из 2 отдельных:

		A)	Host-based Evidence

		B)	Rapid Triage

	Поэтому разберем их по отдельности

		A - 	Host-based Evidence

		Современные операционные системы, ярким примером которых является Microsoft Windows, генерируют множество артефактов доказательств.
		Они могут возникать в результате выполнения приложений, изменения файлов или даже создания учетных записей пользователей.
		Каждое из этих действий оставляет след, предоставляя бесценную информацию для аналитиков реагирования на инциденты.

		Доказательства в хост-системе различаются по своей природе.
		Термин «volatility» относится к сохранению данных в хост-системе
		Причем volatility данные — это информация, которая исчезает после таких событий, как выход из системы или отключение питания.
		
		Одним из важнейших типов изменчивых доказательств является активная память системы.
		Во время расследований, особенно тех, которые касаются заражения вредоносным ПО, эта оперативная системная память становится незаменимой.
		Вредоносное ПО часто оставляет следы в системной памяти, и потеря этих доказательств может помешать расследованию аналитика.
		Для захвата памяти обычно используются такие инструменты, как FTK Imager.

		Тем не менее существуют и другие утилиты, направленные на работу с памятью (любой) хоста:

			-	WinPmem
				WinPmem долгое время был драйвером захвата памяти с открытым исходным кодом по умолчанию для Windows.
				Раньше он находился в проекте Rekall, но недавно был выделен в собственный репозиторий.

				Интеренет ресурсы:
			
					https://github.com/Velocidex/WinPmem
					https://rekall.readthedocs.io/en/gh-pages/Tools/pmem.html
					https://medium.com/@cyberforensicator57/capturing-memory-dump-using-winpmem-5e1eb29c811d
					https://www.cdaitsolutions.com/blog/winpmem-is-a-memory-acquisition-tool
					
					
			-	DumpIt
				Простая утилита, которая генерирует дамп физической памяти машин Windows и Linux.
				В Windows он объединяет физическую память 32- и 64-разрядной системы в один выходной файл, что делает его чрезвычайно простым в использовании.

				Интернет ресурсы:

					https://www.magnetforensics.com/resources/magnet-dumpit-for-windows/
					https://github.com/MagnetForensics/dumpit-linux
					https://cyberliza.medium.com/tuesdaytool-10-dumpit-for-memory-dump-95b7e30445ce
					https://www.iblue.team/memory-forensics-1/acquisition/dumpit
					
			-	MemDump
				Это бесплатная, простая утилита командной строки, которая позволяет нам захватывать содержимое оперативной памяти системы.
				Она весьма полезна в криминалистических расследованиях или при анализе системы на предмет вредоносной активности.
				Ее простота и удобство использования делают ее популярным выбором для захвата памяти.

				Интеренет ресурсы:
	
					https://www.kali.org/tools/memdump/
					http://www.nirsoft.net/utils/nircmd.html
					
					
			-	Belkasoft RAM Capturer
				Это еще один мощный инструмент, который мы можем использовать для захвата памяти, предоставляемый бесплатно компанией Belkasoft.
				Он может захватывать оперативную память работающего компьютера Windows, даже если есть активная защита от отладки или от дампа.
				Это делает его высокоэффективным инструментом для извлечения как можно большего количества данных во время оперативного судебного расследования.

				Интеренет ресурсы:
	
					https://github.com/mikebdp2/ram-capturer
					https://belkasoft.com/ram-capturer
					https://belkasoft.com/ram-dumping-tool-selection
					https://mahim-firoj.medium.com/windows-memory-capture-using-belkasoft-live-ram-capture-free-tool-3d695ed10d34
					
					
			-	Magnet RAM Capture
				Разработанный Magnet Forensics, этот инструмент предоставляет бесплатный и простой способ захвата энергозависимой памяти системы.

				Интеренет ресурсы:

					https://www.magnetforensics.com/free-tools/
					https://www.magnetforensics.com/resources/magnet-ram-capture/
					https://medium.com/@cyberforensicator57/how-to-capture-memory-dump-magnet-forensics-way-fb61305f3a03
					https://arcticwolf.com/resources/blog/lorenz-ransomware-getting-dumped/
					
					
			-	LiME (Linux Memory Extractor)
				LiME — это загружаемый модуль ядра (LKM), который позволяет извлекать энергозависимую память. LiME уникален

				Интерент ресурсы:

					https://github.com/504ensicsLabs/LiME
					https://levelblue.com/blogs/security-essentials/memory-dump-analysis-using-lime-for-acquisition-and-volatility-for-initial-setup
					https://medium.com/@DefenderX/linux-memory-acquisition-with-lime-ddb04cb9e638
					https://medium.com/@KANIKA_VERMA/how-to-read-entire-ram-using-lime-d2ae85a75ec1
		
		Теперь рассмотрим это все на примерах

			////////////////////////////////////////////////
			/// Example 1: Acquiring Memory with WinPmem ///
			////////////////////////////////////////////////

			Давайте теперь посмотрим демонстрацию использования WinPmem для получения памяти.
			
			Чтобы создать дамп памяти, просто выполните команду ниже с правами администратора.

				C:\Users\user_name> C:\where\the\tool\located\is\winpmem_mini_x64_rc2.exe C:\where\the\memory_dump_file\located\is\memdump.raw

			//////////////////////////////////////
			/// Example 2: Acquiring VM Memory ///
			//////////////////////////////////////

			Вот шаги для получения памяти из виртуальной машины (ВМ).

				-	Open the running VM's options
				-	SUSPEND the running VM
				-	Locate the .vmem file inside the VM's directory.

			С другой стороны, энергонезависимые данные остаются на жестком диске, как правило, сохраняясь при выключениях.
			Эта категория включает такие артефакты, как:

				-	Реестр
				-	Журнал событий Windows
				-	Артефакты, связанные с системой (например, Prefetch, Amcache)
				-	Артефакты, специфичные для приложений (например, журналы IIS, история браузера)

		B - 	Rapid Triage

		Этот подход делает акцент на сборе данных из потенциально скомпрометированных систем.
		Цель состоит в том, чтобы централизовать высокоценные данные, упростив их индексацию и анализ.
		Централизуя эти данные, аналитики могут более эффективно развертывать инструменты и методы, оттачивая системы с наибольшей доказательной ценностью.
		Этот целевой подход позволяет глубже погрузиться в цифровую криминалистику, предлагая более четкую картину действий противника.
	
		Ниже представлены две утилиты, наиболее часто используемые в данном подходе:
		***	Каждая утилита будет рассмотренная более подробном в отдельном обзоре

			-	KAPE (Kroll Artifact Parser and Extractor)
				Используется для анализа и извлечения артефакты цифровой экспертизы Windows.

			-	Velociraptor
				Позволяют удаленно получать и анализировать цифровые доказательства
