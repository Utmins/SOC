Компьютерная криминалистика — это важная область кибербезопасности, которая включает сбор доказательств действий, выполняемых на компьютерах.
Она является частью более широкой области цифровой криминалистики, которая занимается криминалистическим анализом всех типов цифровых устройств, включая восстановление, изучение и анализ данных, обнаруженных на цифровых устройствах.
Применение цифровой и компьютерной криминалистики широко: от юридической сферы, где она используется для подтверждения или опровержения гипотезы в гражданском или уголовном деле, до частной сферы, где она помогает во внутренних корпоративных расследованиях и анализе инцидентов и вторжений.

Идеальным примером раскрытия уголовного дела с помощью цифровой криминалистики является дело серийного убийцы BTK.
Это дело было заморожено более десяти лет назад, когда убийца начал издеваться над полицией, отправляя письма.
Дело приняло серьезный оборот, когда он отправил дискету на местную новостную станцию, которая позже была принята полицией в качестве доказательства.
Полиции удалось восстановить удаленный документ Word на диске, и с помощью метаданных и некоторых других доказательств они вычислили и арестовали его.

=====================================================================
* General *
***********

DFIR (Digital Forensics and Incident Response)  -   цифровая криминалистика и реагирование на инциденты.
Эта область охватывает сбор криминалистических артефактов с цифровых устройств, таких как компьютеры, медиаустройства и смартфоны, для расследования инцидента.
Эта область помогает специалистам по безопасности идентифицировать следы, оставленные злоумышленником при возникновении инцидента безопасности, использовать их для определения степени компрометации среды и восстанавливать среду до состояния, в котором она была до инцидента.

DFIR помогает специалистам по безопасности различными способами, некоторые из которых кратко изложены ниже:

    -   Поиск доказательств активности злоумышленника в сети и отсеивание ложных тревог от реальных инцидентов.
    -   Надежное устранение злоумышленника, чтобы его опора в сети больше не оставалась.
    -   Определение масштаба и временных рамок нарушения.
        Это помогает в общении с соответствующими заинтересованными сторонами.
    -   Нахождение лазеек, которые привели к нарушению. Что необходимо изменить, чтобы избежать нарушения в будущем?
    -   Понимание поведения злоумышленника для превентивного блокирования дальнейших попыток вторжения со стороны злоумышленника.
    -   Обмен информацией о злоумышленнике с сообществом.

DFIR требует опыта как в цифровой криминалистике, так и в реагировании на инциденты.
Чтобы стать профессионалом DFIR, необходимы следующие навыки:

    -   Цифровая криминалистика
        Эти специалисты являются экспертами в идентификации криминалистических артефактов или доказательств человеческой деятельности в цифровых устройствах.

    -   Реагирование на инциденты
        Специалисты по реагированию на инциденты являются экспертами в области кибербезопасности и используют криминалистическую информацию для определения интересующей активности с точки зрения безопасности.

Области цифровой криминалистики и реагирования на инциденты часто объединяются, поскольку они сильно взаимозависимы.
Реагирование на инциденты использует знания, полученные из цифровой криминалистики.
Аналогичным образом, цифровая криминалистика берет свои цели и область действия из процесса реагирования на инциденты, а процесс IR определяет объем криминалистического расследования.

=====================================================================
* Basic Concept *
*****************

    ++++++++++++++++++++++++++++++
    + Artifacts / Доказательства +
    ++++++++++++++++++++++++++++++

    Артефакты — это важные фрагменты информации, которые предоставляют доказательства человеческой деятельности.
    Они объединяются, чтобы воссоздать историю того, как было совершено преступление.
    В компьютерной криминалистике судебные артефакты могут быть небольшими следами деятельности, оставленными в компьютерной системе.

    При выполнении DFIR артефакты собираются для поддержки гипотезы или утверждения о действиях злоумышленника.
    Например, если мы хотим заявить, что злоумышленник использовал ключи реестра Windows для поддержания персистентности в системе, мы можем использовать указанный ключ реестра для поддержки нашего утверждения.
    В этом случае указанный ключ реестра будет считаться артефактом.
    Таким образом, сбор артефактов является неотъемлемой частью процесса DFIR.
    Артефакты могут быть собраны из файловой системы, памяти или сетевой активности конечной точки или сервера.

    В большинстве случаев корпоративные среды в основном состоят из операционных систем Windows и Linux.
    Системы Windows в основном используются для конечных точек и серверных вариантов использования, таких как контроллеры домена Active Directory или почтовые серверы MS Exchange.
    Предприятия в основном используют системы Linux в качестве серверов, на которых размещаются некоторые службы, например, веб-серверы или серверы баз данных.

    +++++++++++++++++++++++++++++++++++++++++++++++++++++
    + Evidence Preservation / Сохранение доказательств: +
    +++++++++++++++++++++++++++++++++++++++++++++++++++++

    При выполнении DFIR мы должны поддерживать целостность собираемых нами доказательств.
    По этой причине в отрасли установлены определенные передовые практики.
    
    !!! Мы должны отметить, что любой криминалистический анализ загрязняет доказательства.
    Поэтому доказательства сначала собираются и защищаются от записи.
    Затем для анализа используется копия защищенного от записи доказательства.
    Этот процесс гарантирует, что наши исходные доказательства не будут загрязнены и останутся в безопасности во время анализа.
    Если наша расследуемая копия будет повреждена, мы всегда можем вернуться и сделать новую копию с сохраненных нами доказательств.

    +++++++++++++++++++++++++++++++++++++++
    + Chain of custody / Цепочка Хранения +
    +++++++++++++++++++++++++++++++++++++++

    Еше одним важным аспектом поддержания целостности доказательств является цепочка хранения.
    Когда доказательства собраны, необходимо убедиться, что они хранятся в надежном месте.
    Ни одно лицо, не связанное со следствием, не должно владеть доказательствами, иначе это загрязнит цепочку хранения доказательств.
    
    Загрязненная цепочка хранения поднимает вопросы о целостности данных и ослабляет выстраиваемое дело, добавляя неизвестные переменные, которые невозможно решить.
    Например, предположим, что образ жесткого диска, передаваемый от человека, который сделал образ, человеку, который будет выполнять анализ, попадает в руки человека, который не имеет квалификации для работы с такими доказательствами.
    В этом случае мы не можем быть уверены, что он правильно обошелся с доказательствами и, следовательно, не загрязнил доказательства своей деятельностью.

    ++++++++++++++++++++++++++++++++++++++++++++++
    + Order of volatility / Порядок Изменчивости +
    ++++++++++++++++++++++++++++++++++++++++++++++

    Цифровые доказательства часто изменчивы, т. е. могут быть утеряны навсегда, если не будут захвачены вовремя.
    Например, данные в памяти компьютерной системы (ОЗУ) будут утеряны при выключении компьютера, поскольку ОЗУ хранит данные только до тех пор, пока он остается включенным.
    
    Некоторые источники более изменчивы по сравнению с другими.
    Например, жесткий диск является постоянным хранилищем и сохраняет данные даже при отключении питания.
    Поэтому жесткий диск менее изменчив, чем ОЗУ.
    
    При выполнении DFIR важно понимать порядок изменчивости различных источников доказательств, чтобы захватить и сохранить их соответствующим образом.
    В приведенном выше примере нам нужно будет сохранить ОЗУ перед сохранением жесткого диска, поскольку мы можем потерять данные в ОЗУ, если не приоритезируем их.

    ++++++++++++++++++++++++++++++++++++++++++++++++
    + Timeline creation / Временнаяю шкала событий +
    ++++++++++++++++++++++++++++++++++++++++++++++++

    После того, как мы собрали артефакты и сохранили их целостность, нам нужно представить их в понятной форме, чтобы полностью использовать содержащуюся в них информацию.
    Для эффективного и точного анализа необходимо создать временную шкалу событий.
    Эта временная шкала событий располагает все действия в хронологическом порядке.
    Это действие называется созданием временной шкалы.
    
    Создание временной шкалы обеспечивает перспективу расследования и помогает сопоставлять информацию из различных источников, чтобы создать историю о том, как все произошло.

    Теперь давайте посмотрим прикрепленный статический сайт, чтобы попрактиковаться в создании временной шкалы и ответить на первый вопрос.
    Для этого нажмите кнопку «Просмотреть сайт» в правом верхнем углу этого

=====================================================================
* Incident Response Process *
*****************************

В операциях по обеспечению безопасности цифровая криминалистика в основном используется для реагирования на инциденты.
Мы изучим процесс реагирования на инциденты и посмотрим, как цифровая криминалистика помогает в процессе IR в этой задаче.

Различные организации опубликовали стандартизированные методы реагирования на инциденты.
NIST определил процесс в своем руководстве по обработке инцидентов SP-800-61, которое содержит следующие шаги:
*** https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf

    1)  Preparation (Подготовка)
    2)  Detection and Analysis (Обнаружение и анализ)
    3)  Containment, Eradication, and Recovery (Сдерживание, ликвидация и восстановление)
    4)  Post-incident Activity (Действия после инцидента)

Аналогичным образом SANS опубликовала руководство по урегулированию инцидентов.
Руководство определяет шаги следующим образом:
*** https://www.sans.org/white-papers/33901/

    1)  Preparation (Подготовка)
    2)  Identification (Идентификация)
    3)  Containment (Сдерживание)
    4)  Eradication (Искоренение)
    5)  Recovery (Восстановление)
    6)  Lessons Learned (Извлеченные уроки)

Шаги, определенные SANS, часто суммируются в виде аббревиатуры PICERL, что облегчает их запоминание.
Мы видим, что шаги, указанные SANS и NIST, идентичны.
В то время как NIST объединяет сдерживание, ликвидацию и восстановление, SANS разделяет их на разные шаги.
Действия после инцидента и извлеченные уроки могут быть сопоставимы, в то время как идентификация и обнаружение и анализ имеют одинаковые последствия.

Мы объясним шаги PICERL, поскольку их легче запомнить по аббревиатуре 

    1)  Preparation / Подготовка
        Перед тем, как произойдет инцидент, необходимо подготовиться, чтобы все были готовы к нему.
        Подготовка включает в себя наличие необходимых людей, процессов и технологий для предотвращения и реагирования на инциденты.

    2)  ИIdentification / дентификация
        Инцидент идентифицируется с помощью некоторых индикаторов на этапе идентификации.
        Затем эти индикаторы анализируются на предмет ложных срабатываний, документируются и сообщаются соответствующим заинтересованным сторонам.

    3)  Containment / Сдерживание
        На этом этапе инцидент сдерживается и прилагаются усилия для ограничения его последствий.
        Могут быть краткосрочные и долгосрочные исправления для сдерживания угрозы на основе судебно-медицинского анализа инцидента, который будет частью этого этапа.

    4)  Eradicatio / Искоренение
        Затем угроза искореняется из сети.
        Необходимо обеспечить проведение надлежащего судебно-медицинского анализа и эффективное сдерживание угрозы перед ее искоренением.
        Например, если точка входа субъекта угрозы в сеть не заблокирована, угроза не будет эффективно искоренена, и субъект может снова закрепиться.
    
    5)  Recover / Восстановление
        После устранения угрозы из сети нарушенные службы возвращаются в состояние, в котором они были до инцидента.

    6)  Lessons Learned / Извлеченные уроки
        Наконец, проводится обзор инцидента, инцидент документируется, и на основе результатов инцидента предпринимаются шаги, чтобы убедиться, что команда лучше подготовлена ​​к следующему инциденту.

=====================================================================
* Disc Forensic *
*****************

Как мы уже знаем, крайне важно тщательно изучать каждый байт, чтобы обнаружить едва заметные следы, оставленные киберпреступниками.
Криминалистику данных ограничена не только анализом энергозависимой памяти, но также распространяется на устройства постояенного хранения, т.е. дисков (исследование и анализ образов дисков).

Многие инструменты криминалистики дисков, как коммерческие, так и с открытым исходным кодом, оснащены множеством функций.
Однако для групп реагирования на инциденты выделяются некоторые функции:

	-	Понимание структуры файлов
		Возможность навигации и просмотра файловой иерархии диска имеет решающее значение.
		Инструменты криминалистики высшего уровня должны отображать эту структуру, обеспечивая быстрый доступ к определенным файлам, особенно в известных местах на подозрительной системе.

	-	Hex Viewer
		Для тех моментов, когда вам нужно близко познакомиться с вашими данными, просмотр файлов в шестнадцатеричном формате имеет важное значение.
		Эта возможность особенно удобна при работе с такими угрозами, как специально разработанное вредоносное ПО или уникальные эксплойты.

	-	Анализ веб-артефактов
		При большом количестве пользовательских данных, связанных с веб-активностью, криминалистический инструмент должен эффективно просеивать и представлять эти данные.
		Это меняет правила игры, когда вы собираете воедино события, ведущие к попаданию пользователя на вредоносный веб-сайт.

	-	Анализ электронных писем
		Иногда след ведет к внутренним угрозам.
		Возможно, это мошенник или просто кто-то, кто оступился.
		В таких случаях электронные письма часто являются ключом.
		Инструмент, который может извлекать и представлять эти данные, оптимизирует процесс, облегчая соединение точек.

	-	Просмотр изображений
		Иногда изображения, хранящиеся в системах, могут рассказать свою собственную историю.
		Будь то для проверки политики или более глубокого погружения, наличие встроенного просмотрщика является благом.

	-	Анализ метаданных
		Такие детали, как временные метки создания файлов, хэши и расположение на диске, могут быть бесценными.
		Рассмотрим сценарий, в котором вы пытаетесь сопоставить время запуска приложения с предупреждением о вредоносном ПО.
		Такие корреляции могут стать стержнем вашего расследования.

Одной из самых удобных программ (для пользователя) для судебной экспертизы, созданную на основе набора инструментов Sleuth Kit с открытым исходным кодом, является Аy
Она отражает многие функции, которые вы найдете в ее коммерческих аналогах:

	-	оценки временной шкалы
	-	поиск ключевых слов
	-	поиск артефактов в Интернете и электронной почте
	-	а также возможность просеивать результаты на основе известных вредоносных хэшей файлов.