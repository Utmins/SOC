#  BRUTUS
  Сценарий посвящён расследованию взлома сервера Confluence через SSH-брутфорс.
  Злоумышленник использовал массовые попытки подбора пароля, в результате чего получил доступ к root-учётке и создал нового пользователя с привилегиями.
  Анализ строится на сопоставлении двух ключевых артефактов — auth.log и wtmp, что позволяет определить IP-адрес атакующего, имя скомпрометированного пользователя, время успешного входа и действия после эскалации.
  Подчёркивается необходимость перекрёстной проверки улик из разных журналов и демонстрация важности фиксации результатов.
  Сценарий также связывает практику с MITRE ATT&CK, показывая, как классифицировать технику «создание локальной учётной записи»

  Журналы и артефакты:

    - auth.log — события аутентификации: успешные/неуспешные входы, использование sudo, создание пользователей.
    - wtmp — история пользовательских сессий, подтверждающая реальное подключение и завершение сеансов.
    - JSONL-версии логов — результат парсинга через скрипты для более удобного анализа (jq).

  Инструменты:

    - grep / awk / sed / sort / uniq — фильтрация и обработка строк в логах.
    - Py3Grok Parser — преобразование логов в JSONL с шаблонами Syslog.
    - jq — извлечение и агрегация данных из JSONL-файлов.
    - last / utmp.py — анализ wtmp и преобразование в удобный формат.

#  Unit42 (UltraVNC Backdoor Investigation)
  Сценарий основан на исследовании Unit42 (Palo Alto Networks), где злоумышленники использовали модифицированную версию UltraVNC с бэкдором для доступа к системам.
  В центре внимания — анализ журналов Sysmon, позволяющий выявить процессы, связанные с вредоносной активностью, изменения временных меток файлов, сетевые соединения и DNS-запросы.
  Основные задачи включают:
    - идентификацию вредоносного процесса
    - обнаружение источника его загрузки (облачный сервис или сайт)
    - фиксацию попыток маскировки через time stomping
    - а также определение доменов и IP-адресов, к которым выполнялись подключения.
  
  Важным элементом сценария является перекрёстная проверка улик из разных событий и ведение заметок для полноты картины расследования

  Журналы и артефакты:
    
    - Sysmon Event ID 1 — создание процессов.
    - Sysmon Event ID 2 — изменение времени создания файла (time stomping).
    - Sysmon Event ID 3 — сетевые подключения.
    - Sysmon Event ID 5 — завершение процессов.
    - Sysmon Event ID 11 — создание файлов.
    - Sysmon Event ID 22 — DNS-запросы.

  Инструменты:

    - EvtxECmd — экспорт журналов EVTX в удобный формат (CSV, JSON, XML).
    - Timeline Explorer — графический просмотр и фильтрация событий (CSV).
    - Event Viewer — встроенный инструмент Windows для анализа логов.

#   SmartyPants (RDP Intrusion & SmartScreen Analysis)
  Сценарий описывает компрометацию файлового сервера Forela, где злоумышленник получил доступ через RDP, загрузил несколько утилит для дальнейших действий, похитил и уничтожил критические файлы, а затем очистил журналы, скрывая следы.
  Основной источник данных — обширные Windows Event Logs (*.evtx), среди которых ключевыми для анализа являются:
    - Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational
    - Smartscreen Debug
    - Security.
  Основные задачи включают идентификацию временной метки RDP-входа, определение загруженных злоумышленником утилит и фиксацию момента очистки журналов.
  Подчёркивается необходимость перекрёстного сопоставления улик между разными логами, чтобы надёжно подтвердить действия атакующего и отследить их во времени

  Журналы и артефакты:

    - Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational — фиксация RDP-сессий.
    - Smartscreen Debug — загрузка и запуск приложений, подозрительные исполняемые файлы.
    - Security — события безопасности, включая очистку журналов.

  Инструменты:

    - EvtxECmd — экспорт и парсинг EVTX-журналов в CSV/JSON/XML для дальнейшей обработки.
    - Timeline Explorer — фильтрация и анализ больших CSV-логов.
    - Event Viewer — встроенный просмотрщик Windows для ручного анализа событий.

#  SCRIPTS
  Сборник различных скриптов, используемых при решении данных сценариев:

    -  Brutus:  LogGrok.py & utmp.py
