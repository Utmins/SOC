=====================================================================
* Легенда *
***********
У нашего клиента есть недавно нанятый сотрудник, который увидел подозрительного уборщика, выходящего из его офиса, когда он собирался вернуться с обеда.
Необходимо выяснить, была ли активность пользователя, пока пользователь отсутствовал с 12:05 до 12:45 19 ноября 2022 года.
Если да, выясните, к каким файлам был получен доступ и какие файлы были извлечены извне.

Вы будете получать доступ к работающей системе, но используйте образ диска, уже экспортированный в каталог C:\Users\THM-RFedora\Desktop\kape-results\C для вашего расследования.
Ссылка на инструменты, которые вам понадобятся, находится в C:\Users\THM-RFedora\Desktop\tools

=====================================================================
* Список инструментов *
***********************

В данном тестовом задании мы будем использовать следующие инструменты DFIR:

    -   Registry Explorer
    -   Autopsy
    -   JLECmd.exe
    -   KAPE
    -   EZviewer

=====================================================================
* Вопросы *
***********

1)  What file type was searched for using the search bar in Windows Explorer?
    Какой тип файла искался с помощью строки поиска в проводнике Windows?

    Подсказка   -   Используйте инструмент Registry Explorer для проверки «Windows Explorer Address/Search Bars».

        i)      Для ответа на данный вопрос испольщуем утилиту Registry Viewer
                А также образ улья NTUSED.dat (при желании можно и прогрядет логи данного улья - ntuser.dat.LOG#)
        
        ii)     Используя подсказку и Windows Registry Forensic Cheatsheet проверяем следующие разделы улья
                *** В реальном кейсе Вам придется проверять чуть ли не все разделы улья

                    -   NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths
                    -   NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery
        
        iii)    Выбрав любой из представленных файлов, кликаем правой кнопкой мыши и выбираем меню  -   Data Interpreter

        iv)     В появившемся окне ищучаем содержание раздела "Strings"

        v)      Ответ   -   .pdf
                

2)  What top-secret keyword was searched for using the search bar in Windows Explorer?
    Какое ключевое слово искалось с помощью строки поиска в проводнике Windows?

    Используя шаги и информацию из первого вопроса, получаем ответ на второй вопрос

        vi)     Ответ   -    continental

3)  What is the name of the downloaded file to the Downloads folder?
    Как называется загруженный файл в папку «Загрузки»?

    Подсказка   -   Используйте Autopsy tool для просмотра артефактов «Web Downloads».

        i)      Для ответа на данный вопрос испольщуем утилиту Autopsy
                        
        ii)     Так как  Windows Registry Forensic Cheatsheet не содержит информации в каком разделе реестра (улье) можно найти скачанные файлы, то загружаем весь диск "С"
                При использовании Autopsy Tool вы можете ускорить время загрузки, выбрав только «Recent Activities» при настройке параметров Ingest
        
        iii)    После того, как все данные будут згражены, переходим в раздел "Data Artifacts" и выбираем "Web Downloads"
                Нам нужно найти файл, который соответвует временному промежутку, указанному в задании
                А именно - с 12:05 до 12:45 19 ноября 2022 года
        
        iv)     Ответ   -   7z2201-x64.exe

4)  Thanks to the previously downloaded file, a PNG file was opened. When was this file opened? (YYYY-MM-DD HH:MM:SS)
    Благодаря ранее загруженному файлу был открыт файл PNG. Когда был открыт этот файл? (YYYY-MM-DD HH:MM:SS)

    Подсказка   -   Фильтровать файлы по расширению можно с помощью инструмента Registry Explorer.

        v)      Переходим в утилиту Registry Viewer

        vi)     Ище в улье отвечающим за Recent Files

                    -   NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
        
        vii)    А так как мы знаем, что был открыт файл с раширением PNG, то проверяем соответствующий каталог улья
                Колонка - Last Write Timestamp и будет содержать необходимую нам информацию

        viii)   Ответ   -   2022–11–19 12:10:21

        
5)  A text file was created in the Desktop folder. How many times was this file opened?
    В папке «Рабочий стол» был создан текстовый файл. Сколько раз открывался этот файл?

    Подсказка   -   Проверьте списки переходов машины с помощью инструмента JLECmd.exe.

        i)      Тут нам понядобится утилиты JLECmd и EZviewer
        
        ii)     Чтобы выяснить детальную информацию о недавно использованных файла, нам надо знать в какой папке улья могут храниться данные о таких файлах
                Они хранятся В

                    -   C:\Users\<имя пользователя>\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations
        
        iii)    Запускаем командную строку с правами администратора
                И переходим в папку, где находится утилита JLECmd

        iv)     Также, не забываем создать папку, куда будут сохранятся полученные, в результате анализа, данные
                Мы их будем созранять в формате CSV, хотя вы можете выбрать другой формат
        
        v)      В командной строке запускаем следующую команду

                    JLECmd.exe -d <path-to-Jumplist-directory> --csv <path-to-save-csv>
        
        vi)     После создания файла с результатами, запускаем утилиту EZviewer и изучаем полученные данные с ее помощью

        vii)    Ответ   -   2

6)  The contents of the file were exfiltrated to pastebin.com. What is the generated URL of the exfiltrated data?
    Содержимое файла было выкачано на pastebin.com. Каков сгенерированный URL выкаченных данных?

    Подсказка   -   Используйте инструмент Autopsy для проверки «IE/Edge History» целевой машины.

        i)      Как уже понятно из подсказки, нам понадобиться утилита Autopsy и немного логического анализа

        ii)     Все информация о посещаемых страницах находится по адресу

                    -   C:\Users\<имя пользователя>\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat
                
                Но, так как мы изначально загрузили образ всего жетского диска, то нам нет нужды загружать этот файл и мы можем идити дальше
        
        iii)    Для просмотра посещенных интеренет ресурсов передодим в раздел "Data Artifacts" и выбираем "Web History"

        iv)     Чтобы не просматривать каждую запись, мы сортируем по дате обращения "Date Accessed"
                И изучаем события за интересующий нас период
                Логически, они должны идти одно за другим
        
        v)      Сперва находим запись, указывающую на обращение в файлу, который был загружен (ну или любому другому заинтересовавшему нас файлу)
                Затем просматриваем последующие события на предмет взаимосвязей
                *** Если локальный файл был запрошем внешним ресурсом, то во вкладке "Data Artifacts", выбранного файла, в разделе "Visit Details", значение поля "URL" будет начинаться с file:///
        
        vi)     А запись предшествующая этому, будет содержать название внешнего ресурсам
                
        vii)    Выясним название внешнего ресурса, мы можем провести анализ на предмет совпадения с этим названием

        viii)   Ответ   -   https://pastebin.com/1FQASAav
