`=====================================================================
* Руководство *
***************

Если использовать машину от HTB, то сперва надо запустить данную комнаду, чтобы скачать и распокавать все необходимые pcap файлы

	<usern_name>@<host_name>$ wget -O file.zip 'https://academy.hackthebox.com/storage/resources/pcap_files.zip' && mkdir tempdir && unzip file.zip -d tempdir && mkdir -p pcaps && mv tempdir/Intermediate_Network_Traffic_Analysis/* pcaps/ && rm -r tempdir file.zip

Удобнее всего просматривать PCAP-files используя Wireshark
Однако, в целях практики и выбработки навыков использования CLI-based tools мы будем использовать такие утилиты как tcpdump

=====================================================================
* Легенда *
***********

Когда мы ищем странный трафик, мы также должны учитывать трафик telnet и UDP.
В конце концов, их можно пропустить, но они могут быть особенно показательными во время наших усилий по анализу трафика.

Telnet — это сетевой протокол, который позволяет осуществлять двунаправленный интерактивный сеанс связи между двумя устройствами по сети.
Этот протокол был разработан в 1970-х годах и определен в RFC 854. 
В последние годы его использование значительно сократилось по сравнению с SSH.

Однако, в некоторых случаях, где используются машины на Windows NT, все еще может использоваться telnet для предоставления удаленного управления и контроля службам терминалов Microsoft.

UDP, хотя и менее надежен, чем TCP, тем не менее обеспечивает более быстрые соединения через состояние без установления соединения.
Таким образом, мы можем обнаружить законный трафик, использующий UDP, например:

    1.  Real-time Applications
        Приложения, такие как потоковое мультимедиа, онлайн-игры, голосовая и видеосвязь в реальном времени

    2.  DNS
        DNS-запросы и ответы используют UDP

    3.  DHCP
        DHCP использует UDP для назначения IP-адресов и информации о конфигурации сетевым устройствам.

    4.  SNMP
        SNMP использует UDP для мониторинга и управления сетью

    5.  TFTP (Trivial File Transfer Protocol)
        TFTP использует UDP для простой передачи файлов, обычно используемой старыми системами Windows и другими.

=====================================================================
* Подготовка *
**************

Как такового, подготовительного этапа, не существует
Для анализа чаще всего используют любой, подходящий пакетный анализатор
В нашем случае это - Wireshark

Тем не менее мы всегда должны следить за странными и необычными telnet-коммуникациями, поскольку они также могут использоваться злоумышленниками в вредоносных целях, таких как кража данных и туннелирование.

=====================================================================
* Анализ *
**********

	++++++++++++++++++++++++++++++++++++++++++++++
	+ Finding Traditional Telnet Traffic Port 23 +
	++++++++++++++++++++++++++++++++++++++++++++++
    
    Предположим, что мы открыли Wireshark и можем заметить некоторые telnet-сообщения, исходящие из порта 23.
    В этом случае мы всегда можем более подробно изучить этот трафик.

        -   telnet

    К счастью для нас, трафик telnet, как правило, расшифровывается и легко проверяется
    Но, как и в случае с ICMP, DNS и другими методами туннелирования, злоумышленники могут зашифровать, закодировать или скрыть этот текст.
    Поэтому мы всегда должны быть осторожны.

    ++++++++++++++++++++++++++++++++++++++++
	+ Unrecognized TCP Telnet in Wireshark +
	++++++++++++++++++++++++++++++++++++++++
    
    Telnet — это всего лишь протокол связи, и как таковой может быть легко переключен на другой порт злоумышленником.
    Отслеживание этих странных коммуникаций через порты может позволить нам обнаружить потенциально вредоносные действия.
    К сожалению беглый осмотр заголовком пакета может не отображать сведения того, что пакет содержит вложенные текстовые данные
    В связи с этим нам следует проверять наждый пакет посредством 'Follow TCP stream"

    ++++++++++++++++++++++++++++++++
	+ Telnet Protocol through IPv6 +
	++++++++++++++++++++++++++++++++

    Также, если наша локальная сеть не настроена на использование IPv6, выявление трафика использующего IPv6 может быть индикатором плохих действий в нашей среде.
    Мы можем заметить использование адресов IPv6 для telnet, использую следующий Wireshark фильтр

        -   ((ipv6.src_host == <IPv6_address>) or (ipv6.dst_host == <IPv6_address>)) and telnet

	+++++++++++++++++++++++++++++++
	+ Watching UDP Communications +
	+++++++++++++++++++++++++++++++

    С другой стороны, злоумышленники могут использовать UDP-соединения поверх TCP для своих попыток эксфильтрации.
    Одной из самых больших отличительных черт TCP и UDP является то, что UDP не требует установления соединения и обеспечивает быструю передачу.
    Мы можем заметим, что вместо последовательности SYN, SYN/ACK, ACK сообщения немедленно отправляются получателю.
    Как и в случае с TCP, мы можем отслеживать трафик UDP в Wireshark и проверять его содержимое (Follow UDP Stream)

    
=====================================================================
* Дополнительные Вопросы *
**************************
