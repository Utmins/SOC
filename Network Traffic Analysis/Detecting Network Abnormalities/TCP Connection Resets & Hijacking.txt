=====================================================================
* Руководство *
***************

Если использовать машину от HTB, то сперва надо запустить данную комнаду, чтобы скачать и распокавать все необходимые pcap файлы

	<usern_name>@<host_name>$ wget -O file.zip 'https://academy.hackthebox.com/storage/resources/pcap_files.zip' && mkdir tempdir && unzip file.zip -d tempdir && mkdir -p pcaps && mv tempdir/Intermediate_Network_Traffic_Analysis/* pcaps/ && rm -r tempdir file.zip

Удобнее всего просматривать PCAP-files используя Wireshark
Однако, в целях практики и выбработки навыков использования CLI-based tools мы будем использовать такие утилиты как tcpdump

=====================================================================
* Легенда *
***********

К сожалению, TCP не обеспечивает уровень защиты, который не позволяет злоумышленнику прерывать или перехватывать соединения наших хостов.
Таким образом, мы можем заметить, что соединение прерывается пакетом RST или перехватывается посредством перехвата соединения.

=====================================================================
* Подготовка *
**************

Как такового, подготовительного этапа, не существует
Однако для фильтрации пакетов согласно установленным флагам, использую следующий фильтр

	-	tcp.flags.<flag_name>==#

			<flag_name>	-	название флага.
						Если вы не знаете, как флаг указан в системе фильтрации Wireshark, то как только Вы введете tcp.flags. система автоматически предоставит Вам выпадаюший список всех доступных флагов

			#		-	указывате, используется ли данный флаг (1) или не используется (0)

=====================================================================
* Анализ *
**********

	++++++++++++++++++++++++++++++
	+ TCP Connection Termination +
	++++++++++++++++++++++++++++++

	Предположим, что злоумышленник хочет вызвать условия отказа в обслуживании в нашей сети.
	Он может использовать простую атаку внедрения пакетов TCP RST (CP RST Packet injection) или, проще говоря, завершение соединения TCP.
	Эта атака представляет собой комбинацию нескольких условий:

		-	Злоумышленник подделает исходный адрес, чтобы он принадлежал пострадавшей машине

		-	Злоумышленник изменит пакет TCP, включив в него флаг RST для завершения соединения

		-	Злоумышленник укажет порт назначения, который в данный момент используется одной из наших машин.

	Таким образом, мы можем заметить чрезмерное количество пакетов, отправляемых на один порт.

	Один из способов проверить, что это действительно атака TCP RST - это физический адрес передатчика этих пакетов TCP RST.
	Предположим, что IP-адрес 192.168.10.4 зарегистрирован в aa:aa:aa:aa:aa:aa в нашем списке сетевых устройств, и мы замечаем совершенно другой MAC, отправляющий их следующим образом.
	Это будет указывать на вредоносную активность в нашей сети, и мы могли бы сделать вывод, что это, скорее всего, атака TCP RST.

	Однако стоит отметить, что злоумышленник может подделать свой MAC-адрес, чтобы еще больше избежать обнаружения.
	В этом случае мы могли бы заметить повторные передачи и другие проблемы, как мы видели в разделе отравления ARP

	++++++++++++++++++++++++++++
	+ TCP Connection Hijacking +
	++++++++++++++++++++++++++++

	Более продвинутые злоумышленники могут использовать перехват TCP-соединения.
	В этом случае злоумышленник будет активно отслеживать целевое соединение, которое он хочет перехватить.

	Затем злоумышленник будет выполнять прогнозирование порядкового номера, чтобы внедрить свои вредоносные пакеты в правильном порядке.
	Во время этой инъекции он будет подделывать исходный адрес, чтобы он совпадал с адресом нашей затронутой машины.

	Также, злоумышленнику нужно будет заблокировать ACK-пакеты от достижения затронутой машины, чтобы продолжить перехват.
	Они делают это либо путем задержки, либо путем блокирования пакетов ACK.
	Таким образом, эта атака очень часто используется с отравлением ARP
	Это можно заметить по наличию пакетов со следуюшим сообщение в поле INFO

		-	[TCP Retransmission] ## → #### [PSH, ACK] Seq=## Ack=#### Win=### Len=#### TSval=############ TSecr=############

=====================================================================
* Дополнительные Вопросы *
**************************
