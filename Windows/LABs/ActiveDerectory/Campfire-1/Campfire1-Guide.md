# Campfire1 ‚Äî –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é Kerberoasting-–∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª SOC –æ –Ω–∞–ª–∏—á–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–æ–∑–º–æ–∂–Ω—É—é –∞—Ç–∞–∫—É Kerberoasting –≤ —Å—Ä–µ–¥–µ Active Directory.

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:
- –ñ—É—Ä–Ω–∞–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞: `Security-DC.evtx`
- PowerShell Operational –ª–æ–≥–∏ —Å —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏: `Powershell-Operational.evtx`
- Prefetch-—Ñ–∞–π–ª—ã —Å –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–µ–π —Å—Ç–∞–Ω—Ü–∏–∏

–ó–∞–¥–∞—á–∞ ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–≥–Ω—É—Ç—å —Ñ–∞–∫—Ç Kerberoasting, —Å–æ–±—Ä–∞—Ç—å IOCs (IP-–∞–¥—Ä–µ—Å–∞, —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏) –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å —Ç–µ—Ö–Ω–∏–∫–æ–π MITRE ATT&CK.

---

## 2. –¶–µ–ª–∏ –∞–Ω–∞–ª–∏–∑–∞

1. **–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –∫–æ—Ä–∏–¥–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü) —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ —Å–æ–±—ã—Ç–∏–π –∏ —Å–ø–∏—Å–∫–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö Event ID.

2. **–í—ã—è–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –≤–µ–ª–∞—Å—å –∞—Ç–∞–∫–∞**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –ø–µ—Ä–µ—á–µ–Ω—å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–≤—ã—Ö Service Principal Names (SPN) –∏–ª–∏ ServiceName —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

3. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ—Ç–∏**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* IP-–∞–¥—Ä–µ—Å(–∞) –∏ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–º—è —Ö–æ—Å—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –≤ –ª–æ–≥–∞—Ö.

4. **–ù–∞–π—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–¥ –∏–ª–∏ –±–∏–Ω–∞—Ä—å**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –∏–º—è/–ø—É—Ç—å —Å–∫—Ä–∏–ø—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –≤—ã–¥–µ—Ä–∂–∫–∏ –∏–∑ ScriptBlock/–ª–æ–≥–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–µ –µ–≥–æ —Ä–æ–ª—å –≤ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–∏ AD/SPN.

5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* —Ç–æ—á–Ω—ã–µ –º–µ—Ç–∫–∏ –∑–∞–ø—É—Å–∫–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞.

6. **–ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è –æ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ –∏ –µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –∑–∞–ø–∏—Å—å —Å –ø–æ–ª–Ω—ã–º –ø—É—Ç—ë–º –∫ –±–∏–Ω–∞—Ä—é, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–ø—É—Å–∫–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞.

7. **–°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å —Ç–∞–∫—Ç–∏–∫–∞–º–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**  
   *–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –ø—Ä–∏–≤—è–∑–∫–∞ –∫ MITRE.

---

## 3. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ Kerberoasting –∞—Ç–∞–∫

Kerberoasting ‚Äî –º–µ—Ç–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å–Ω—ã–µ Kerberos-–±–∏–ª–µ—Ç—ã (TGS) –¥–ª—è SPN –∏ –∑–∞—Ç–µ–º –ø—ã—Ç–∞–µ—Ç—Å—è —Å–ª–æ–º–∞—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏ –±–∏–ª–µ—Ç–æ–≤ –æ—Ñ–ª–∞–π–Ω (MITRE ATT&CK: **T1558.003**).

–ö–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è Windows, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:
- **Event ID 4768** ‚Äî –∑–∞–ø—Ä–æ—Å TGT (Ticket Granting Ticket).  
- **Event ID 4769** ‚Äî –∑–∞–ø—Ä–æ—Å TGS (service ticket) –¥–ª—è SPN.  
- **Event ID 4624 / 4625** ‚Äî —É—Å–ø–µ—à–Ω—ã–µ / –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã.  
- **Event ID 4648** ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —Å —è–≤–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.  
- **Event ID 4688** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.  
- **Event ID 4104** ‚Äî ScriptBlock logging (PowerShell).

---

## 4. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
|---|---:|---|
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è EVTX | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Windows-–ª–æ–≥–æ–≤ –≤ CSV/JSON | `EvtxEcmd`, `wevtx`, PowerShell `Get-WinEvent` |
| –ê–Ω–∞–ª–∏–∑ Prefetch | –†–∞–∑–±–æ—Ä prefetch-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ | `PECmd` |
| –í—Ä–µ–º–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è | –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π | `TimelineExplorer`, ELK/Splunk |
| –õ–æ–≥–∏ PowerShell | –ê–Ω–∞–ª–∏–∑ ScriptBlock (ID 4104) | Event Viewer, `LogParser` |
| –£—Ç–∏–ª–∏—Ç—ã | CLI –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | `jq`, `grep`, `awk`, `sed` (Linux/WSL) |

> ‚ö†Ô∏è –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ (VM / –ø–µ—Å–æ—á–Ω–∏—Ü–∞). –†–∞–±–æ—Ç–∞–π—Ç–µ —Å –∫–æ–ø–∏—è–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ ‚Äî –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

---

## 5. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
**–¶–µ–ª—å:** –Ω–∞–π—Ç–∏ –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

**–®–∞–≥–∏:**
1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è 4768, 4769, 4648, 4624, 4625:
```powershell
Get-WinEvent -Path .\Security-DC.evtx -FilterHashtable @{Id=4768,4769,4648,4624,4625} | Export-Csv -Path headers.csv -NoTypeInformation
```
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è 4769 –∏ –Ω–∞–π—Ç–∏ —Å–µ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ—Ä–æ—Ç–∫–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –≤—Ä–µ–º–µ–Ω–∏.  
3. –°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å —Å–æ–±—ã—Ç–∏—è–º–∏ 4648/4624/4625 –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Kerberoasting —á–∞—Å—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ 4769 –¥–ª—è —Ä–∞–∑–Ω—ã—Ö SPN —Å –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞/—É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏.

---

### –ó–∞–¥–∞–Ω–∏–µ 2 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã (ServiceName / SPN)
**–¶–µ–ª—å:** –≤—ã—è—Å–Ω–∏—Ç—å, –∫–∞–∫–∏–µ SPN –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∏—Å—å –∞—Ç–∞–∫—É—é—â–∏–º.

**–®–∞–≥–∏:**
1. –í –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö 4769-–∑–∞–ø–∏—Å—è—Ö –Ω–∞–π–¥–∏—Ç–µ –ø–æ–ª–µ `ServiceName` / `Service Principal Name`.  
2. –°–æ–±–µ—Ä–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è SPN –∏ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã —Ç–∏–ø–∞ `MSSQLSvc/host:port`, `HTTP/host`, `LDAP/host` –∏ —Ç.–¥.

**–ö–æ–º–∞–Ω–¥–∞ (–ø—Ä–∏–º–µ—Ä):**
```powershell
Import-Csv headers.csv | Where-Object {$_.Id -eq 4769} | Select-Object TimeCreated,TargetUserName,ServiceName | Sort-Object TimeCreated
```

---

### –ó–∞–¥–∞–Ω–∏–µ 3 ‚Äî –ù–∞–π—Ç–∏ IP-–∞–¥—Ä–µ—Å —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏-–∏—Å—Ç–æ—á–Ω–∏–∫–∞
**–¶–µ–ª—å:** –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π IP, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

**–®–∞–≥–∏:**
- –í –ø–æ–ª–µ `Network Information: Client Address` (–∏–ª–∏ `ClientAddress` / `RemoteHost` –≤ CSV) –Ω–∞–π—Ç–∏ IP –∏ –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Äî –∏–º—è —Ö–æ—Å—Ç–∞.

**–ü—Ä–∏–º–µ—Ä (PowerShell):**
```powershell
Import-Csv headers.csv | Where-Object {$_.Id -in 4768,4769} | Select TimeCreated,@{n='ClientIP';e={$_.ClientAddress}},TargetUserName
```

---

### –ó–∞–¥–∞–Ω–∏–µ 4 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ —Ñ–∞–π–ª, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
**–¶–µ–ª—å:** –Ω–∞–π—Ç–∏ PowerShell-—Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–ª —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö AD/SPN.

**–®–∞–≥–∏:**
1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∑–∞–ø–∏—Å–∏ 4104 –∏–∑ `Powershell-Operational.evtx`:
```powershell
Get-WinEvent -Path .\Powershell-Operational.evtx -FilterHashtable @{Id=4104} | Export-Csv -Path ps_4104.csv -NoTypeInformation
```
2. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–≤—à–µ–π 4769-–∑–∞–ø—Ä–æ—Å—ã.  
3. –ü–æ–∏—Å–∫—É–π—Ç–µ –≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º ScriptBlock –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: `Get-ADUser`, `Get-ADComputer`, `Get-ADServiceAccount`, `Setspn`, `Invoke-Kerberoast` –∏ —Ç.–¥.

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–∑–æ–≤–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SPN –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π Kerberoast ‚Äî —Å–∏–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞—Ç–∞–∫–∏.

---

### –ó–∞–¥–∞–Ω–∏–µ 5 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞/—É—Ç–∏–ª–∏—Ç—ã
**–¶–µ–ª—å:** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å –ª–æ–≥–∞–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞.

**–®–∞–≥–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `TimeCreated` –≤ 4104 –∏ —Å–æ–±—ã—Ç–∏—è 4688 (—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞.  
- –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å –ø—Ä–µ—Ñ–µ—Ç—á-–¥–∞–Ω–Ω—ã–º–∏.

**–ö–æ–º–∞–Ω–¥–∞ (–ø—Ä–∏–º–µ—Ä):**
```powershell
Get-WinEvent -Path .\Security-DC.evtx -FilterHashtable @{Id=4688} | Where-Object { $_.Message -match 'powershell|cmd|python' } | Select TimeCreated, Message
```

---

### –ó–∞–¥–∞–Ω–∏–µ 6 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å (—á–µ—Ä–µ–∑ Prefetch)
**–¶–µ–ª—å:** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–º—è –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –ø—É—Ç—å –Ω–∞ —Ö–æ—Å—Ç–µ.

**–®–∞–≥–∏:**
1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ Prefetch –≤ CSV —Å –ø–æ–º–æ—â—å—é `PECmd`:
```bash
pecmd.exe -f prefetch_folder -o prefetch.csv
```
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–π–º–ª–∞–π–Ω –∏ —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –æ–∫–Ω—É.

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** Prefetch —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è —Ñ–∞–π–ª–∞, –ø—É—Ç—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤ ‚Äî —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–º–æ–≥–∞—é—Ç —Å–≤—è–∑–∞—Ç—å –±–∏–Ω–∞—Ä—å —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

---

### –ó–∞–¥–∞–Ω–∏–µ 7 ‚Äî –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã
**–¶–µ–ª—å:** –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –º–µ—Ç–∫—É –∑–∞–ø—É—Å–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å 4769-–∑–∞–ø—Ä–æ—Å–∞–º–∏.

**–®–∞–≥–∏:** —Å–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –º–µ—Ç–∫–∏ Prefetch –∏ —Å–æ–±—ã—Ç–∏—è 4688, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø—Ä–∏–≤—è–∑–∫—É.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–æ–º —É—Ç–∏–ª–∏—Ç—ã, ScriptBlock-–ª–æ–≥–∞–º–∏ –∏ –º–∞—Å—Å–æ–≤—ã–º–∏ 4769-–∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–∞—ë—Ç –≤—ã—Å–æ–∫—É—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É—Ç–∏–ª–∏—Ç–æ–π –∏ –∞—Ç–∞–∫–æ–π.

---

## ‚úÖ –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –∏—Ç–æ–≥–æ–≤–æ–º –æ—Ç—á—ë—Ç–µ

1. –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ: –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞, –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∞–∫—Ç–∏–≤—ã, —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞.  
2. –¢–∞–π–º–ª–∞–π–Ω: —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π —Å –º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ ID.  
3. IOCs:
   - IP-–∞–¥—Ä–µ—Å–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (ClientAddress).  
   - –¶–µ–ª–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ SPN.  
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (TargetUserName).  
   - –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤/–ø—É—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—ç—à–∏ (Prefetch/–∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã).  
4. MITRE ATT&CK: —É–∫–∞–∑–∞—Ç—å **T1558.003 ‚Äî Kerberoasting** –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—é.  
5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é:
   - –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤.  
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.  
   - –í–∫–ª—é—á–µ–Ω–∏–µ/–ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—É–¥–∏—Ç–∞ Kerberos –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è PowerShell.  
   - –ü–æ–∏—Å–∫ —Å –ø–æ–º–æ—â—å—é EDR –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ –∏ –ø–æ —Å—Ö–æ–¥–Ω—ã–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º.

---

## üîí –ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ

- –†–∞–±–æ—Ç–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Å –∫–æ–ø–∏—è–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.  
- –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –≤–Ω–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.  
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CSV/JSON –∏ –∂—É—Ä–Ω–∞–ª—ã –¥–ª—è IR –∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–∞–≤–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.

---

## üõ† –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã / —à–∞–±–ª–æ–Ω—ã

- –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
```powershell
Get-WinEvent -Path .\Security-DC.evtx -FilterHashtable @{Id=4768,4769,4688,4104,4648} | Export-Csv -Path security_events.csv -NoTypeInformation
```
- –ò–∑–≤–ª–µ—á—å —Å–æ–±—ã—Ç–∏—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ SPN (4769):
```powershell
Import-Csv security_events.csv | Where-Object {$_.Id -eq 4769} | Select TimeCreated, TargetUserName, ServiceName | Sort TimeCreated
```
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Prefetch —á–µ—Ä–µ–∑ PECmd –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∏–º–µ–Ω–∏/–≤—Ä–µ–º–µ–Ω–∏.

---

## –†–µ—Å—É—Ä—Å—ã –∏ —Å—Å—ã–ª–∫–∏

- MITRE ATT&CK: Kerberoasting ‚Äî T1558.003  
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: `EvtxEcmd`, `PECmd`, `TimelineExplorer`, PowerShell `Get-WinEvent`

---

> –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π SOC/DFIR-–ø–ª–µ–π–±—É–∫ –¥–ª—è triage Kerberoasting-–∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, –º–æ–≥—É —Ç–∞–∫–∂–µ:
> - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –∫–∞–∫ `Campfire1-Guide.md` –≤ `/mnt/data`, –∏–ª–∏
> - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é –≤ DOCX –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è.
