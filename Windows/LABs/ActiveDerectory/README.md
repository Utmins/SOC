#  Campfire 1 (Kerberoasting Detection in Active Directory)

Сценарий описывает расследование возможной атаки Kerberoasting в инфраструктуре Windows Active Directory. SOC получил сообщение от сотрудника о подозрительных файлах на рабочей станции, что привело к анализу журналов контроллера домена (Security-DC.evtx), PowerShell-логов затронутой станции (Powershell-Operational.evtx) и Prefetch-файлов.

Основные задачи:
  -  определить время атаки (по событиям 4648, 4624/4625, 4768, 4769)$
  -  идентифицировать сервис, ставший целью$
  -  установить IP-адрес атакующей станции$
  -  выявить PowerShell-скрипт для перечисления учетных записей и время его запуска$
  -  а также определить утилиту Kerberoasting по Prefetch-записям и момент её запуска.

Подчёркивается необходимость перекрёстной проверки улик из разных источников и привязка техники к MITRE ATT&CK T1558.003 .

Журналы и артефакты:

    -  Security-DC.evtx — события Kerberos (4768/4769), входы (4624/4625), явные учетные данные (4648).
    -  Powershell-Operational.evtx — Scriptblock Logging (4104), фиксация запуска PowerShell-скриптов.
    -  Prefetch-файлы — следы запуска утилит Kerberoasting.

Инструменты:

    -  EvtxECmd — конвертация EVTX для анализа.
    -  PECmd — анализ Prefetch.
    -  Timeline Explorer — гибкая фильтрация и навигация по CSV.
    -  Event Viewer — стандартный просмотрщик Windows-логов.
    -  Splunk — индексация и визуализация событий.

# Campfire2 (AS-REP Roasting Investigation)

Сценарий посвящён расследованию возможного AS-REP Roasting-инцидента в инфраструктуре Windows Active Directory: обнаружено подозрительное поведение старой учётной записи без включённой предварительной аутентификации, что даёт злоумышленнику возможность запросить AS-REP и получить ответ, зашифрованный ключом, производным от пароля целевой учётки. Задача аналитика — подтвердить факт атаки по журналам контроллера домена, установить временные границы активности, идентифицировать целевую учётную запись и её SID, найти внутренний источник запросов (IP) и проверить, не последовало ли боковое смещение или дальнейшая компрометация сервисов/пользователей. Руководство даёт практические шаги по фильтрации событий (4768/4769 и сопутствующие), анализу полей TicketEncryptionType, TargetUserName, TargetSid и IpAddress, а также по использованию TimelineExplorer / EvtxEcmd / Event Viewer для надёжной верификации находок. 

Campfire2-Guide

Журналы и артефакты:

Security.evtx на контроллере домена — первоочередной источник; ключевые события: Event ID 4768 (запрос TGT), Event ID 4769 (запрос TGS) и события входа 4624/4625 для контекста; поля TicketEncryptionType, TargetUserName, TargetSid, IpAddress и TimeCreated — критичны для подтверждения AS-REP Roasting. 

Campfire2-Guide

Инструменты и рабочий поток:

EvtxEcmd — конвертация EVTX в CSV/JSON для последующей фильтрации.

Timeline Explorer — корреляция по времени, фильтрация по полям и удобная привязка TimeCreated.

Event Viewer — быстрый просмотр записей и извлечение EventData (TargetUserName/TargetSid/IpAddress).

Метод: 1) экспорт/индексация EVTX; 2) фильтрация по 4768/4769 в интересующий временной диапазон; 3) анализ TicketEncryptionType на аномалии (единичные/внезапные изменения); 4) извлечение TargetUserName/TargetSid и IpAddress; 5) поиск смежных событий (4624/4625/5140) для проверки бокового перемещения.
