Существует множество различных Framework для киберсеков
Самыми популярными и наиболее часто используемыми считаются:

	*	Pyramid Of Pain
	*	Cyber Kill Chain
	*	Unified Kill Chain
	*	Diamond Model
	*	MITRE & ATTCK

Чтож, давайте рассмотрим каждый Framework более детально

===========================================================================================================================================
*******************
* Pyramid of Pain *
*******************

Эта известная концепция применяется к решениям по кибербезопасности, таким как Cisco Security, SentinelOne и SOCRadar, для повышения эффективности CTI (Cyber ​​Threat Intelligence), охоты за угрозами и учений по реагированию на инциденты.
Понимание концепции Pyramid of Pain очень важно для Threat Hunter, Incident Responder или SOC Analyst.

Концепция «пирамиды боли» была выстроена на оценке особого признака, получившего название «индикатор компрометации» (Indicator of Compromise, IoC).
Предполагается, что, собирая индикаторы в разных точках инфраструктуры, группа защитников организации может в итоге восстановить полную картину произошедшего (или планируемого) киберинцидента.
Такие знания должны были помочь в организации обороны и противодействия.

«Pyramid of Pain» содержит шесть уровней, от «наименее болезненных» до «наиболее критических» индикаторов (снизу вверх).
Она отражает то, насколько большие проблемы защитники могут создать злоумышленникам путём борьбы с теми или иными сущностями
					__
				   /  \
				  /TTPS\						TOUGH
				 /______\
				/	     \
			   /  TOOLS   \						CHALLENGING
			  /____________\	
			 /				\
			/  NETWORK/HOST  \					ANNOYING
		   /    ARTIFACTS	  \
		  /____________________\		
		 /						\
		/	   DOMAIN NAMES		 \				SIMPLE
	   /__________________________\			
	  /							   \			
	 /         IP ADDRESSES			\			EASY
	/________________________________\
   /								  \				
  /				HASH VALSE			   \		TRVIAL
 /______________________________________\

При этом оценку безопасности инфраструктуры с помощью «пирамиды боли» нельзя «разложить по полочкам».

Не стоит обольщаться, думая, что если служба ИБ обнаруживает вредоносные хеши загруженных модулей или выявляет скомпрометированные IP-адреса, то характер атаки выявлен и осталось только поставить заслон на пути злоумышленников.
Названные артефакты легко обнаружить, что отражает их присутствие в нижней части диаграммы.
Но эти параметры также проще всего изменить, если злоумышленники планируют последующую атаку.
Выявленные артефакты — это только эпизод, а не вся картина кибератаки.

Признак простоты (по «пирамиде боли») не обязательно отражает уровень опасности совершаемого кибернападения или уровень квалификации злоумышленников.
Но для отражения низкоуровневой атаки достаточно использовать обычные механизмы защиты в виде межсетевых экранов и IDS / IPS на основе сигнатур.

На вершине «пирамиды боли» находятся стратегии, действия и методы, применяемые противником на всех этапах проведения атаки.
Для получения дополнительной информации лучше сразу рассматривать матрицу MITRE ATT&CK.

Умение понимать и применять «пирамиду боли» позволяет защитникам раскрывать замысел злоумышленников.
Этот метод является наиболее продуктивным и эффективным для сдерживания кибератаки с точки зрения затрачиваемого времени и усилий

Источник: https://www.anti-malware.ru/analytics/Technology_Analysis/Threat-Hunting-for-who#part3

===========================================================================================================================================
++++++++++++++++++++
+ Cyber Kill Chain +
++++++++++++++++++++

Термин kill chain — это военная концепция, связанная со структурой атаки.
Она состоит из идентификации цели, решения и приказа атаковать цель и, наконец, уничтожения цели.

Структура определяет шаги, используемые противниками или злонамеренными субъектами в киберпространстве.
Чтобы добиться успеха, противнику необходимо пройти все фазы Kill Chain.
Мы рассмотрим фазы атаки и поможем вам лучше понять противников и их методы, используемые при атаке для защиты себя.

Cyber ​​Kill Chain поможет вам понять и защититься от атак программ-вымогателей, нарушений безопасности, а также от расширенных постоянных угроз (APT).
Вы можете использовать Cyber ​​Kill Chain для оценки безопасности вашей сети и системы, выявляя недостающие элементы управления безопасностью и закрывая определенные пробелы в безопасности на основе инфраструктуры вашей компании.
Понимая Kill Chain как аналитик SOC, исследователь безопасности, охотник за угрозами или специалист по реагированию на инциденты, вы сможете распознавать попытки вторжения и понимать цели и задачи злоумышленника.

Kill Chain состоит из следующих 7 ступеней, как правило идущих друг за другом в развитии атаки

	1)	Reconnaissance
	2)	Weaponization
	3)	Delivery
	4)	Exploitation
	5)	Installation
	6)	Command & Control
	7)	Actions on Objectives

	==================
	= Reconnaissance =
	==================

Reconnaissance (Разведка) — это обнаружение и сбор информации о системе и жертве.

OSINT — это первый шаг, который должен выполнить злоумышленник для выполнения дальнейших фаз атаки.
Злоумышленнику необходимо изучить жертву, собрав всю доступную информацию о компании и ее сотрудниках, такую ​​как размер компании, адреса электронной почты, номера телефонов из общедоступных ресурсов, чтобы определить лучшую цель для атаки.

Вот сценарий:	Злоумышленник, называющий себя «Мегатрон», решает провести очень сложную атаку, которую он планировал годами
		Он изучал и исследовал различные инструменты и методы, которые могли бы помочь ему добраться до последней фазы Cyber ​​Kill Chain.
		Но сначала ему нужно начать с фазы разведки.
		Чтобы действовать на этой фазе, злоумышленнику необходимо провести OSINT, а имеено собрать как можно больше обзедоступной информации из различных открытых источников.

		Одним из необходимых векторов OSINT являются - адреса электронной почты
		Сбор адресов электронной почты — это процесс получения адресов электронной почты из общедоступных, платных или бесплатных сервисов.
		Злоумышленник может использовать сбор адресов электронной почты для фишинговой атаки (тип атаки социальной инженерии, используемый для кражи конфиденциальных данных, включая учетные данные для входа и номера кредитных карт).
		У злоумышленника будет большой арсенал инструментов, доступных для целей разведки.
		Вот некоторые из них:

			-	theHarvester — помимо сбора адресов электронной почты, этот инструмент также способен собирать имена, поддомены, IP-адреса и URL-адреса с использованием нескольких общедоступных источников данных
			-	Hunter.io — это инструмент для поиска адресов электронной почты, который позволит вам получить контактную информацию, связанную с доменом
			-	OSINT Framework — OSINT Framework предоставляет набор инструментов OSINT на основе различных категорий
			-	Злоумышленник также может использовать веб-сайты социальных сетей, такие как LinkedIn, Facebook, Twitter и Instagram, для сбора информации о конкретной жертве, которую он хотел бы атаковать, или о компании.
				Информация, найденная в социальных сетях, может быть полезна злоумышленнику для проведения фишинговой атаки.

	=================
	= Weaponization =
	=================

После успешного этапа разведки злоумышленник будет работать над созданием «оружия разрушения».
Он предпочтет не взаимодействовать с жертвой напрямую, а вместо этого создаст «вредоносную нагрузку», который, по словам Lockheed Martin, объединяет вредоносное ПО и эксплойт в готовую к доставке полезную нагрузку.
Большинство злоумышленников обычно используют автоматизированные инструменты для создания вредоносного ПО или обращаются к DarkWeb, чтобы купить вредоносное ПО.
Более сложные субъекты или спонсируемые государством APT (Advanced Persistent Threat Groups) пишут свое собственное вредоносное ПО, чтобы сделать образец вредоносного ПО уникальным и избежать обнаружения на цели.

В процессе создания «Полезной нагрузки» злоумышленник может:

	-	Создать зараженный документ Microsoft Office, содержащий вредоносный макрос или скрипты VBA (Visual Basic for Applications).
	-	Создать очень сложного червя, внедрить его на USB-накопители, а затем распространить их в открытом доступе.
	-	Использовать методы управления и контроля (C2) для выполнения команд на компьютере жертвы или доставки дополнительных полезных нагрузок.
		Подробнее о методах C2 можно прочитать на сайте MITRE ATT&CK (https://attack.mitre.org/tactics/TA0011/)
	-	Попытаться внедрить бэкдор (способ доступа к компьютерной системе, включающий обход механизмов безопасности).

	============
	= Delivery =
	============

Фаза доставки — это когда решает выбрать способ передачи полезной нагрузки или вредоносного ПО.
У него есть множество вариантов на выбор:

	-	Фишинговое письмо:
		После проведения разведки и определения целей атаки злоумышленник создает вредоносное письмо, нацеленное либо на конкретного человека (целевая фишинговая атака), либо на нескольких человек в компании.
		Письмо будет содержать полезную нагрузку или вредоносное ПО.
		Например, злоумышленик узнал, что сотрудник (Ненси) из отдела продаж компании A постоянно ставит отметки «Нравится» под публикациями в LinkedIn менеджера (Скотта) по доставке услуг компании B.
		Он предположит, что они оба общаются друг с другом по рабочим адресам электронной почты.
		Злоумыщленник создаст письмо, используя имя и фамилию Скотта, сделав домен похожим на домен компании, в которой работает Скотт.
		Затем злоумышленник отправит Нэнси поддельное письмо «Счет», содержащее полезную нагрузку.

	-	Распространение зараженных USB-накопителей в общественных местах, таких как кафе, парковки или на улице.
		Злоумышленник может решить провести сложную атаку USB Drop, напечатав логотип компании на USB-накопителях и отправив их компании по почте, притворяясь клиентом, отправляющим USB-устройства в качестве подарка.
		
	-	Watering hole.
		Атака Watering hole — это целевая атака, направленная на определенную группу людей путем взлома веб-сайта, который они обычно посещают, а затем перенаправления их на вредоносный веб-сайт по выбору злоумышленника.
		Злоумышленник будет искать известную уязвимость для веб-сайта и пытаться ее использовать.
		Также злоумышленник будет поощрять жертв посещать веб-сайт, отправляя «безобидные» электронные письма с указанием вредоносного URL-адреса, чтобы сделать атаку более эффективной.
		После посещения веб-сайта жертва непреднамеренно загружала вредоносное ПО или вредоносное приложение на свой компьютер.
		Этот тип атаки называется drive-by download.
		Примером может служить вредоносное всплывающее окно с просьбой загрузить поддельное расширение для браузера.

	================
	= Exploitation =
	================

Чтобы получить доступ к системе, злоумышленнику необходимо воспользоваться уязвимостью.

На этом этапе "наш" злоумышленник проявил немного креативности — он создал два фишинговых письма:
	-	одно из которых содержало фишинговую ссылку на поддельную страницу входа в Office 365,
	-	а другое — макрос-вложение, которое запускало бы программу-вымогатель, когда жертва его открывает.

Злоумышленник успешно доставил свои эксплойты и заставил двух жертв щелкнуть по вредоносной ссылке и открыть вредоносный файл.
После получения доступа к системе злоумышленник мог использовать уязвимости программного обеспечения, системы или сервера для повышения привилегий или горизонтального перемещения по сети.

Вот варианты того, как злоумышленник осуществляет проникновение/внедрение в систему жертвы:

	-	Жертва запускает эксплойт, открывая вложение электронной почты или нажимая на вредоносную ссылку.
	-	Используя эксплойт нулевого дня.
	-	Используя уязвимости программного обеспечения, оборудования или даже человека.
	-	Злоумышленник запускает эксплойт для уязвимостей на уровне сервера

	================
	= Installation =
	================

Как вы узнали из этапа «Weaponization», бэкдор позволяет злоумышленнику обойти меры безопасности и скрыть доступ.
Бэкдор также известен как точка доступа.

После того, как злоумышленник получит доступ к системе, он захочет повторно получить к ней доступ, если он потеряет соединение с ней или если его обнаружат и лишат первоначального доступа, или если система будет позже исправлена.
Поэтому злоумышленнику нужно установить постоянный бэкдор.
Постоянный бэкдор позволит злоумышленнику получить доступ к системе, которую он скомпрометировал в прошлом.

Сохранение может быть достигнуто посредством:

	-	Установки веб-оболочки (web shell) на веб-сервере.
		Веб-оболочка — это вредоносный скрипт, написанный на языках программирования веб-разработки, таких как ASP, PHP или JSP, используемый злоумышленником для сохранения доступа к скомпрометированной системе.
		Из-за простоты веб-оболочки и формата файлов (.php, .asp, .aspx, .jsp и т. д.) их может быть трудно обнаружить, и они могут быть классифицированы как безвредные.
		Вы можете ознакомиться с этой замечательной статьей, выпущенной Microsoft, о различных атаках веб-оболочки (https://www.microsoft.com/en-us/security/blog/2021/02/11/web-shell-attacks-continue-to-rise/).

	-	Установка бэкдора на машину жертвы.
		Например, злоумышленник может использовать Meterpreter для установки бэкдора на машину жертвы.
		Meterpreter — это полезная нагрузка Metasploit Framework, которая предоставляет интерактивную оболочку, из которой злоумышленник может удаленно взаимодействовать с машиной жертвы и выполнять вредоносный код.

	-	Создание или изменение служб Windows.
		Эта техника известна как T1543.003 в MITRE ATT&CK.
		Злоумышленник может создавать или изменять службы Windows для регулярного выполнения вредоносных скриптов или полезных нагрузок в рамках сохранения.
		Также он может использовать такие инструменты, как sc.exe (sc.exe позволяет создавать, запускать, останавливать, запрашивать или удалять любые службы Windows) и Reg для изменения конфигураций служб.
		Более того, злоумышленник всегда старается замаскировать вредоносную полезную нагрузку, используя имя службы, которое, как известно, связано с операционной системой или легальным программным обеспечением.

	-	Добавление записи в «run keys» для вредоносной полезной нагрузки в реестре или папке автозагрузки.
		При этом полезная нагрузка будет выполняться каждый раз, когда пользователь входит в систему на компьютере.
		Согласно MITRE ATT&CK, существует местоположение папки автозагрузки для отдельных учетных записей пользователей и общесистемная папка автозагрузки, которая будет проверяться независимо от того, какая учетная запись пользователя входит в систему.

***	На этом этапе злоумышленник также может использовать технику Timestomping, чтобы избежать обнаружения судебным следователем, а также чтобы вредоносная программа выглядела как часть легальной программы.
	Техника Timestomping позволяет злоумышленнику изменять временные метки файла, включая время изменения, доступа, создания и изменения.


	=====================
	= Command & Control =
	=====================

После создания устойчивого и постоянного канала связи, а также запустив вредоносное ПО на машине жертвы, злоумышленник открывает канал C2 (Command and Control) через вредоносное ПО для удаленного управления и манипулирования жертвой.
Этот термин также известен как C&C или C2 Beaconing как тип вредоносной связи между сервером C&C и вредоносным ПО на зараженном хосте.
Зараженный хост будет постоянно взаимодействовать с сервером C2 (отсюда и возник термин beaconing).

Скомпрометированная конечная точка будет взаимодействовать с внешним сервером, настроенным злоумышленником, для установления канала управления и контроля.
После установления соединения злоумышленник получает полный контроль над машиной жертвы.

До недавнего времени IRC (Internet Relay Chat) был традиционным каналом C2, используемым злоумышленниками.
Теперь это уже не так, поскольку современные решения по безопасности могут легко обнаруживать вредоносный трафик IRC.

Наиболее распространенные каналы C2, используемые злоумышленниками в настоящее время:

	-	Протоколы HTTP на порту 80 и HTTPS на порту 443 — этот тип маяков смешивает вредоносный трафик с легитимным трафиком и может помочь злоумышленнику обойти брандмауэры.

	-	DNS (сервер доменных имен).
		Зараженная машина делает постоянные DNS-запросы на DNS-сервер, принадлежащий злоумышленнику, этот тип связи C2 также известен как DNS-туннелирование.

Важно отметить, что злоумышленник или другой скомпрометированный хост может быть владельцем инфраструктуры C2

	=========================
	= Actions on Objectives =
	=========================

Пройдя шесть фаз атаки, злоумышленник наконец смог достичь своих целей, что означает выполнение действий по первоначальным целям.
Имея доступ к клавиатуре, злоумышленник может достичь следующего:

	-	Собрать учетные данные пользователей.
	-	Выполнить повышение привилегий (получить повышенный доступ, такой как доступ администратора домена с рабочей станции, используя неправильную конфигурацию).
	-	Внутренняя разведка (например, злоумышленник получает возможность взаимодействовать с внутренним программным обеспечением, чтобы найти его уязвимости).
	-	Боковое перемещение по среде компании.
	-	Собрать и извлечь конфиденциальные данные.
	-	Удаление резервных копий и теневых копий.
		Shadow Copy — это технология Microsoft, которая может создавать резервные копии, снимки компьютерных файлов или томов.
	-	Перезаписать или повредить данные.

===========================================================================================================================================
++++++++++++++++++++++
+ Unified Kill Chain +
++++++++++++++++++++++

Понимание поведения, целей и методологий киберугрозы является важным шагом к созданию надежной защиты кибербезопасности (известной как позиция кибербезопасности).
Unified Kill Chain (UKC) как раз используется для понимания того, как происходят кибератаки.

В сфере кибербезопасности термин «Kill Chain» используется для описания методологии/пути, которые используют злоумышленники, такие как хакеры или APT, для приближения к цели и проникновения в нее.
Например, сканирование злоумышленником, эксплуатация веб-уязвимости и повышение привилегий будут «Kill Chain». 
Текущая основная цуль состоит в том, чтобы понять «Kill Chain» злоумышленника, чтобы можно было принять защитные меры для превентивной защиты системы или сорвать попытку злоумышленника.

Моделирование угроз в контексте кибербезопасности представляет собой ряд шагов для окончательного повышения безопасности системы.
Моделирование угроз заключается в выявлении риска и по сути сводится к следующему:

	-	Определение того, какие системы и приложения необходимо защитить и какую функцию они выполняют в среде.
		Например, является ли система критически важной для нормальной работы и содержит ли система конфиденциальную информацию, такую ​​как платежная информация или адреса?

	-	Оценка уязвимостей и слабых мест этих систем и приложений и того, как они могут быть потенциально использованы

	-	Создание плана действий по защите этих систем и приложений от выявленных уязвимостей

	-	Внедрение политик для предотвращения повторного возникновения этих уязвимостей, где это возможно (например, реализация жизненного цикла разработки программного обеспечения (SDLC) для приложения или обучение сотрудников по вопросам фишинга).

Моделирование угроз является важной процедурой для снижения риска в системе или приложении, поскольку оно создает высокоуровневый обзор ИТ-активов организации (актив в ИТ — это часть программного обеспечения или оборудования) и процедур для устранения уязвимостей.
UKC может поощрять моделирование угроз, поскольку фреймворк UKC помогает выявлять потенциальные поверхности атак и то, как эти системы могут быть использованы.

STRIDE, DREAD и CVSS (и это лишь некоторые из них) — все это фреймворки, специально используемые для моделирования угроз.

UKC утверждает, что атака состоит из 18 фаз - все от разведки до эксфильтрации данных и понимания мотивов злоумышленника.

	1)	Reconnaissance			-	Исследование, идентификация и выбор целей с использованием активной или пассивной разведки.

	2)	Weaponization			-	Подготовительные действия, направленные на создание инфраструктуры, необходимой для атаки.

	3)	Delivery				-	Методы, приводящие к передаче вооруженного объекта в целевую среду.

	4)	Social Engineering		-	Методы, направленные на манипулирование людьми для выполнения небезопасных действий.

	5)	Exploitation			-	Методы эксплуатации уязвимостей в системах, которые могут, среди прочего, привести к выполнению кода.

	6)	Persistence				-	Любой доступ, действие или изменение в системе, которые обеспечивают злоумышленнику постоянное присутствие в системе.

	7)	Defense Evasion			-	Методы, которые злоумышленник может специально использовать для уклонения от обнаружения или обхода других защит.

	8)	Command & Control		-	Методы, позволяющие злоумышленникам взаимодействовать с контролируемыми системами в целевой сети.

	9)	Pivoting				-	Туннелирование трафика через контролируемую систему в другие системы, которые не доступны напрямую.

	10)	Discovery				-	Методы, позволяющие злоумышленнику получить знания о системе и ее сетевой среде.

	11)	Privilege Escalation	-	Результат методов, которые предоставляют злоумышленнику более высокие разрешения в системе или сети.

	12)	Execution				-	Методы, которые приводят к выполнению контролируемого злоумышленником кода в локальной или удаленной системе.

	13)	Credential Access		-	Методы, приводящие к доступу или контролю над учетными данными системы, службы или домена.

	14)	Lateral Movement		-	Методы, которые позволяют злоумышленнику горизонтально получать доступ и контролировать другие удаленные системы.

	15)	Collection				-	Методы, используемые для идентификации и сбора данных из целевой сети перед эксфильтрацией.

	16)	Exfiltration			-	Методы, которые приводят или помогают злоумышленнику удалить данные из целевой сети.

	17)	Impact					-	Методы, направленные на манипулирование, прерывание или уничтожение целевой системы или данных.

	18)	Objectives				-	Социально-технические цели атаки, направленные на достижение стратегической цели.

Некоторые большие преимущества UKC по сравнению с традиционными фреймворками kill chain кибербезопасности включают тот факт, что он современный и чрезвычайно подробный.

Однако, для краткости, можно сгруппировать эти фазы в несколько областей фокусировки.
К прмиеру:

	-	Phase IN: Initial Foolhold (1-9)
	-	Phase THROUGH: Network Propagation (9-14)
	-	Pahese OUT: Action on Objective (15-18)

	******************************
	* PHASE IN: Initial Foothold *
	******************************

Основное внимание в этой серии фаз уделяется получению злоумышленником доступа к системе или сетевой среде.
Злоумышленник будет использовать многочисленные тактики для исследования системы на предмет потенциальных уязвимостей, которые могут быть использованы для закрепления в системе.
Например, распространенной тактикой является использование разведки против системы для обнаружения потенциальных векторов атаки (таких как приложения и службы).

	RECONNAISSANCE (https://attack.mitre.org/tactics/TA0043/)
		Эта фаза UKC описывает методы, которые противник использует для сбора информации, касающейся своей цели.
		Это может быть достигнуто с помощью пассивной и активной разведки.
		Информация, собранная на этой фазе, используется на всех более поздних этапах UKC (например, на начальном плацдарме).

		Информация, собранная на этой фазе, может включать:

			-	Выявление того, какие системы и службы работают на цели, это полезная информация на этапах вооружения и эксплуатации этого раздела.
			-	Поиск списков контактов или списков сотрудников, которые могут быть выданы или использованы либо в атаке социальной инженерии, либо в фишинговой атаке.
			-	Поиск потенциальных учетных данных, которые могут быть использованы на более поздних этапах, таких как поворот или начальный доступ.
			-	Понимание топологии сети и других сетевых систем также может быть использовано для поворота.
	
	WEAPONIZATION (https://attack.mitre.org/tactics/TA0001/)
		Эта фаза UKC описывает, как противник создает необходимую инфраструктуру для выполнения атаки.
		Например, это может быть настройка сервера управления и контроля или системы, способной перехватывать обратные снаряды и доставлять полезные нагрузки в систему.
	
	SOCIAL ENGINEERING (https://attack.mitre.org/tactics/TA0001/)
		На этом этапе UKC описываются методы, которые злоумышленник может использовать для манипулирования сотрудниками с целью выполнения действий, которые помогут злоумышленникам в их атаке.
		Например, атака социальной инженерии может включать:

			-	Заставить пользователя открыть вредоносное вложение.
			-	Выдать себя за веб-страницу и заставить пользователя ввести свои учетные данные.
			-	Вызов или посещение цели и выдача себя за пользователя (например, запрос на сброс пароля) или возможность получить доступ к областям сайта, которые злоумышленник ранее не мог получить (например, выдача себя за инженера-энергетика).
	
	EXPLOITATION (https://attack.mitre.org/tactics/TA0002/)
		Эта фаза UKC описывает, как злоумышленник использует слабости или уязвимости, присутствующие в системе.
		UKC определяет «Эксплуатацию» как злоупотребление уязвимостями для выполнения кода.
		Например:

			-	Загрузка и выполнение обратной оболочки в веб-приложении.
			-	Вмешательство в автоматизированный скрипт в системе для выполнения кода.
			-	Злоупотребление уязвимостью веб-приложения для выполнения кода в системе, на которой оно запущено.
	
	PERSISTENCE (https://attack.mitre.org/tactics/TA0003/)
		Эта фаза UKC довольно короткая и простая.
		В частности, эта фаза UKC описывает методы, которые злоумышленник использует для сохранения доступа к системе, на которой он изначально закрепился.
		Например:

			-	Создание службы на целевой системе, которая позволит злоумышленнику восстановить доступ.
			-	Добавление целевой системы на сервер управления и контроля, где команды могут выполняться удаленно в любое время.
			-	Оставление других форм бэкдоров, которые выполняются при выполнении определенного действия в системе (т. е. обратная оболочка будет выполняться при входе системного администратора в систему).
	
	DEFENCE EVASION (https://attack.mitre.org/tactics/TA0005/)
		Раздел «Уклонение от защиты» UKC является одним из наиболее ценных этапов UKC.
		Этот этап специально используется для понимания методов, которые использует противник для обхода защитных мер, установленных в системе или сети.
		Например, это могут быть:

			-	Брандмауэры веб-приложений.
			-	Сетевые брандмауэры.
			-	Антивирусные системы на целевой машине.
			-	Системы обнаружения вторжений.

		Этот этап ценен при анализе атаки, поскольку он помогает сформировать ответ и, что еще лучше, дает команде защиты информацию о том, как они могут улучшить свои системы защиты в будущем.
	
	COMMAND & CONTROL (https://attack.mitre.org/tactics/TA0011/)
		Фаза «Командование и управление» UKC объединяет усилия, предпринятые противником на этапе «Вооружение» UKC, для установления связи между противником и целевой системой.
		Злоумышленник может установить командование и управление целевой системой для выполнения своих действий по целям.
		Например, злоумышленник может:

			-	Выполнять команды.
			-	Кража данных, учетных данных и другой информации.
			-	Использовать контролируемый сервер для перехода к другим системам в сети.
	
	PIVOTING (https://attack.mitre.org/tactics/TA0008/)
		«Pivoting» — это метод, который злоумышленник использует для доступа к другим системам в сети, которые иным образом не доступны (например, они не подвержены воздействию Интернета).
		Часто в сети есть много систем, которые напрямую недоступны и часто содержат ценные данные или имеют более слабую безопасность.

		Например, злоумышленник может получить доступ к веб-серверу, который доступен публично, чтобы атаковать другие системы, которые находятся в той же сети (но не доступны через Интернет).
	
	**************************************
	* PHASE THROUGH: Network Propagation *
	**************************************

Эта фаза наступает после того, как была успешно создана точка доступа в сети жертвы.
Злоумышленник будет стремиться получить дополнительный доступ и привилегии к системам и данным для достижения своих целей.
Как правило это осуществляется посредством создания точки входа на одной из систем, которая будет выступать в качестве опорной точки, и будет использовать ее для сбора информации о внутренней сети.

	PIVOTING (https://attack.mitre.org/tactics/TA0008/)
		Получив доступ к системе, злоумышленник будет использовать ее в качестве своего промежуточного пункта и туннеля между своими командными операциями и сетью жертвы.
		Система также будет использоваться в качестве точки распространения всех вредоносных программ и бэкдоров на более поздних этапах
	
	DISCOVERY (https://attack.mitre.org/tactics/TA0007/)
		Злоумышленник будет пытаться узнать любую информацию о системе и сети, к которой он подключен.
		На этом этапе база знаний будет создана из активных учетных записей пользователей, предоставленных разрешений, используемых приложений и программного обеспечения, активности веб-браузера, файлов, каталогов и сетевых ресурсов, а также конфигураций системы.
	
	PRIVILEGE ESCALATION (https://attack.mitre.org/tactics/TA0004/)
		После сбора знаний злоумышленник попытается получить более важные разрешения в системе, которую он использую в качестве pivot point.
		Он воспользуется информацией об учетных записях, в которых обнаружены уязвимости и неверные конфигурации, чтобы повысить свой доступ до одного из следующих высших уровней:

			-	SYSTEM/ROOT.
			-	Локальный администратор.
			-	Учетная запись пользователя с доступом, подобным доступу администратора.
			-	Учетная запись пользователя с определенным доступом или функциями.
	
	EXECUTION (https://attack.mitre.org/tactics/TA0002/)
		Здесь злоумышленник развертывает свой вредоносный код, используя систему pivot в качестве своего хоста.
		Удаленные трояны, скрипты C2, вредоносные ссылки и запланированные задачи развертываются и создаются для обеспечения повторяющегося присутствия в системе и поддержания их настойчивости.
	
	CREDENTIAL ACCESS (https://attack.mitre.org/tactics/TA0006/)
		Работая рука об руку с этапом повышения привилегий, злоумышленник попытается украсть имена учетных записей и пароли с помощью различных методов, включая кейлоггинг и сброс учетных данных.
		Это затрудняет их обнаружение во время атаки, поскольку они будут использовать законные учетные данные.
	
	LATERAL MOVEMENT (https://attack.mitre.org/tactics/TA0008/)
		С учетными данными и повышенными привилегиями злоумышленник будет стремиться перемещаться по сети и переходить на другие целевые системы, чтобы достичь своей главной цели.
		Чем скрытнее используемая техника, тем лучше.

	***********************************
	* PHASE OUT: Action On Objectives *
	***********************************

Эта фаза завершает путь атаки злоумышленника на инфраструктуру жертвы, где у него есть доступ к критически важным активам и где он может достичь своих целей атаки.
Эти цели обычно направлены на компрометацию триады конфиденциальности, целостности и доступности (CIA).

	COLLECTION (https://attack.mitre.org/tactics/TA0009/)
		После охоты за доступом и активами, противник будет стремиться собрать все ценные данные, представляющие интерес.
		Это, в свою очередь, ставит под угрозу конфиденциальность данных и приведет к следующему этапу атаки — Эксфильтрации.
		Основные целевые источники включают диски, браузеры, аудио, видео и электронную почту.]
	
	EXFILTRATION (https://attack.mitre.org/tactics/TA0010/)
		Чтобы повысить уровень своей компрометации, противник будет стремиться украсть данные, которые будут упакованы с использованием мер шифрования и сжатия, чтобы избежать любого обнаружения.
		"Канал C2" и туннель, развернутые на более ранних этапах, пригодятся в этом процессе.
	
	IMPACT (https://attack.mitre.org/tactics/TA0040/)
		Если злоумышленник попытается поставить под угрозу целостность и доступность активов данных, он будет манипулировать, прерывать или уничтожать эти активы.
		Целью будет нарушение бизнес- и операционных процессов, и это может включать в себя удаление доступа к учетным записям, стирание дисков и шифрование данных, например, атаки с целью вымогательства, порчи и отказа в обслуживании (DoS).
	
	OBJECTIVES
		Имея всю мощь и доступ к системам и сети, противник будет стремиться достичь своей стратегической цели атаки.
		Например, если атака была финансово мотивирована, они могут попытаться зашифровать файлы и системы с помощью вымогателей и потребовать плату за раскрытие данных.
		В других случаях злоумышленник может попытаться нанести ущерб репутации бизнеса, и они раскроют частную и конфиденциальную информацию общественности.

===========================================================================================================================================
+++++++++++++++++
+ Diamond Model +
+++++++++++++++++

Diamond Model анализа вторжений была разработана специалистами по кибербезопасности Серхио Кальтаджироне, Эндрю Пендергастом и Кристофером Бетцем в 2013 году.
Как описывают ее создатели, алмазная модель состоит из четырех основных характеристик и устанавливает фундаментальный атомарный элемент любой деятельности по вторжению.:
	-	злоумышленник (adversary)
	-	жертва (victim)
	-	возможности (capability)
	-	инфраструктура (infrastructure)

Также еще упоминают два дополнительных компонента (или оси) Diamond Model — социально-политический и технологический.

Diamond Model несет в себе основные концепции анализа вторжений и операций противника, при этом обеспечивая гибкость для расширения и охвата новых идей и концепций.
Модель предоставляет различные возможности для интеграции разведданных в режиме реального времени для защиты сети, автоматизации корреляции событий, надежной классификации событий по кампаниям противника и прогнозирования операций противника при планировании и отработке стратегий смягчения последствий.

Diamond Model может помочь вам определить элементы вторжения.
Она также может помочь объяснить другим людям, не являющимся техническими специалистами, что произошло во время события или любую ценную информацию о злонамеренном субъекте угрозы.

	*****************
	* Злоумышленник *
	*****************

Злоумышленник — это человек, который стоит за кибератакой.

По словам создателей Diamond Model, злоумышленник — это субъект или организация, ответственные за использование возможностей против жертвы для достижения своих целей.
Определение злоумышленника, как правило является не простой задачей, и в большинстве случаев труднорешаема — по крайней мере, на момент обнаружения.

Важно знать различие между оператором злоумышленника и клиентом злоумышленника, поскольку это поможет вам понять его намерение, навыки, приспособляемостьь и настойчивость, помогая сформировать отношения между парой злоумышленник и жертва.

Трудно идентифицировать злоумышленника на первых этапах кибератаки.
Использование данных, собранных в ходе инцидента или нарушения, сигнатур и другой соответствующей информации, может помочь вам определить, кем может быть злоумышленник.

	Оператор-злоумышленник		—	это «хакер» или лицо(а), осуществляющее деятельность по вторжению.

	Клиент-злоумышленник		—	это субъект, который получает выгоду от деятельности, осуществляемой при вторжении.
									Это может быть тот же человек, который стоит за оператором-злоумышленником, или это может быть отдельное лицо или группа.

Например, клиент-злоумышленник может контролировать разных операторов одновременно.
У каждого оператора могут быть свои возможности и инфраструктура.

	**********
	* Жертва *
	**********

Жертва — цель злоумышленника.
Жертвой может быть организация, человек, целевой адрес электронной почты, IP-адрес, домен и т. д.
Важно понимать разницу между персоной жертвы и активами жертвы, поскольку они выполняют разные аналитические функции.

Жертва может быть возможностью для злоумышленников закрепиться в организации, которую они пытаются атаковать.
В каждой кибератаке всегда есть жертва.
Например, электронное письмо с целевым фишингом (хорошо составленное электронное письмо, нацеленное на конкретного человека, представляющего интерес) было отправлено в компанию, и кто-то (жертва) нажал на ссылку.
В этом случае жертва — выбранная цель, представляющая интерес для противника.

	Персоны жертв	-	это люди и организации, являющиеся целью, и чьи активы подвергаются атаке и эксплуатации.
						Это могут быть названия организаций, имена людей, отрасли, должности, интересы и т. д.

	Активы жертвы	-	это поверхность атаки, включающая набор систем, сетей, адресов электронной почты, хостов, IP-адресов, учетных записей социальных сетей и т. д., на которые противник направит свои возможности

	***************
	* Возможности *
	***************

Возможности — также известны как навык, инструменты и методы, используемые противником в событии.
Они подчеркивает тактику, методы и процедуры противника (TTP).

Возможности могут включать все методы, используемые для атаки на жертв, от менее сложных методов, таких как ручной подбор пароля, до самых сложных методов, таких как разработка вредоносного ПО или вредоносного инструмента.

	Capability Capacity (Разнообразие возможностей)	-	это все уязвимости и уязвимости, которые может использовать отдельная возможность.

	Adversary Arsenal (Арсенал злоумышленника)		-	это набор возможностей, которые принадлежат противнику.
														Комбинация различных возможностей злоумышленникаа делают его арсеналом злоумышленника.

Злоумышленник должны обладать минимальными навыками и оптыом (возможностями).
Возможности могут быть навыками разработки вредоносного ПО и фишинговых писем или, по крайней мере, доступом к возможностям, таким как приобретение вредоносного ПО или программ-вымогателей в качестве услуги.

	******************
	* Инфраструктура *
	******************

Инфраструктура — также известна как программное обеспечение или оборудование.
Другими словами - это физические или логические взаимосвязи, которые использует противник для предоставления возможности или поддержания контроля над возможностями.
Например, центр управления и контроля (C2) и результаты от жертвы (эксфильтрация данных).

Инфраструктура также может быть IP-адресами, доменными именами, адресами электронной почты или даже вредоносным USB-устройством, найденным на улице, которое подключается к рабочей станции.

	Инфраструктура типа 1	-	это инфраструктура, контролируемая или принадлежащая противнику.

	Инфраструктура типа 2	-	это инфраструктура, контролируемая посредником.
								Иногда посредник может знать об этом, а иногда нет.
								Таким образом, это будет инфраструктура, которую жертва будет считать злоумышленником.
								Инфраструктура типа 2 имеет целью скрыть источник и атрибуцию активности. 
								Она включает в себя серверы размещения вредоносного ПО, вредоносные доменные имена, скомпрометированные учетные записи электронной почты и т. д.

	Поставщики услуг		-	это организации, которые предоставляют услуги, считающиеся критически важными для доступности инфраструктур типа 1 и типа 2 для злоумышленников
								Например, поставщики интернет-услуг, регистраторы доменов и поставщики веб-почты.

	************************************
	* Социально-Политический компонент *
	************************************

Социально-политический компонент описывает потребности и намерения злоумышленника.
Например, финансовая выгода, получение признания в хакерском сообществе, хактивизм или шпионаж.

Сценарий может заключаться в том, что жертва предоставляет «продукт», например, вычислительные ресурсы и пропускную способность в качестве зомби в ботнете для целей криптомайнинга, в то время как противник потребляет его продукт или получает финансовую выгоду.

	*****************************
	* Технологический компонент *
	*****************************

Технология – метафункция или компонент технологии подчеркивает связь между основными функциями: возможностями и инфраструктурой.
Возможности и инфраструктура описывают, как противник действует и общается.
Сценарий может быть атакой watering-hole, которая представляет собой методологию, при которой противник компрометирует легитимные веб-сайты, которые, по его мнению, будут посещать его целевые жертвы.

	*****************
	* Мета-признаки *
	*****************
Мета-признаки не являются обязательными, но они могут добавить некоторую ценную информацию или разведданные в Diamond Model.
Шесть возможных мета-признаков могут быть добавлены в модель Diamond

	1)	Временная метка (дата и время события)
		Каждое событие может быть записано с датой и временем и включать в себя время начала и окончания события.
		Временные метки необходимы для определения шаблонов и группировки вредоносной активности.
		Например, если вторжение или нарушение произошло в 3 часа ночи в Соединенных Штатах, возможно, что атака была осуществлена ​​из определенной страны с другим часовым поясом и стандартными рабочими часами.

	2)	Фаза (фазы вторжения, атаки или нарушения).
		Согласно создателям модели Diamond и Аксиоме 4, «Каждая вредоносная активность содержит две или более фаз, которые должны быть успешно выполнены последовательно для достижения желаемого результата».
		Вредоносные действия происходят не как отдельные события, а скорее как последовательность событий.
		Отличным примером может служить Cyber ​​Kill Chain, разработанная Lockheed Martin.
		
		Фазы могут быть следующими:
			A	-	Разведка
			B	-	Вооружение
			C	-	Доставка
			D	-	Эксплуатация
			E	-	Установка
			F	-	Управление и контроль
			G	-	Действия по цели

		Например, злоумышленнику необходимо провести некоторое исследование, чтобы обнаружить цель или жертву.
		Затем он попытается использовать цель, создать центр управления и контроля и, наконец, извлечь конфиденциальную информацию.

	3)	Результат
		Хотя результаты и пост-условия операций противника не всегда будут известны или будут иметь высокую достоверность, когда они известны, их полезно зафиксировать.
		Крайне важно зафиксировать результаты и постусловия операций противника, но иногда они не всегда могут быть известны.
		Результаты событий могут быть помечены как «успех», «неудача» или «неизвестно».
		Они также могут быть связаны с триадой CIA (конфиденциальность, целостность и доступность),
		Например, нарушение конфиденциальности, нарушение целостности и нарушение доступности. 

		Другой подход также может заключаться в документировании всех постусловий, возникающих в результате события, например, информации, собранной на этапе разведки, или успешной утечки паролей/конфиденциальных данных.

	4)	Направление
		Данный мета-признак помогает описывать события на основе хоста и сети и представляет направление атаки вторжения.
		Модель анализа вторжений Diamond определяет семь потенциальных значений для этой метафункции:
			-	жертва-инфраструктура
			-	инфраструктура-жертва
			-	инфраструктура-инфраструктура
			-	противник-инфраструктура
			-	инфраструктура-противник
			-	двунаправленный
			-	неизвестный.

	5)	Методология
		Эта метафункция позволит аналитику описать общую классификацию вторжений, например, фишинг, DDoS, взлом, сканирование портов и т. д.

	6)	Ресурсы
		Согласно Diamond Model, для успешного выполнения каждого события вторжения требуется один или несколько внешних ресурсов.
		Примерами ресурсов могут быть следующие:
			-	программное обеспечение (например, операционные системы, программное обеспечение виртуализации или фреймворк Metasploit)
			-	знания (например, как использовать Metasploit для выполнения атаки и запуска эксплойта)
			-	информация (например, имя пользователя/пароль для маскировки)
			-	оборудование (например, серверы, рабочие станции, маршрутизаторы)
			-	средства (например, деньги на покупку доменов)
			-	объекты (например, электричество или убежище)
			-	доступ (например, сетевой путь от исходного хоста к жертве и наоборот, сетевой доступ от поставщика услуг Интернета (ISP)).
===========================================================================================================================================
+++++++++
+ MITRE +
+++++++++

MITRE разработала и внедрила большое количество различные проектов и баз данных для сообщества кибербезопасности.
Мы же рассмотрим только некоторые из них (наиболее востребованные с нашей точки хрения):

	-	ATT&CK® (Adversarial Tactics, Techniques, and Common Knowledge) Framework
	-	CAR (Cyber Analytics Repository) Knowledge Base
	-	ENGAGE (sorry, not a fancy acronym)
	-	D3FEND (Detection, Denial, and Disruption Framework Empowering Network Defense)
	-	AEP (ATT&CK Emulation Plans)

	**********
	* ATT&CK *
	**********

Согласно веб-сайту, «MITRE ATT&CK® — это глобально доступная база знаний о тактиках и методах противника, основанная на реальных наблюдениях».
В основу фреймворка в значительной степени положены многие источники, такие как исследователи безопасности и отчеты об угрозах.
Обратите внимание, что это не только инструмент для синих команд.
Инструмент также полезен для красных команд.

Если вы этого еще не сделали, перейдите на веб-сайт ATT&CK®	-	https://attack.mitre.org/

В верхней части матрицы находится 14 категорий.
Каждая категория содержит методы, которые противник может использовать для реализации тактики.
Категории охватывают семиэтапный жизненный цикл кибератаки.
Если щелкнуть по серой полосе справа, появится новый слой со списком подметодов.

Также, те же данные можно просматривать с помощью MITRE ATT&CK® Navigator
«ATT&CK® Navigator предназначен для обеспечения базовой навигации и аннотации матриц ATT&CK®, что люди уже делают сегодня в таких инструментах, как Excel.
Вы можете использовать Navigator для визуализации своего защитного покрытия, планирования своей команды красно-синих, частоты обнаруженных приемов или чего-либо еще, что вы хотите сделать».

Вы можете получить доступ к представлению Navigator при посещении страницы группы или инструмента.

	**********************
	* CAR Knowledge Base *
	**********************

Официальное определение CAR: «Репозиторий кибераналитики MITRE (CAR) — это база знаний аналитики, разработанная MITRE на основе модели злоумышленника MITRE ATT&CK®.
CAR определяет модель данных, которая используется в ее представлениях псевдокода, но также включает реализации, непосредственно нацеленные на определенные инструменты (например, Splunk, EQL) в ее аналитике.

Что касается охвата, CAR сосредоточен на предоставлении набора проверенных и хорошо объясненных аналитик, в частности, в отношении их операционной теории и обоснования».

Официальная страница CAR - https://car.mitre.org/

Вместо того, чтобы дальше пытаться объяснить, что такое CAR, давайте углубимся.
Давайте начнем наше путешествие с обзора	-	CAR-2020-09-001: Scheduled Task - File Access (https://car.mitre.org/analytics/CAR-2020-09-001/)

При посещении страницы мы получаем краткое описание аналитики и ссылки на ATT&CK (техника, подтехника и тактика).
Чтобы в полной мере воспользоваться преимуществами CAR, мы можем просмотреть полный аналитический список (https://car.mitre.org/analytics/) или слой CAR ATT&CK® Navigator для просмотра всей аналитики.

Подводя итог, CAR — это отличное место для поиска аналитики, которая выводит нас за рамки сводок Mitigation и Detection в рамках ATT&CK®.
Этот инструмент не является заменой ATT&CK®, а представляет собой дополнительный ресурс.

	****************
	* MITRE Engage *
	****************

MITRE Engage считается подходом к взаимодействию с противником.
Согласно веб-сайту, «MITRE Engage — это фреймворк для планирования и обсуждения операций по взаимодействию с противником, который позволяет вам взаимодействовать с вашими противниками и достигать ваших целей в области кибербезопасности».

Это достигается путем внедрения Cyber ​​Denial и Cyber ​​Deception.
	-	С Cyber ​​Denial мы предотвращаем возможность противника проводить свои операции
	-	C Cyber ​​Deception мы намеренно размещаем артефакты, чтобы ввести противника в заблуждение.

Веб-сайт Engage (https://engage.mitre.org/) предоставляет стартовый комплект (https://engage.mitre.org/starter-kit/), чтобы вы могли «начать» с подхода к взаимодействию с противником.
Стартовый комплект представляет собой набор официальных документов и PDF-файлов, объясняющих различные контрольные списки, методологии и процессы, с которых можно начать.

Как и в случае с MITRE ATT&CK, Engage имеет свою собственную матрицу (https://engage.mitre.org/matrix/)
По умолчанию матрица фокусируется на следующих категориях:

	-	Prepare		-	подготовка набора оперативных действий, которые приведут к желаемому результату (вход)
	-	Expose		-	выявление противников, когда они запускают ваши развернутые обманные действия
	-	Affect		-	влияние на противников, выполняя действия, которые окажут негативное влияние на их операции
	-	Elicit		-	извлечение информацию, наблюдая за противником и узнавайте больше об его modus operandi (TTP)
	-	Understand	-	понимание результаты оперативных действий (выход)

	****************
	* MITRE D3FEND *
	****************

Согласно веб-сайту D3FEND, этот ресурс представляет собой «график знаний о мерах противодействия кибербезопасности».
*** D3FEND все еще находится в стадии бета-тестирования и финансируется Директоратом кибербезопасности АНБ.

D3FEND означает Detection, Denial, and Disruption Framework Empowering Network Defense.

Веб-сайт - https://d3fend.mitre.org/

Как вы видите, нам предоставлена ​​информация о том, что такое техника (определение), как работает техника (как она работает), о чем следует подумать при внедрении техники (соображения) и как использовать технику (пример).

Обратите внимание, что, как и в случае с другими ресурсами MITRE, вы можете фильтровать на основе матрицы ATT&CK.
Поскольку этот ресурс находится в стадии бета-тестирования и значительно изменится в будущих выпусках, мы не будем тратить так много времени на D3FEND.

	***************************
	* ATT&CK® Emulation Plans *
	***************************

Если этих инструментов, предоставленных нам MITRE, недостаточно, в рамках MITRE ENGENUITY у нас есть CTID, библиотека эмуляции злоумышленников и планы эмуляции ATT&CK®.

MITRE сформировала организацию под названием Центр защиты от угроз (CTID - Center of Threat-Informed Defense).
Эта организация состоит из различных компаний и поставщиков со всего мира.
Их цель — проводить исследования киберугроз и их TTP, а также делиться результатами исследований для улучшения киберзащиты для всех.

Некоторые компании и поставщики, которые являются участниками CTID:

	-	AttackIQ (основатель)
	-	Verizon
	-	Microsoft (основатель)
	-	Red Canary (основатель)
	-	Splunk

Библиотека эмуляции противников и планы эмуляции ATT&CK®

Библиотека эмуляции злоумышленников — это публичная библиотека, делающая планы эмуляции противников бесплатным ресурсом для участников синих/красных команд.
Библиотека и эмуляции являются вкладом CTID.
В настоящее время доступно несколько планов эмуляции ATT&CK®: APT3, APT29 и FIN6.

Планы эмуляции представляют собой пошаговое руководство по имитации конкретной группы угроз.
Если кто-то из высшего руководства спросит: «Что будет, если APT29 поразит нас?»
На этот вопрос можно легко ответить, обратившись к результатам выполнения плана эмуляции.