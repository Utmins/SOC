#   PhisNet (Email / Phishing Investigation)

    Сценарий посвящён расследованию фишингового письма, маскирующегося под платёжный запрос от известного поставщика.
    Письмо содержит ссылку и ZIP-вложение, которые потенциально скрывают вредоносное ПО или служат для кражи учётных данных.
    Задача аналитика — восстановить путь доставки письма, установить реальный исходный IP и адрес отправителя, проверить SPF/DKIM/DMARC, извлечь и просканировать вложения (включая перечисление содержимого ZIP в памяти) и идентифицировать фишинговый домен и использованные контактные данные.
    Важно вести записи и сопоставлять найденные индикаторы (IP, домены, адреса, хэши) между артефактами для подтверждения источника и цели атаки.
    Полный набор заданий и рекомендованных инструментов указан в гайде. 

    Журналы и артефакты:

        -   email.eml — исходный файл письма с полными заголовками и телом; главный источник для трассировки доставки и извлечения вложений.
        -   Заголовки (Received, X-Originating-IP, From, Reply-To, X-Organization) — используются для определения источника, промежуточных hops и подделок.
        -   Вложение (.zip / вложенные файлы) — имена файлов внутри архива, их хэши (SHA-256 и др.) и потенциальные IOC (URL, исполнимые файлы).
        -   Извлечённые URL и домены — места перенаправления и фишинговые страницы, которые нужно проверить отдельно.

    Инструменты и методика:

        -   Header analyzers (MHA, Google Toolbox, MXToolbox) — загрузить/вставить raw headers для определения первого реального hop, X-Originating-IP, и цепочки relay.
        -   URL Extractor / CyberChef / convertcsv URL tools — извлечь скрытые и обфусцированные ссылки из тела письма и из HTML-частей.
        -   Email Attachment Analyzer (локальный Python-инструмент) — извлечение вложений из .eml, вычисление хэшей (SHA256), и для ZIP-файлов — перечисление содержимого и хэшей внутренних файлов в памяти (без распаковки на диск).
        -   VirusTotal / sandbox (изолированная среда) — проверка хэшей и, при необходимости, запуск вложений в песочнице для динамического анализа.
        -   Команды / утилиты для хэшей: PowerShell Get-FileHash, sha256sum (Linux) — быстрый контрольный подсчёт.

    Рекомендуемый рабочий поток:
    
        1) сохранить .eml;
        2) проанализировать заголовки — получить исходный IP и hops;
        3) проверить SPF/DKIM/DMARC по домену отправителя;
        4) извлечь все URL и домены, проверить WHOIS/результаты репутации;
        5) извлечь вложения, вычислить хэши и сопоставить с VT;
        6) при подозрении — анализ содержимого ZIP в памяти и/или безопасный запуск в песочнице;
        7) документировать все находки и связать их в отчёте.
