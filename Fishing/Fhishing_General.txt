=====================================================================
* General *
***********

Спам и фишинг — это распространенные атаки социальной инженерии.
В социальной инженерии векторами фишинговых атак могут быть телефонный звонок, текстовое сообщение или электронное письмо.

Фишинг — это серьезный вектор атаки, от которого вам, как защитнику, придется защищаться.
Организация может следовать всем рекомендуемым рекомендациям, когда дело доходит до построения многоуровневой стратегии защиты.
Тем не менее, все, что нужно, — это неопытному и ничего не подозревающему пользователю в вашей корпоративной среде щелкнуть ссылку или загрузить и запустить вредоносное вложение, которое может предоставить злоумышленнику точку опоры в сети.

Многие продукты помогают бороться со спамом и фишингом, но на самом деле эти письма все равно могут проникнуть.
Когда это происходит, вам, как аналитику по безопасности, необходимо знать, как анализировать эти электронные письма, чтобы определить, являются ли они вредоносными или безопасными.
Кроме того, вам необходимо будет собирать информацию об электронной почте, чтобы обновлять свои продукты безопасности, чтобы предотвратить попадание вредоносных электронных писем обратно в почтовый ящик пользователя.

Методы доставки вредоносной нагрузки посредством спама/фишинга в большинстве случаев осуществляются двумя способами

    1)  Через ссылку на сайте
    2)  Через ссылку/файл в электромнном письме

Остановимся более подробно на втором методе

    +++++++++++++++++++++
    +  Malicious Emails +
    +++++++++++++++++++++
    
    Различные типы вредоносных писем можно классифицировать следующим образом:

        -   Спам (SPAM)
            Нежелательные письма, рассылаемые оптом большому количеству получателей.
            Более вредоносный вариант спама известен как MalSpam.
        
        -   Фишинг (Phishing)
            Письма, отправляемые целевой(ым) цели(ям) под видом доверенной организации, чтобы заставить людей предоставить конфиденциальную информацию.
        
        -   Целевой фишинг (Spear phishing)
            Это шаг вперед в фишинге, нацеленный на конкретных лиц или организации, ищущих конфиденциальную информацию.
        
        -   Уэйлинг (Whaling)
            Похож на целевой фишинг, но нацелен конкретно на высокопоставленных лиц C-уровня (генеральный директор, финансовый директор и т. д.), и цель та же.
        
        -   Смишинг (Smishing)
            Переносит фишинг на мобильные устройства, нацеливая мобильных пользователей с помощью специально созданных текстовых сообщений.
        
        -   Vishing
            Похож на smishing, но вместо использования текстовых сообщений для атаки социальной инженерии атаки основаны на голосовых вызовах.
    
    Когда дело доходит до фишинга, modus operandi обычно одинаков в зависимости от цели письма.
    Например, целью может быть сбор учетных данных, а другой — получение доступа к компьютеру.
    
    Ниже приведены типичные характеристики, общие для фишинговых писем:

        -   Имя/адрес отправителя электронной почты будет маскироваться под доверенный объект (подделка электронной почты)
        -   Тема и/или текст письма (текст) написаны с чувством срочности или используют определенные ключевые слова, такие как Invoice, Suspended и т. д.
        -   Тело письма (HTML) разработано для соответствия доверенному объекту (например, Amazon)
        -   Тело письма (HTML) плохо отформатировано или написано (в отличие от предыдущего пункта)
        -   Тело письма использует общий контент, такой как Dear Sir/Madam.
        -   Гиперссылки (часто использует сервисы сокращения URL-адресов, чтобы скрыть свое истинное происхождение)
        -   Вредоносное вложение, выдающее себя за законный документ
    
    !!! Напоминание: при работе с гиперссылками и вложениями нужно быть осторожным, чтобы случайно не нажать на гиперссылку или вложение.

    Гиперссылки и IP-адреса должны быть «обезврежены».
    Обезвреживание — это способ сделать URL/домен или адрес электронной почты неактивным, чтобы избежать случайных щелчков, которые могут привести к серьезному нарушению безопасности.
    Он заменяет специальные символы, такие как «@» в электронной почте или «.» в URL.
    Например, крайне подозрительный домен http://www.suspiciousdomain.com будет изменен на hxxp[://]www[.]suspiciousdomain[.]com перед его отправкой в ​​команду SOC для обнаружения.

        /////////////////////////
        /// The Email Address ///
        /////////////////////////

        Итак, что составляет адрес электронной почты?

            -   Почтовый ящик пользователя (или имя пользователя)
            -   @
            -   Домен
    
        Давайте рассмотрим следующий адрес электронной почты, billy@johndoe.com.

            -   Почтовый ящик пользователя — billy
            -   @
            -   Домен — johndoe.com
        
        Чтобы еще больше упростить это, подумайте об улице, на которой вы живете.
        Вы можете думать о своей улице как о домене.
        Имя/фамилия получателя, а также номер дома в этом сценарии представляют почтовый ящик пользователя.
        Имея эту информацию, почтовый работник, доставляющий почту, знает, в какой почтовый ящик положить письмо(я).

        Далее рассмотрим сетевые протоколы, используемые для отправки электронного письма от отправителя к получателю.

        //////////////////////
        /// Email Delivery ///
        //////////////////////

        Несколько протоколов задействованы, когда вы нажимаете ОТПРАВИТЬ в почтовом клиенте.
        Существует 3 конкретных протокола, которые используются для упрощения исходящих и входящих сообщений электронной почты, и они кратко перечислены ниже.

            -   SMTP (Simple Mail Transfer Protocol) — используется для обработки отправки электронных писем.
            -   POP3 (Post Office Protocol) — отвечает за передачу электронной почты между клиентом и почтовым сервером.
            -   IMAP (Internet Message Access Protocol) — отвечает за передачу электронной почты между клиентом и почтовым сервером.
        
        И хотя POP3 и IMAP имеют одинаковое определение, но между ними есть различия.

            -   POP3
                Электронные письма загружаются и хранятся на одном устройстве.
                Отправленные сообщения хранятся на одном устройстве, с которого они были отправлены.
                Доступ к электронным письмам возможен только с одного устройства, на которое они были загружены.
                Если вы хотите хранить сообщения на сервере, убедитесь, что включен параметр «Keep email on serve», иначе все сообщения будут удалены с сервера после загрузки в приложение или программное обеспечение одного устройства.
        
            -   IMAP
                Электронные письма хранятся на сервере и могут быть загружены на несколько устройств.
                Отправленные сообщения хранятся на сервере.
                Сообщения можно синхронизировать и получать к ним доступ с нескольких устройств.
        
        Теперь давайте поговорим о том, как электронное письмо перемещается от отправителя к получателю.
        Ниже приведено объяснение каждого этапа по порядку:

            i)      Отправитель (Алекса - alexa@janedoe.com) составляет электронное письмо получателю (Билли - billy@johndoe.com) в своем любимом почтовом клиенте.
                    Закончив, она нажимает кнопку отправки.
            ii)     Серверу SMTP (Алексы) необходимо определить, куда отправить электронное письмо Алексы.
                    Он запрашивает у DNS информацию, связанную с johndoe.com.
            iii)    Сервер DNS получает информацию о johndoe.com и отправляет ее на сервер SMTP (Алексы).
            iv)     Сервер SMTP (Алексы) отправляет электронное письмо Алексы через Интернет на почтовый ящик Билли на johndoe.com.
            v)      На этом этапе электронное письмо Алексы проходит через различные серверы SMTP и, наконец, ретранслируется на целевой сервер SMTP (Билли).
            vi)     Электронное письмо Алексы наконец достигает целевого сервера SMTP (Билли).
            vii)    Электронное письмо Алексы пересылается и теперь находится на локальном сервере POP3/IMAP, ожидая Билли.
            viii)   Билли входит в свой почтовый клиент, который запрашивает у локального сервера POP3/IMAP новые письма в его почтовом ящике.
            ix)     Письмо Алексы копируется (IMAP) или загружается (POP3) в почтовый клиент Билли.
            x)      Наконец, каждый протокол имеет свои связанные порты по умолчанию и рекомендуемые порты.
                    Например, SMTP — это порт 25.
        
        /////////////////////
        /// Email Headers ///
        /////////////////////

        Прежде чем мы начнем, нам нужно понять, что электронное письмо состоит из двух частей
        Это понимание необходимо, если вы хотите анализировать потенциально вредоносные электронные письма вручную:

            -   заголовок (header) электронного письма 
                Информация об электронном письме, например, почтовые серверы, которые ретранслировали электронное письмо

            -   тело (body) электронного письма 
                Текст и/или текст в формате HTML

        Синтаксис для электронных писем известен как формат сообщений Интернета (IMF).

        Перед тем как двигаться дальше, рассмотрим заголовки электронных писем.
        Давайте начнем со следующих полей заголовка электронного письма:

            -   FROM
                Адрес электронной почты отправителя
            
            -   Subject
                Тема электронного письма
            
            -   Date
                Дата отправки электронного письма
            
            -   To
                Адрес электронной почты получателя
        
        Обычно это четко видно в любом почтовом клиенте.

        Другой способ получить ту же информацию о заголовке электронной почты и даже больше — просмотреть «raw» данные электронной почты.
        При подробном просмотре заголовка электронной почты поначалу может быть страшно, но это не так уж и плохо, если вы знаете, что искать.
        Примечание: в зависимости от вашего почтового клиента, будь то веб-клиент или настольное приложение, шаги для просмотра этих полей заголовка электронной почты будут различаться, но концепция та же самая.

        Существуют также и другие поля заголовка электронного письма, представляющие интерес.

            -   X-Originating-IP
                IP-адрес, с которого было отправлено электронное письмо (это называется X-заголовком)
            
            -   Smtp.mailfrom/header.from 
                Домен, с которого было отправлено электронное письмо (эти заголовки находятся в разделе Authentication-Results)
            
            -   Reply-To
                Это адрес электронной почты, на который будет отправлено ответное электронное письмо вместо адреса электронной почты From
        
        К примеру   -   отправителем является newsletters@ant.anki-tech.com, но если получатель ответит на электронное письмо, ответ будет отправлен на reply@ant.anki-tech.com, который является Reply-To, а НЕ на newsletters@ant.anki-tech.com.

        //////////////////
        /// Email Body ///
        //////////////////

        Тело письма — это часть письма, содержащая текст (обычный или в формате HTML), который отправитель хочет, чтобы вы увидели.

        HTML — это то, что позволяет добавлять эти элементы в электронное письмо.
        Для просмотра HTML-кода электронного письма используется "View Source Code", но он может отличаться в зависимости от почтового клиента.
        Некоторые почтовые браузеры/приложения предоставляют возможность вернуться к HTML, это называется «View rendered HTML».

        Более того, электронные письма могут содержать вложения. 
        Вы можете просмотреть вложение электронного письма из формата HTML электронного письма или просмотрев исходный код.
        Вложение может иметь свои собственные заголовки (в зависимости от типа вложения)

            -   Content-Type                -   application/pdf.
            -   Content-Disposition         -   указывает, что это вложение.
            -   Content-Transfer-Encoding   -   сообщает нам, что оно закодировано в base64.
                                                С помощью данных в кодировке base64 вы можете декодировать их и сохранить на своем компьютере.
        
        !!! Предупреждение: при взаимодействии с вложениями будьте осторожны и убедитесь, что вы случайно не щелкнули дважды по вложению письма.

        Примечание: заголовки, относящиеся к «content», можно найти в разных местах исходного кода сообщения электронной почты, и они связаны не только с вложениями.
        Например, Content-Type может быть text/html, а Content-Transfer-Encoding может иметь другие значения, такие как 8 бит.

=====================================================================
* Tacktics *
************

Каждый вариант "тактики", представленный ниже, продемонстрирует то, как фишинговые письма могут выглядеть вполне безобидно и даже законно (на первый взгляд).
Чем убедительнее выглядит фишинговое письмо, тем выше вероятность того, что получатель нажмет на вредоносную ссылку, загрузит и запустит вредоносный файл или даже отправит принцу какой-либо страны банковский перевод.

    ++++++++++++++++++++++++++++
    + Cancel your PayPal order +
    ++++++++++++++++++++++++++++

    В этом примере будут показаны следующие приемы:

        -   Поддельный (Spoofed) адрес электронной почты
        -   Сервисы сокращения URL-адресов (URL shortening services)
        -   HTML для имитации подлинного бренда
    
    Вот несколько кратких замечаний об этом примере:

        i)      Необычный адрес получателя электронной почты.
                Это не адрес электронной почты, связанный с учетной записью Yahoo.

        ii)     Это несоответствие должно сразу бросаться в глаза.
                Данные отправителя (service@paypal.com) не совпадают с адресом электронной почты отправителя (gibberish@sultanbogor.com)

        iii)    Тема письма намекает, что вы совершили покупку или какую-то транзакцию.
                Если вы не помните эту учетную запись, то она привлечет ваше внимание.
                Эта тактика социальной инженерии заключается в том, чтобы побудить вас поспешно взаимодействовать с письмом.

    Теперь давайте рассмотрим содержимое тела письма.

        -   Тело письма дополняет информацию об отправителе и тему.
        -   Письмо было разработано как законное письмо от PayPal.
        -   К этому письму не прикреплены никакие вложения.
            Единственный интерактивный элемент в этом письме — кнопка/ссылка «Отменить заказ».

    Давайте рассмотрим это подробнее, просмотрев исходный HTML-код письма (а особенно ссылки)...
    Это можно сделать через "View Source Code", тогда вы увидите код сообщения целиком
    Но если Вы хотите просомтреть код конкретного элемента, то лучше использовать "Inspect" (если возможно)
    
    Ссылка использует сервисы сокращения URL.
    Не стоит нажимать на ссылку, если вы не знаете, куда она вас ведет.
    К счастью, существуют онлайн-инструменты, которые мы можем использовать, чтобы узнать место назначения сокращенного URL.

    ++++++++++++++++++++++
    + Track your package +
    ++++++++++++++++++++++

    В этом примере будут рассмотрены следующие приемы:

        -   Поддельный адрес электронной почты
        -   Отслеживание пикселей (Pixel tracking)
        -   Манипуляция ссылками (Link manipulation)

    Вот несколько кратких наблюдений об этом примере письма:

        i)      Письмо составлено так, чтобы создавалось впечатление, что оно отправлено из какого-то центра распространения почты.
        ii)     Тема письма дополняет иллюзию «tracking number».
        iii)    Ссылка в тексте письма соответствует теме.
    
    Обычно можно навести курсор на ссылку, чтобы увидеть, куда она ведет,
    Но бывает, что этот прием не сработает, потому что почтовый провайдер отключил ссылки в письме.
    Мы можем посмотреть на исходный код письма и выяснить это.

    Здесь мы видим файл изображения, и он явно называется Tracking.png.
    Эти трекеры отправляют информацию обратно на сервер спамера.

    У спамеров есть много причин встраивать Pixel tracking (очень маленькие изображения) в свои спам-письма.
    Чтобы узнать больше об этой концепции, обратитесь к этому посту на The Verge    -   https://www.theverge.com/22288190/email-pixel-trackers-how-to-stop-images-automatic-download

    Теперь мы можем понять, почему почтовый провайдер автоматически заблокировала изображения в этом письме.
    Многие поставщики услуг электронной почты делают то же самое.
    
    Возвращаясь к гиперссылке, ссылка указывает на подозрительный домен.
    Единственный распределительный центр, с которым может быть связан этот домен, — это вредоносное ПО, но дальнейший анализ — единственный способ подтвердить это наверняка.

    +++++++++++++++++++++++++++++++++++++++++++++++
    + Select your email provider to view document +
    +++++++++++++++++++++++++++++++++++++++++++++++

    В этом примере электронного письма будут рассмотрены следующие приемы:

        -   Срочность
        -   HTML для имитации законного бренда
        -   Манипуляция ссылками
        -   Сбор учетных данных
        -   Плохая грамматика и/или опечатки
    
    Вот несколько кратких замечаний по поводу этого образца электронного письма:

        i)      Электронное письмо было отправлено в четверг, 15 июля 2021 г.
        ii)     В этом письме присутствует ощущение срочности.
                Обратите внимание, что ссылка на загрузку факсимильного документа истекает в тот же день.
        iii)    Есть действие, которое нужно выполнить.
                В данном случае — "кнопка для загрузки факса".
    
    В случае нажатия на "кнопку для загрузки факса", жертва перенаправляется на страницу, созданную для выдачи себя за OneDrive.
    В 99.9% URL-адрес данной страницы не будет иметь отношения к Microsoft, ну или будет иметь ошибки в названии

    НА новой странице могут быть новые "кнопки" для взаимодействия.
    Жертве нужно нажать любую из кнопок, чтобы получить факсимильный документ, срок действия которого истекает.

    Жертва перенаправляется на еще один сайт.
    Этот был создан так, чтобы напоминать Adobe.
    Опять же, обратите внимание на URL  -   он не выглядит связанным с Adobe.

    Также стоит обращать внимание на все что написано/указано на кажой новой странице.
    Велик шанс того, что вы с легкость найдете огромное количество несостыковок
    К примеру на сайте Adobe может быть кнопка с названием «Share Point Online», что является продуктом Microsoft.
    Также могут быть несколько грамматических ошибок.

    Далее жертве будет предложено войти в систему с помощью провайдера электронной почты или любого другого источника из предложенных вариантов.
    Если жертва решит войти в систему через одну из своих рейльных учетных записей (т.е. ввести настоящие имя пользователя и пароль), всеравно на экране появилось сообщение об ошибке или нерпавильно указанных данных
    Этот сценарий происходит, потому что жертва на самом деле не проходит аутентификацию у настоящего поставщика электронной почты.
    Вместо этого введенные учетные данные теперь находятся на сервере преступника.
    Цель преступника по сбору учетных данных была достигнута.

    ++++++++++++++++++++++++++++++++++++++
    + Please update your payment details +
    ++++++++++++++++++++++++++++++++++++++

    В этом примере письма будут рассмотрены следующие приемы:

        -   Поддельный адрес электронной почты
        -   Срочность
        -   HTML для имитации подлинного бренда
        -   Плохая грамматика и/или опечатки
        -   Вложения

    Вот несколько кратких замечаний по этому образцу письма:

        i)      Это письмо выглядит так, будто оно от Netflix Billing, но адрес отправителя — z99@musacombi.online.
        ii)     Вот элемент срочности
                Аккаунт был заблокирован, поэтому жертва должна действовать быстро.
        iii)    В тексте письма больше этого чувства срочности.
    
    Cуть подобных писем в том, что жертве нужно открыть вложение (PDF), чтобы обновить свой аккаунт на указанной платформе

    Стоит обращать внимание на очевидные моменты
    К примеру номер телефона реальной платформы может не совпадать с номером телефона, указанным в пиьме.
    На первый взгляд, это необычный номер телефона для отправки жертве

    Также в письму могут быть ссылки/кнопки с предложенным вариантом действий

    ++++++++++++++++++++++++
    + Your recent purchase +
    ++++++++++++++++++++++++

    В этом примере письма будут рассмотрены следующие приемы:

        -   Поддельный адрес электронной почты
        -   Получатель скрыт
        -   Срочность
        -   Плохая грамматика и/или опечатки
        -   Вложения

    Вот несколько кратких замечаний по этому образцу письма:

        i)      Это письмо выглядит так, будто оно от службы поддержки Apple, но адрес отправителя — gibberish@sumpremed.com.
        ii)     Это письмо не было отправлено напрямую в почтовый ящик жертвы, а было отправлено в скрытой копии (BCC). 
                Электронное письмо получателя выглядит как еще одно поддельное письмо, которое выглядит как настоящий адрес электронной почты Apple.
        iii)    Элемент срочности.
                Требуются действия от имени жертвы.
        iv)     В адресах электронной почты отправителя и получателя есть несколько заметных опечаток: donereply и payament.

    Письмо не обязательно может иметь текст.
    Оно может быть полностью пустым или содержать только лишь вложение.
    Более того, расширение влоденного файла может быть вам не знакомо.
    К примеру .DOT — это файлы шаблонов макета страницы, связанные с Microsoft Word.

    +++++++++++++++++++++++++++++++++++++++
    + DHL Express Courier Shipping notice +
    +++++++++++++++++++++++++++++++++++++++

    В этом примере письма будут рассмотрены следующие приемы:

        -   Поддельный адрес электронной почты
        -   HTML для имитации подлинного бренда
        -   Вложения
    
    Вот несколько кратких замечаний по этому образцу письма:

        i)      Электронная почта отправителя не соответствует компании, за которую выдается письмо, в данном случае это DHL.
        ii)     Тема письма создает впечатление, что DHL отправит вам посылку.
        iii)    HTML в тексте письма был разработан так, чтобы выглядеть так, будто оно отправлено из DHL.
    
    Если взглянуть на исходный код электронного письма, то ссылка для просмотра электронного письма как веб-страницы не содержит фактического целевого URL.
    Единственный элемент, с которым жертва может взаимодействовать в этом письме, — это вложение к письму, которое в данном случае представляет собой документ Excel.
    Вложение запускает полезную нагрузку, которая может выдавать ошибку.

=====================================================================
* Phishing Analysis Tools *
***************************

Часть необходимой информации, которую нам нужно собрать, можно получить визуально из почтового клиента или веб-клиента (например, Gmail, Yahoo! и т. д.).
Но некоторую информацию, например IP-адрес отправителя и информацию для ответа, можно получить только через заголовок письма и детальный анализ тела самого письма.

Ниже приведен контрольный список соответствующей информации, которую аналитик (вы) должен собрать из заголовка электронного письма:

    -   Sender email address (Адрес электронной почты отправителя)
    -   Sender IP address (IP-адрес отправителя)
    -   Reverse lookup of the sender IP address (Обратный поиск IP-адреса отправителя)
    -   Email subject line (Строка темы электронного письма)
    -   Recipient email address (Адрес электронной почты получателя. Эта информация может быть в поле CC/BCC)
    -   Reply-to email address (Ответный адрес электронной почты, если есть)
    -   Date/time (Дата/время)

Затем мы обращаем внимание на текст электронного письма и вложения (если есть).
Ниже приведен контрольный список артефактов, которые аналитик (вы) должен собрать из текста электронного письма:

    -   Любые URL-ссылки (если использовался сервис сокращения URL-адресов, то нам нужно будет получить реальную URL-ссылку)
    -   Имя вложения
    -   Хеш-значение вложения (тип хеш-функции MD5 или SHA256, предпочтительнее последний)

Ниже мы рассмотрим некоторые инструменты, которые помогут нам извлечь эту информацию.
Выбор инструмента для использования в конечном итоге зависит от вас.
Хорошо иметь несколько ресурсов для ссылок, поскольку каждый инструмент может раскрыть информацию, которую другой инструмент может не раскрыть.

Начнем обзор инструментов с анализаторов заголовка электронного письма

    +++++++++++++++++++
    + HEADER Analyzer +
    +++++++++++++++++++

        /////////////////////
        /// Messageheader ///
        /////////////////////

        Первым в списке инструментов, который может помочь нам с анализом заголовков писем, называется Messageheader из Google Admin Toolbox.
            
        Messageheader анализирует заголовки сообщений SMTP, что помогает определить основную причину задержек доставки.
        Вы можете обнаружить неправильно настроенные серверы и проблемы с маршрутизацией почты.

        Для анализа заголовка достаточно его скопировать и вставить в он-лайн анализактор   -   https://toolbox.googleapps.com/apps/messageheader/analyzeheader

        ///////////////////////////////
        /// Message Header Analyzer ///
        ///////////////////////////////

        Другой инструмент называется    -   Message Header Analyzer

        Это также он-лайн инструмент, которым можно воспользоваться тут     -   https://mha.azurewebsites.net/

        //////////////////////
        /// mailheader.org ///
        //////////////////////

        Еще один он-лайн инструмент для анализа электронных писем   -   mailheader.org
        К сожалению, данный ресурс поддерживается на частных началах и может быть не активен
        Тем не менее найти его можно тут    -   https://mailheader.org/

Как правило фишинговые письма содержат IP-адреса, на который Вы будете перенаправлены исли последуете рекомендациям из письма
Поэтому, если Вы обнаружили IP-адрес, то лучше его сперва проверить на специальном ресурсе

    +++++++++++++++++++++++
    + IP Address Analyzer +
    +++++++++++++++++++++++

    Инструменты ниже могут помочь вам проанализировать информацию об IP-адресе отправителя

        /////////////////
        /// IPinfo.io ///
        /////////////////

        С IPinfo вы можете определить местоположение ваших пользователей, настроить их взаимодействие, предотвратить мошенничество, обеспечить соответствие требованиям и многое другое
        Данный инструмент расположен тут    -   https://ipinfo.io/

        //////////////////
        /// urlscan.io ///
        //////////////////   

        urlscan.io — это бесплатный сервис для сканирования и анализа веб-сайтов.
        Когда URL-адрес отправляется на urlscan.io, автоматизированный процесс переходит по URL-адресу, как обычный пользователь, и регистрирует активность, которую создает эта навигация по странице.
        Сюда входят домены и IP-адреса, с которыми осуществлялся контакт, ресурсы (JavaScript, CSS и т. д.), запрошенные с этих доменов, а также дополнительная информация о самой странице.
        urlscan.io сделает снимок экрана страницы, запишет содержимое DOM, глобальные переменные JavaScript, файлы cookie, созданные страницей, и множество других наблюдений.
        Если сайт нацелен на пользователей одного из более чем 400 брендов, отслеживаемых urlscan.io, он будет выделен как потенциально вредоносный в результатах сканирования.    

        urlscan.io предоставляет скриншот URL.
        Этот скриншот предоставляется, поэтому вам не нужно явно переходить к рассматриваемому URL. 

        ///////////////     ////////////////////
        /// URL2PNG ///     /// Wannabrowser ///
        ///////////////     ////////////////////

        Данные инструменты делают скриншот запрашиваемых странице
        Это позволяет просматривать содержимое ресурсов без физического их посещения и как следствия избежать потенциальных угроз

        ///////////////////////////////
        /// Talos Reputation Center ///
        ///////////////////////////////

        Talos Reputation Center — это аналитический инструмент в режиме реального времени, который анализирует мировой трафик и составляет список недавних/текущих угроз/спама, а также устанавливает оценку репутации домена.
        Существует API Talos, который вы можете использовать для получения разведывательных данных.

        Найти данный ресурс можно тут   -   https://talosintelligence.com/reputation

Теперь пришло время обратить внимание на текст письма.
Именно здесь вредоносная полезная нагрузка может быть доставлена ​​получателю в виде ссылки или вложения

    +++++++++++++++++++++++
    + Email body analysis +
    +++++++++++++++++++++++

    Ссылки можно извлечь вручную, либо непосредственно из письма в формате HTML, либо путем просеивания необработанного заголовка письма.
    Но можно воспользоваться специальным интрернет ресурсом или утилитой
    
        /////////////////////
        /// URL Extractor ///
        /////////////////////

        Это он-лайн ресурс, которым можно воспользоваться по адресу     -   https://www.convertcsv.com/url-extractor.htm
        Вы можете скопировать и вставить необработанный заголовок в текстовое поле для "Step 1: Select your input".
        Извлеченные URL-адреса видны на Step 3.

        /////////////////
        /// CyberChef ///
        /////////////////

        Не безисвестный КИБЕРШЕФ, который 
        Для извлечения URL-адресов с помощью CyberChef для извлечения URL-адресов Вы также можете использовать рецепта Extract URLs.

        !!! Совет:  Важно отметить корневой домен для извлеченных URL-адресов. Вам также потребуется выполнить анализ корневого домена.
                    После извлечения URL-адресов следующим шагом будет проверка репутации URL-адресов и корневого домена.
                    Вы можете использовать любой из инструментов, упомянутых в предыдущей задаче, чтобы помочь вам в этом.
    
    Если в письме есть вложение, вам нужно будет безопасно получить вложение.
    Сделать это легко - с помощью кнопки "Сохранить"
    После того, как вы получили вложение, вы можете получить его хэш.
    Вы можете проверить репутацию файла с помощью хеша, чтобы узнать, является ли он известным вредоносным документом.

    Для этого можно воспользоваться следующими ресурсами

        /////////////////////////////
        /// Talos File Reputation ///
        /////////////////////////////

        Инструмент позволяет выполнять случайные поиски в системе репутации файлов Talos.
        Эта система ограничивает вас одним поиском за раз и ограничивается только сопоставлением хэшей.
        К сожалению, этот поиск не отражает всех возможностей системы Advanced Malware Protection (AMP)

        Ссылка  -   https://talosintelligence.com/talos_file_reputation

        //////////////////
        /// VirusTotal ///
        //////////////////

        Данный ресурс анализирует подозрительные файлы, ХЕШи и URL-адреса для обнаружения типов вредоносного ПО, автоматически делитесь ими с сообществом безопасности

        Ссылка  -   https://www.virustotal.com/gui/home/search

Существуют онлайн-инструменты и сервисы, куда можно загружать и анализировать вредоносные файлы, чтобы лучше понять, на что было запрограммировано вредоносное ПО.
Эти сервисы известны как песочницы для вредоносных программ.

    +++++++++++++++++++
    + Malware Sandbox +
    +++++++++++++++++++        
        
    К счастью, как Защитникам, нам не нужны навыки анализа вредоносных программ, чтобы препарировать и провести обратную разработку вредоносного вложения, чтобы лучше понять вредоносное ПО.
    Например, мы можем загрузить вложение, полученное из потенциально вредоносного электронного письма, и посмотреть
    
        -   с какими URL-адресами оно пытается связаться
        -   какие дополнительные полезные нагрузки загружаются на конечную точку
        -   механизмы сохранения
        -   индикаторы компрометации (IOC) и т. д.

    Некоторые из этих онлайн-песочниц для вредоносных программ перечислены ниже.

        ///////////////
        /// Any.Run ///
        ///////////////

        Any.Run     -   это Interactive malware Hunting service
        Он позволяет анализировать активность сети, файла, модуля и реестра, взаимодействуя с ОС напрямую из браузера.
        А также покажет потенциальные последствия от действий загруженного объекта

        сайт    -   https://app.any.run/

        ///////////////////////
        /// Hybrid Analysis ///
        ///////////////////////

        Это бесплатный сервис анализа вредоносного ПО для сообщества, который обнаруживает и анализирует неизвестные угрозы с помощью уникальной технологии гибридного анализа.

        Сайт    -   https://www.hybrid-analysis.com/

        ////////////////////
        /// Joe Security ///
        ////////////////////

        Joe Sandbox предоставляет аналитикам широкий спектр функций продукта.
        Среди них:
        
            -   живое взаимодействие
            -   анализ URL и обнаружение фишинга на основе ИИ
            -   поддержка правил Yara и Sigma
            -   матрица MITRE ATT&CK
            -   обнаружение вредоносных программ на основе ИИ
            -   почта Monitor
            -   поиск и разведка угроз
            -   автоматизированное поведение пользователей
            -   динамическое инструментирование VBA/JS/JAR
            -   графики выполнения
            -   локализованная анонимизация в Интернете
            -   и многое другое.
        
        Сайт    -   https://www.joesecurity.org/

Среди всевозможных утилит и он-лайн платформ, используемых при работе с Phishing/SPAM писем, особое место занимает
Он объединяет разведку угроз, OSINT, метаданные электронной почты и проверенные пути автоматического анализа в одну мощную платформу реагирования на фишинг.


    +++++++++++++
    + PhishTool +
    +++++++++++++

    PhishTool предназначен для широкого спектра пользователей в области кибербезопасности.
    Исследователи безопасности могут глубоко изучить анатомию новых фишинговых наборов, в то время как аналитики Центра операций безопасности (SOC) эффективно реагируют на попытки фишинга, о которых сообщают пользователи.
    Аналитики по анализу угроз получают выгоду от его возможности собирать важные фишинговые индикаторы компрометации (IoCs).
    Кроме того, следователи, занимающиеся мошенничеством с использованием электронной почты, могут использовать его функции для своих операций.
    Учитывая его универсальность, такие секторы, как финансы, правоохранительные органы, телекоммуникации, морское судоходство, аэрокосмическая промышленность, автомобилестроение и многие другие, интегрировали PhishTool в свои стратегии киберзащиты.

    PhishTool объединяет несколько функций, чтобы обеспечить бесперебойный и интуитивно понятный пользовательский интерфейс.
    Платформа извлекает все соответствующие метаданные из подозрительных писем, предоставляя подробный технический обзор.
    Встроенные системы OSINT и эвристического обнаружения затем работают в тандеме, чтобы раскрыть тактику, методы и процедуры фишинговых кампаний.
    Пользователи могут выполнять обратную разработку вложений и URL-адресов, быстро сортируя потенциальные угрозы прямо из интерфейса.

    Его также можно настроить на совестную с VirusTotal работу через использование ключа API Community Edition

    Он удобно собирает всю необходимую нам информацию об электронной почте:

        -   Отправитель электронной почты
        -   Получатель электронной почты
        -   Временная метка
        -   Исходный IP и обратный поиск DNS
        -   Мы можем получить информацию о ретрансляторах SMTP, 
        -   Определенную информацию X-заголовка
        -   Информацию об IP.
    
    Также он по шагам расписыпавет хронологи и/или порядок взаимодействия фишингова сообщения

    Рабочая область PhishTool состоит из нескольких панелей:

        -   Вверху есть две вкладки, которые мы можем переключать для просмотра письма в:

                i)  text
                ii) HTML
        
        -   Две нижние панели будут отображать информацию о вложениях и URL-адресах

        -   Правая панель покажет, были ли найдены какие-либо URL-адреса в письме.

        -   Левая панель покажет информацию о вложении.

        -   В правом углу изображения выше есть многоточие.
            Если нажать на него, нам будут предоставлены дополнительные действия, которые мы можем выполнить с вложением.

=====================================================================
* Phishing Prevention *  
***********************

Можно предпринять различные действия, чтобы защитить пользователей от вредоносного письма.
Некоторые примеры таких действий перечислены ниже:

    -   Безопасность электронной почты (SPF, DKIM, DMARC)
    -   Фильтры спама (отмечают или блокируют входящие письма на основе репутации)
    -   Метки писем (оповещают пользователей о том, что входящее письмо пришло из внешнего источника)
    -   Блокировка адреса электронной почты/домена/URL (на основе репутации или явного списка запрещенных)
    -   Блокировка вложений (на основе расширения вложения)
    -   Песочница для вложений (активация вложений писем в изолированной среде для обнаружения вредоносной активности)
    -   Обучение по повышению осведомленности о безопасности (внутренние фишинговые кампании)

Согласно MITRE ATT&CK Framework, фишинг для получения информации описывается как попытка обманом заставить цели раскрыть информацию и содержит три подметодики.

Перейдите по ссылке выше и ознакомьтесь с разделом «Смягчение последствий» в разделе «Конфигурация программного обеспечения».

    +++++++++++++++++++++++++++++++++
    + Sender Policy Framework (SPF) +
    +++++++++++++++++++++++++++++++++

    Sender Policy Framework (SPF) используется для аутентификации отправителя электронной почты.
    При наличии записи SPF поставщики услуг Интернета могут проверить, что почтовый сервер авторизован для отправки электронной почты для определенного домена.
    Запись SPF — это запись TXT от DNS, содержащая список IP-адресов, которым разрешено отправлять электронную почту от имени вашего домена.

    Базовая запись SPF выглядит следующим образом:

        v=spf1 ip4:127.0.0.1 include:_spf.google.com -all

    Пояснение к записи:

        -   v=spf1
            Это начало записи SPF
        -   ip4:127.0.0.1
            Это указывает, какой IP (в данном случае версия IP4, а не IP6) может отправлять почту
        -   include:_spf.google.com
            Это указывает, какой домен может отправлять почту
        -   -all
            неавторизованные письма будут отклонены
    
    Полное объяснение всех элементов SPF записей можной найти тут   -   https://dmarcian.com/spf-syntax-table/
                                                                        https://dmarcian.com/what-is-the-difference-between-spf-all-and-all/
    
    Для просмотра SPF Записей интересующего сайта использую данную он-лай утилиту SPF Surveyor  -   https://dmarcian.com/spf-survey/

    +++++++++++++++++++++++++++++++++++++
    + DomainKeys Identified Mail (DKIM) +
    +++++++++++++++++++++++++++++++++++++

    DKIM означает DomainKeys Identified Mail и используется для аутентификации отправляемого письма.
    Как и SPF, DKIM — это открытый стандарт аутентификации электронной почты, который используется для DMARC-выравнивания.
    Запись DKIM существует в DNS, но она немного сложнее, чем SPF.
    Преимущество DKIM в том, что она может выдерживать пересылку, что делает ее лучше SPF и основой для защиты вашей электронной почты

    Базовая запись DKIM выглядит следующим образом:

        v=DKIM1; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxTQIC7vZAHHZ7WVv/5x/qH1RAgMQI+y6Xtsn73rWOgeBQjHKbmIEIlgrebyWWFCXjmzIP0NYJrGehenmPWK5bF/TRDstbM8uVQCUWpoRAHzuhIxPSYW6k/w2+HdCECF2gnGmmw1cT6nHjfCyKGsM0On0H DvxP8I5YQIIlzNigP32n1hVnQP+UuInj0wLIdOBIWkHdnFewzGK2+qjF2wmEjx+vqHDnxdUTay5DfTGaqgA9AKjgXNjLEbKlEWvy0tj7UzQRHd24a5+2x/R4Pc7PF/y6OxAwYBZnEPO0sJwio4uqL9CYZcvaHGCLOIMwQmNTPMKGC9nt3PSjujfHUBX3wIDAQAB

    Пояснение к записи:

        -   v=DKIM1
            Это версия записи DKIM (необязательно)
        -   k=rsa
            Это тип ключа. Значение по умолчанию — RSA. RSA — это алгоритм шифрования (криптосистема).
        -   p=
            Это открытый ключ, который будет сопоставлен с закрытым ключом, созданным в процессе настройки DKIM.
    
    Полное объяснение всех элементов SPF записей можной найти тут   -   https://knowledge.validity.com/s/articles/DKIM-DNS-record-overview?language=en_US
                                                                        https://dmarcian.com/dkim-selectors/
    
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    + Domain-Based Message Authentication, Reporting, and Conformance (DMARC) +
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    DMARC   -   стандарт с открытым исходным кодом, использующий концепцию, называемую выравниванием, для привязки результата двух других стандартов с открытым исходным кодом, SPF и DKIM к содержанию электронной почты.
    Если это еще не развернуто, то добавление записи DMARC для вашего домена даст вам обратную связь, которая позволит вам устранить неполадки в конфигурациях SPF и DKIM, если это необходимо.

    Базовая запись DKIM выглядит следующим образом:

        v=DMARC1; p=quarantine; rua=mailto:postmaster@website.com

    Пояснение к записи:

        -   v=DMARC1
            Должен быть заглавными буквами, и это необязательно
        -   p=quarantine
            Если проверка не пройдена, электронное письмо будет отправлено в папку со спамом (Политика DMARC)
        -   rua=mailto:postmaster@website.com
            Сводные отчеты будут отправлены на этот адрес электронной почты

    Полное объяснение всех элементов DMARC записей можной найти тут     -   
    
    
    Ознакомьтесь со следующим ресурсом о выравнивании DMARC.

    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    + Secure/Multipurpose Internet Mail Extensions (S/MIME) +
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    S/MIME — это широко распространенный протокол для отправки зашифрованных и подписанных цифровой подписью сообщений.

    Как можно понять из определения выше, 2 основных компонента S/MIME:

        -   Цифровые подписи
        -   Шифрование

    Используя криптографию с открытым ключом, S/MIME гарантирует целостность данных и неотказуемость.

    К примеру:
    
        -   Если Боб захочет использовать S/MIME, ему понадобится цифровой сертификат. Этот цифровой сертификат будет содержать его открытый ключ.
        -   С этим цифровым сертификатом Боб может «подписать» сообщение электронной почты своим закрытым ключом.
        -   Затем Мэри может расшифровать сообщение Боба открытым ключом Боба.
        -   Мэри сделает то же самое (отправит свой сертификат Бобу), когда ответит на его электронное письмо, а Боб выполнит тот же процесс со своей стороны.
        -   Теперь у обоих будут сертификаты друг друга для будущей переписки.
    