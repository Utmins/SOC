SIEM используется для обеспечения корреляции собранных данных для обнаружения угроз.
После обнаружения угрозы или превышения определенного порога выдается оповещение.
Это оповещение позволяет аналитикам предпринимать соответствующие действия на основе расследования.
Оно обеспечивает хорошую видимость того, что происходит в сетевой инфраструктуре.

Некоторые из общих возможностей SIEM:

    -   Корреляция между событиями из разных источников журналов.
    -   Обеспечение видимости как хост-центрических, так и сетевых действий.
    -   Позволяет аналитикам исследовать новейшие угрозы и своевременно реагировать.
    -   Поиск угроз, которые не обнаруживаются действующими правилами.

SIEM является одним из основных компонентов экосистемы центра управления безопасностью (SOC)
Оно начинается со сбора журналов и проверки того, соответствует ли какое-либо событие/поток условию, установленному в правиле, или пересекло определенный порог

Каждое устройство в сети генерирует какой-либо журнал всякий раз, когда на нем выполняется действие
Например, когда пользователь посещает веб-сайт, подключается к SSH, входит в свою рабочую станцию ​​и т. д.

Windows записывает каждое событие, которое можно просмотреть с помощью утилиты Event Viewer.
Она назначает уникальный идентификатор каждому типу активности журнала, что упрощает аналитику его изучение и отслеживание.
Чтобы просмотреть события в среде Windows, введите Event Viewer в строке поиска, и он перенаправит вас к инструменту, в котором хранятся и могут быть просмотрены различные журналы.
Эти журналы со всех конечных точек Windows пересылаются в решение SIEM для мониторинга и лучшей видимости.

ОС Linux хранит все соответствующие журналы, такие как события, ошибки, предупреждения и т. д., которые затем поступают в SIEM для непрерывного мониторинга.
Вот некоторые из распространенных мест, где Linux хранит журналы:

    /var/log/httpd      -   содержит журналы HTTP-запросов/ответов и ошибок.
    /var/log/cron       -   события, связанные с заданиями cron, хранятся в этом месте.
    /var/log/auth.log   -   хранит журналы, связанные с аутентификацией.
    /var/log/secure     -   хранит журналы, связанные с аутентификацией.
    /var/log/kern       -   этот файл хранит события, связанные с ядром.
    /var/log/apache     -   хранит журналы, связанные с Apache
    /var/log/httpd      -   хранит журналы, связанные с Apache

Все эти журналы предоставляют массу информации и могут помочь в выявлении проблем безопасности.
Каждое решение SIEM имеет свой собственный способ приема журналов.
Некоторые общие методы, используемые этими решениями SIEM, описаны ниже:

    1)  Agent / Forwarder
        Эти решения SIEM предоставляют легкий инструмент, называемый агентом (пересылка от Splunk), который устанавливается в конечной точке.
        Он настроен на сбор всех важных журналов и отправку их на сервер SIEM.

    2)  Syslog
        Это широко используемый протокол для сбора данных из различных систем, таких как веб-серверы, базы данных и т. д., которые отправляются в режиме реального времени в централизованное место назначения.

    3)  Manual Upload
        Некоторые решения SIEM, такие как Splunk, ELK и т. д., позволяют пользователям принимать автономные данные для быстрого анализа.
        После приема данных они нормализуются и становятся доступными для анализа.

    4)  Port-Forwarding
        Решения SIEM также можно настроить на прослушивание определенного порта, а затем конечные точки пересылают данные в экземпляр SIEM на прослушивающем порту.

Инструмент SIEM получает все журналы, связанные с безопасностью, которые поступают через агентов, переадресацию портов и т. д.
После того, как журналы получены, SIEM ищет нежелательное поведение или подозрительные шаблоны в журналах с помощью условий, установленных аналитиками в правилах.
Если условие выполняется, правило срабатывает, и инцидент расследуется.

Панели мониторинга являются наиболее важными компонентами любой SIEM.
SIEM представляет данные для анализа после их нормализации и приема.
Сводка этих анализов представлена ​​в виде действенных идей с помощью нескольких панелей мониторинга.
Каждое решение SIEM поставляется с некоторыми панелями мониторинга по умолчанию и предоставляет возможность создания пользовательских панелей мониторинга

Правила корреляции (Correlation rules) играют важную роль в своевременном обнаружении угроз, позволяя аналитикам вовремя принимать меры.
Это в значительной степени логические выражения, установленные для срабатывания.
Вот несколько примеров правил корреляции:

    -   Если пользователь получает 5 неудачных попыток входа в течение 10 секунд — выдать оповещение о нескольких неудачных попытках входа
    -   Если вход успешен после нескольких неудачных попыток входа — выдать оповещение об успешном входе после нескольких попыток входа
    -   Правило настроено на оповещение каждый раз, когда пользователь подключает USB-накопитель (полезно, если USB-накопитель ограничен политикой компании)
    -   Если исходящий трафик > 25 МБ — выдать оповещение о потенциальной попытке утечки данных (обычно это зависит от политики компании)

При мониторинге SIEM аналитики проводят большую часть времени на панелях мониторинга, поскольку они отображают различные ключевые сведения о сети в очень обобщенном виде.
После срабатывания оповещения проверяются события/потоки, связанные с оповещением, и проверяется правило, чтобы увидеть, какие условия выполнены.
На основе расследования аналитик определяет, является ли оно истинным или ложным срабатыванием.
Вот некоторые из действий, которые выполняются после анализа:

    -   Оповещение является ложной тревогой.
        Может потребоваться настройка правила, чтобы избежать повторения подобных ложных срабатываний.

    -   Оповещение является истинным положительным.
        Проведите дальнейшее расследование. Свяжитесь с владельцем актива, чтобы узнать об активности.

    -   Подтверждена подозрительная активность.
        Изолируйте зараженный хост. Заблокируйте подозрительный IP-адрес.

    +++++++++++++++++++++++++++++++++++++++
    + SIEM Use Case Development Lifecycle +
    +++++++++++++++++++++++++++++++++++++++

        -   Требования
            Определите цель или необходимость сценария использования, указав конкретный сценарий, для которого требуется оповещение или уведомление.
            Требования могут быть предложены клиентами, аналитиками или сотрудниками.
            Например, целью может быть разработка сценария использования обнаружения атаки методом подбора пароля, которая активирует оповещение после 10 последовательных неудачных попыток входа в систему в течение 4 минут.

        -   Точки данных
            Определите все точки данных в сети, где можно использовать учетную запись пользователя для входа в систему.
            Соберите информацию об источниках данных, которые генерируют журналы попыток несанкционированного доступа или неудачных попыток входа.
            Например, данные могут поступать с компьютеров Windows, компьютеров Linux, конечных точек, серверов или приложений.
            Убедитесь, что журналы содержат важную информацию, такую как имя пользователя, временная метка, источник, пункт назначения и т. д.

        -   Проверка журналов
            Проверьте и подтвердите журналы, убедившись, что они содержат всю важную информацию, такую как имя пользователя, временная метка, источник, пункт назначения, имя компьютера и имя приложения.
            Убедитесь, что все журналы получены во время различных событий аутентификации пользователей для критически важных точек данных, включая локальную, веб-аутентификацию, аутентификацию через приложение, VPN и OWA (Outlook).

        -   Проектирование и реализация
            После определения и проверки всех журналов с различными точками данных и источниками, приступайте к проектированию сценария использования, определив условия срабатывания оповещения.
            Рассмотрите три основных параметра: условие, агрегацию и приоритет. Например, в сценарии использования атаки методом подбора пароля создайте оповещение для 10 неудачных попыток входа в систему за 4 минуты, учитывая агрегацию для предотвращения ложных срабатываний и устанавливая приоритет оповещения на основе прав целевого пользователя.

        -   Документация
            Стандартные рабочие процедуры (СОП) подробно описывают стандартные процессы, которым должны следовать аналитики при работе с оповещениями.
            Это включает в себя условия, агрегацию, приоритеты и информацию о других командах, которым аналитики должны сообщать о своих действиях.
            СОП также содержит матрицу эскалации.

        -   Внедрение
            Начните с этапа разработки, прежде чем переносить оповещение непосредственно в производственную среду.
            Выявите и устраните любые пробелы, чтобы уменьшить количество ложных срабатываний, а затем переходите к эксплуатации.

        -   Периодическое обновление/тонкая настройка
            Регулярно получайте обратную связь от аналитиков и поддерживайте актуальные правила корреляции, добавляя их в белый список.
            Постоянно совершенствуйте и оптимизируйте сценарий использования, чтобы обеспечить его эффективность и точность.