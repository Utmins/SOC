=====================================================================
* INTRO *
*********

*** В этой комнате мы узнаем, как использовать интерфейс Kibana для поиска, фильтрации и создания визуализаций и панелей мониторинга, одновременно исследуя журналы VPN на предмет аномалий.   
    
    Американская компания CyberT отслеживала журналы VPN своих сотрудников, и команда SOC обнаружила некоторые аномалии в деятельности VPN.
    Наша задача как аналитиков SOC — изучить журналы VPN за январь 2022 года и выявить аномалии.
    Вот некоторые ключевые моменты, на которые следует обратить внимание перед расследованием:

        -   Все журналы VPN попадают в индекс vpn_connections.
        -   Индекс содержит журналы VPN за январь 2022 года.
        -   Пользователь Johny Brown был удален 1 января 2022 года.
        -   Мы наблюдали неудачные попытки подключения некоторых пользователей, которые необходимо расследовать.

=====================================================================
* Elastick Overview *
*********************

Elastic Stack — это набор различных компонентов (состоящий в основном из трёх приложений - Elasticsearch, Logstash и Kibana) с открытым исходным кодом, связанных вместе, чтобы помочь пользователям извлекать данные из любого источника и в любом формате
А также выполнять поиск, анализ и визуализацию данных в режиме реального времени.

Основа стека Elastic, представляет собой набор из трех приложений

    -   Beats
    -   Logstash
    -   Elasticsearch
    -   Kibana

Стек Elastic такде можно улучшить/разнообразить в ресурсоемких средах, добавив Kafka, RabbitMQ и Redis для буферизации и отказоустойчивости, а также nginx для безопасности.

Стек Elastic можно использовать в качестве решения для управления информацией и событиями безопасности (SIEM) для сбора, хранения, анализа и визуализации данных, связанных с безопасностью, из различных источников.
Для внедрения стека Elastic в качестве SIEM-решения данные, связанные с безопасностью, из различных источников, таких как межсетевые экраны, системы обнаружения вторжений (IDS/IPS) и конечные точки, должны быть загружены в стек Elastic с помощью Logstash.
Elasticsearch необходимо настроить для хранения и индексации данных безопасности
А Kibana — для создания пользовательских панелей мониторинга и визуализаций, предоставляющих аналитическую информацию о событиях, связанных с безопасностью.

Для обнаружения инцидентов безопасности Elasticsearch можно использовать для поиска и корреляции собранных данных безопасности.
Как аналитики Центра операций безопасности (SOC), мы, вероятно, будем активно использовать Kibana в качестве основного интерфейса при работе со стеком Elastic.
Поэтому крайне важно хорошо разбираться в его функциях и возможностях.

Кратко пробежимся по каждому компоненту и посмотрим, как они работают вместе.

    +++++++++
    + Beats +
    +++++++++

    Beats — это хост-агент, известный как Data-shippers, который используется для отправки/передачи данных с конечных точек в elasticsearch.
    Каждый бит — это агент специального назначения, который отправляет определенные данные в elasticsearch.
    Beats упрощает процесс сбора данных из различных источников и гарантирует, что стек Elastic получает необходимую информацию для анализа и визуализации.
    
    ++++++++++++
    + Logstash +
    ++++++++++++

    Logstash — это механизм обработки данных, который используется для получения данных из разных источников, применения к ним фильтра или нормализации,
    А затем отправки их в пункт назначения, которым может быть Kibana или прослушивающий порт.
    
    Файл конфигурации logstash разделен на три части, как показано ниже.

        1)  Input — это то, где пользователь определяет источник, из которого поступают данные.
            Logstash принимает записи файлов журналов из удалённых источников, преобразуя их в формат, понятный машинам. 
            Он может получать записи различными способами, например, чтением из плоского файла, TCP-сокета или непосредственно из сообщений syslog.
            После обработки входных данных Logstash переходит к следующей функции.
            Logstash поддерживает множество плагинов ввода, как показано в справке https://www.elastic.co/guide/en/logstash/8.1/input-plugins.html

        2)  Filter — это то, где пользователь указывает параметры фильтра для нормализации журнала, полученного выше.
            Logstash предлагает множество способов изменения формата и даже содержания записей журнала.
            В частности, плагины фильтрации могут выполнять промежуточную обработку события, часто на основе предопределенного условия.
            После преобразования записи журнала Logstash обрабатывает ее дальше.
            Logstash поддерживает множество плагинов фильтра, как показано в справочной документации https://www.elastic.co/guide/en/logstash/8.1/filter-plugins.html

        3)  Output — это то, куда пользователь хочет отправить отфильтрованные данные.
            Это может быть порт прослушивания, интерфейс Kibana, база данных Elasticsearch, файл и т. д.
            Logstash поддерживает множество плагинов вывода, как показано в справочной документации https://www.elastic.co/guide/en/logstash/8.1/output-plugins.html
    
    +++++++++++++++++
    + Elasticsearch +
    +++++++++++++++++

    Elasticsearch — это полнотекстовый поисковый и аналитический движок, используемый для хранения документов в формате JSON.
    Это важный компонент, используемый для хранения, анализа, выполнения корреляции данных и т. д.
    Он поддерживает RESTFul API для взаимодействия с данными.
    Как основной компонент стека Elastic, он обрабатывает индексацию, хранение и запросы.
    Elasticsearch позволяет пользователям выполнять сложные запросы и аналитические операции с записями файлов журналов, обработанными Logstash.

    ++++++++++
    + Kibana +
    ++++++++++
    
    Kibana — это веб-визуализация данных, которая работает с elasticsearch для анализа, исследования и визуализации потока данных в реальном времени.
    Она позволяет пользователям создавать несколько визуализаций и панелей мониторинга для лучшей видимости — подробнее о Kibana в следующих задачах.

    ++++++++++++++++++++++++++
    + How they work together +
    ++++++++++++++++++++++++++

       ---------            ------------                 -------------------         ----------
       - Beats -    -->     - Logstash -        -->      - Elastick Search -   -->   - Kibana -
       ---------            ------------                 -------------------         ----------
    Data Collection     Data Input / Filter /             Index & Store Data         Analysys & 
        Agent             Process & Output                                          Vizualization

    -   Beats — это набор различных агентов доставки данных, используемых для сбора данных от нескольких агентов.
        Подобно тому, как Winlogbeat используется для сбора журналов событий Windows, Packetbeat собирает потоки сетевого трафика.
    -   Logstash собирает данные из битов, портов или файлов и т. д., анализирует/нормализует их в пары значений полей и сохраняет их в elasticsearch.
    -   Elasticsearch действует как база данных, используемая для поиска и анализа данных.
    -   Kibana отвечает за отображение и визуализацию данных, хранящихся в elasticsearch.
        Данные, хранящиеся в elasticseach, можно легко преобразовать в различные визуализации, временные диаграммы, инфографику и т. д. с помощью Kibana.

Чтобы реализовать Elastic stack как SIEM-решение, данные, связанные с безопасностью, из различных источников, таких как брандмауэры, IDS/IPS и конечные точки, следует вводить в Elastic stack с помощью Logstash.
Elasticsearch следует настроить для хранения и индексации данных безопасности
А Kibana следует использовать для создания пользовательских панелей мониторинга и визуализаций, чтобы предоставить информацию о событиях, связанных с безопасностью.

=====================================================================
* Kibana *
**********

Kibana является неотъемлемым компонентом стека Elastic, который используется для отображения, визуализации и поиска журналов.
Вот некоторые важные вкладки:

    -   Discover tab
    -   Visualization
    -   Dashboard

    ++++++++++++++++
    + Discover Tab +
    ++++++++++++++++

    Вкладка «Обнаружение» в интерфейсе Kibana содержит журналы, которые загружаются вручную или в режиме реального времени, временную диаграмму, нормализованные поля и т. д
    Аналитики в основном используют эту вкладку для поиска/исследования журналов с помощью строки поиска и параметров фильтра.

    Некоторые ключевые сведения, доступные в интерфейсе панели мониторинга:

        -   Logs (document):
                Каждый журнал здесь также известен как отдельный документ, содержащий информацию о событии.
                Он показывает поля и значения, найденные в этом документе.

                По умолчанию документы отображаются в необработанном виде.
                Мы можем нажать на любой документ и выбрать важные поля, чтобы создать таблицу, показывающую только эти поля.
                Этот метод уменьшает шум и делает ее более презентабельной и осмысленной

                Не забудьте сохранить формат таблицы после ее создания.
                Затем она будет показывать одни и те же поля каждый раз, когда пользователь входит в панель управления.
        -   Fields pane (left):
                Левая панель интерфейса Kibana показывает список нормализованных полей, которые он находит в доступных документах/журналах.
                Щелкнув по любому полю, и оно покажет 5 верхних значений и процент встречаемости.

                Мы можем использовать эти значения, чтобы применить к ним фильтры.
                Щелчок по кнопке + добавит фильтр для отображения журналов, содержащих это значение, а кнопка - применит фильтр к этому значению, чтобы показать результаты, в которых это значение отсутствует.

                Мы можем щелкнуть по любому полю, чтобы добавить поле в фильтр или удалить его из поиска.
                Опция «Add filter» под строкой поиска позволяет нам применять фильтр к полям.
        -   Index Pattern:
                По умолчанию Kibana требует шаблон индекса для доступа к данным, хранящимся/принимаемым в elasticsearch.
                Index Pattern сообщает Kibana, какие данные elasticsearch мы хотим исследовать.
                
                Каждый шаблон индекса соответствует определенным определенным свойствам полей.
                Один шаблон индекса может указывать на несколько индексов.

                Каждый источник журнала имеет различную структуру журнала
                Поэтому, когда журналы принимаются в elasticsearch, они сначала нормализуются в соответствующие поля и значения путем создания специального шаблона индекса для источника данных.

                В наших примерах мы будем изучать шаблон индекса с именем vpn_connections, который содержит журналы VPN.
        -   Search bar:
                Место, где пользователь добавляет поисковые запросы/применяет фильтры, чтобы сузить результаты.
        -   Time Filter:
                Фильтр времени позволяет нам применять фильтр журнала на основе времени. 
                На этой вкладке есть много вариантов выбора для фильтрации/ограничения журналов.
                Мы можем сузить результаты на основе продолжительности времени.

                Вкладка Quick Select — еще одна полезная вкладка в меню поиска интерфейса Kibana, которая предоставляет несколько вариантов выбора.
                Параметр Refresh, Every в конце позволит нам выбрать время для непрерывного обновления журналов.
                Если установлено 5 секунд, журналы будут обновляться каждые 5 секунд автоматически.
        -   Time Interval / Timeline:
                Панель временной шкалы предоставляет обзор количества событий, произошедших за указанное время/дату.
                Мы можем выбрать панель только для отображения журналов за указанный период.
                Счетчик в левом верхнем углу отображает количество документов/событий, найденных за выбранное время.

                Эта полоса также полезна для определения пика в журналах.
        -   TOP Bar:
                Эта панель содержит различные варианты сохранения поиска, открытия сохраненных поисков, обмена или сохранения поиска и т. д.

        Прежде чем углубляться в изучение функции «Discover», рекомендуется ознакомиться с подробной документацией Elastic.
        В ней представлен обширный материал о различных типах полей, с которыми мы можем столкнуться.
        Рекомендуем начать с:

            -   Elastic Common Schema (ECS)
                https://www.elastic.co/guide/en/ecs/current/ecs-reference.html

            -   Поля событий Elastic Common Schema (ECS)
                https://www.elastic.co/guide/en/ecs/current/ecs-event.html

            -   Поля Winlogbeat
                https://www.elastic.co/guide/en/beats/winlogbeat/current/exported-fields-winlog.html

            -   Поля Winlogbeat ECS
                https://www.elastic.co/guide/en/beats/winlogbeat/current/exported-fields-ecs.html

            -   Поля модуля безопасности Winlogbeat
                https://www.elastic.co/guide/en/beats/winlogbeat/current/exported-fields-security.html

            -   Поля Filebeat
                https://www.elastic.co/guide/en/beats/filebeat/current/exported-fields.html

            -   Поля Filebeat ECS
                https://www.elastic.co/guide/en/beats/filebeat/current/exported-fields-ecs.html

    +++++++++++++++++
    + Visualization +
    +++++++++++++++++

    Вкладка визуализации позволяет нам визуализировать данные в различных формах, таких как таблицы, круговые диаграммы, столбчатые диаграммы и т. д.
    Эта задача визуализации будет использовать несколько параметров, предоставляемых этой вкладкой, для создания простых презентабельных визуализаций.

    Есть несколько способов перейти на вкладку визуализации.
    
        *)  Один из способов — нажать на любое поле на вкладке обнаружения и нажать на "visualization".
    
    Часто нам требуется создание корреляций между несколькими полями.
    Перетаскивание необходимого поля в середину создаст вкладку корреляции на вкладке визуализации.

    Мы также можем создать таблицу, отображающую значения выбранных полей в виде столбцов.

    Самое главное в создании этих визуализаций — сохранить их.
    Для этого нажмите на опцию сохранения справа и заполните описательные значения ниже.
    Мы также можем добавить активную визуализации в уже существующую панель мониторинга или создать новую.

    Действия после создания визуализаций:

        -   Создайте визуализацию и нажмите кнопку «Сохранить» в правом верхнем углу.
        -   Добавьте заголовок и описание к визуализации.
        -   Мы можем добавить визуализацию на любую существующую панель мониторинга или новую панель мониторинга.
        -   Нажмите «Сохранить» и добавьте в библиотеку, когда она будет

    +++++++++++++
    + Dashboard +
    +++++++++++++

    Панели мониторинга обеспечивают хорошую видимость коллекции журналов.
    Пользователь может создать несколько панелей мониторинга для удовлетворения конкретных потребностей.

    В этой задаче мы можем объединить различные сохраненные поиски и визуализации, чтобы создать настраиваемую панель мониторинга для видимости журналов VPN.

    Шаги по созданию панели мониторинга следующие:

        1)  Перейдите на вкладку «Dashboard tab» и нажмите «Create dashboard».
        2)  Нажмите «Add from Library» (ну или создавайте с чистого листа)
        3)  Нажмите на visualizations и saved searches.
            Они будут добавлены на панель управления.
        4)  После добавления элементов настройте их соответствующим образом.
        5)  Не забудьте сохранить панель управления после ее завершения.

=====================================================================
* KQL Overview *
****************

KQL (Kibana Query Language) — это язык поисковых запросов, используемый для поиска в загруженных журналах/документах в elasticsearch.
Он упрощает процесс извлечения информации из ваших индексированных данных Elasticsearch, предлагая более интуитивный подход
Помимо языка KQL, Kibana также поддерживает Lucene Query Language.

*** Запросы посредством KQL можно отключить
    Для надо нажать на KQL, что назодится в сроке поиска (Search) и в появившемся меню перевести бегунок в положение OFF.

Базовая структура запросов KQL состоит из пар "field:value", где:

    -   field (поле) представляет атрибут данных
    -   value (значение) представляет искомые вами данные.
    -   Пример  -   event.code:4625

С помощью KQL мы можем искать журналы двумя разными способами.

    -   Free text search / Свободный текстовый поиск
    -   Field-based search / Поиск по полям

Когда мы нажимаем на строку поиска, нам будут представлены все доступные поля, которые мы можем использовать в нашем поисковом запросе.
Чтобы изучить другие опции KQL, посмотрите эту официальную ссылку https://www.elastic.co/guide/en/kibana/7.17/kuery-query.html

    ++++++++++++++++++++
    + Free text Search +
    ++++++++++++++++++++

    Свободный текстовый поиск позволяет пользователям искать журналы, основываясь только на тексте.
    Это означает, что простой поиск термина security вернет все документы, содержащие этот термин, независимо от поля.

    Тем не менее, свободный текстовой запрос весьма требователен к то, что Вы вводите в строке поиска
    К примеру, если нам надо найти все совпадения по запросу "United States", то он может отобразить найденое количество совпадений (если таковые вообще имеются)
    Однако, если мы попытаемся найти совпадения по слову "United", то мы вообще ничего не получим
    Поскольку KQL ищет весь термин/слово в документах.

    Для более точного поиска используются общепринятые различные операторы посика

        /////////////////
        /// Wild Card ///
        /////////////////

        KQL позволяет использовать подстановочный знак * для сопоставления частей термина/слова.
        
        Мы использовали подстановочный знак с термином United, чтобы вернуть все результаты, содержащие термин United и любой другой термин.
        Если бы у нас были журналы с термином United Nations, они бы также были возвращены в результате этого подстановочного знака.

        //////////////////////////////////////////
        /// Logical Operators (AND | OR | NOT) ///
        //////////////////////////////////////////

        KQL также позволяет пользователям использовать логические операторы в поисковом запросе.
        Давайте рассмотрим каждый из них поотдельности.

            1)  OR / ИЛИ
                Мы будем использовать оператор OR для отображения журналов, содержащих либо «Значение№1», либо «Значение№2».
                Каждое ископмое значение желательно заключать в кавычки
                    "United States" OR "England"
            
            2)  AND / И
                Мы воспользуемся оператором AND для создания поиска, который вернет журналы, содержащие термины «Значение№1» И «Значение№2».
                Каждое ископмое значение желательно заключать в кавычки
                    "United States" AND "Virginia"

            3)  NOT / НЕ
                Аналогично, мы можем использовать оператор NOT для удаления определенного термина из результатов поиска.
                Этот поисковый запрос покажет журналы из «Значение№1», но игнорируя «Значение№2».
                Каждое ископмое значение желательно заключать в кавычки
                А, искомое значение, которое должно быть исключено еще и в скобки
                    "United States" AND NOT ("Florida")
        
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// Comparison Operators (= | > | >= | < | <= | ! | <=> | <> or != | BETWEEN | IS NULL or IS NOT NULL | IN {value1}, {value2}, ...) ///
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        Эти операторы позволяют вам определять точные условия для сопоставления значений полей

    ++++++++++++++++++++++
    + Field-based search +
    ++++++++++++++++++++++

    В Field-based search мы укажем имя поля и значение, которое мы ищем в журналах.
    Этот поиск имеет специальный синтаксис 
    Он использует двоеточие : в качестве разделителя между полем и значением.
        FIELD : VALUE.
    
        Source_ip : 238.163.231.224    AND     UserName : Suleman

=====================================================================
* Dashboard & Visualization *
*****************************

Панели мониторинга в решениях SIEM служат контейнерами для нескольких визуализаций, что позволяет нам организовывать и отображать данные осмысленным образом.

    ++++++++++++++++++++++
    + Creating Dashboard +
    ++++++++++++++++++++++

    Сперва нам необходимо перейти в раздел, отвечающий за Dashboard ("Панель Мониторинга")
    Его можно найти, если нажать на иконку "3 горизонтальный черточки" в левом верхнем унлй окна Elastic

    Перед тем, как приступить к создани и дальнейшей настройки панели мониторинга, нам важно сначала нажать на значок календаря, чтобы открыть средство выбора времени.
    И указать необходимый диапазон дат (к примеру - за последний 15 лет).
    Наконец, мы можем нажать кнопку «Apply», чтобы применить указанный диапазон дат к данным.
    
    Теперь, чтобы начать создание нашей первой визуализации, нам просто нужно нажать кнопку «Create visualization».
    После начала создания нашей первой визуализации появится новое окно с различными параметрами и настройками.

    ++++++++++++++++++++
    + Monitor Settings +
    ++++++++++++++++++++
   
    В этом окне есть четыре вещи, на которые нам следует обратить внимание:

        i)      Filter
                Эта опция/настройка позволяет нам фильтровать данные перед созданием графика.
                Например, наша цель — отобразить неудачные попытки входа в систему,
                В этом случае мы использоуем фильтр, который учитывает только те идентификаторы событий, которые соответствуют Event ID #4625 — Failed logon attempt on a Windows system (неудачная попытка входа в систему в системе Windows).
                
                    -   Field:      event.code
                    -   Operator:   is
                    -   Value:      4625
        
        ii)     Index Pattern
                Это выпадающее меню, которое находится под опцией "Filter"
                Данное поле указывает набор данных (index), который мы собираемся использовать.
                Обычно данные из различных источников инфраструктуры разделяются на разные индексы, такие как network, Windows, Linux и т. д.
        
        iii)    Search Bar/Field
                Эта строка поиска дает нам возможность дважды проверить наличие определенного поля в нашем наборе данных, что служит еще одним способом убедиться, что мы просматриваем правильные данные.
                Например, предположим, что нас интересует поле user.name.keyword.
                Мы можем использовать строку поиска, чтобы быстро выполнить поиск и проверить, присутствует ли это поле и обнаружено ли оно в выбранном нами наборе данных.
                Это позволяет нам подтвердить, что мы получаем доступ к нужному полю и работаем с точными данными.
        
        iv)     Visualization Type
                Данное выпадающее меню находится в левом верхнем углу основной рабочей области (там где отображаются все результаты)
                Оно позволяет нам выбрать тип визуализации, которую мы хотим создать.
                Параметр по умолчанию - «Bar vertical stacked».
                Если мы нажмем на эту кнопку, то откроются дополнительные доступные параметры.
                Из этого расширенного списка мы можем выбрать желаемый тип визуализации, который наилучшим образом соответствует нашим требованиям и потребностям представления данных.
    
    +++++++++++++++++++++++++++++++
    + Adjusting Created Dashboard +
    +++++++++++++++++++++++++++++++

    Предположим, что менеджер SOC предложил внести некоторые изменения в нашу панель мониторинга

    В визуализации следует указать более понятные имена столбцов
    Тип входа следует включить в визуализацию
    Результаты визуализации следует отсортировать
    Имена пользователей DESKTOP-DPOESND, WIN-OK9BH1BCKSD и WIN-RMMGJA7T9TC не следует отслеживать
    Учетные записи компьютеров не следует отслеживать (не очень хорошая практика)
    Давайте усовершенствуем созданную нами визуализацию, чтобы она соответствовала приведенным выше рекомендациям.

    Возвращаемся на гланое окно меню «Dashboard».
    Напротив нужной нам панели мониторинга должна быть иконка/значок "карандаш".

    В появившемся окне (окно с результатами выборки нащей панели мониторинга), между кнопкой "Create Visualization" и результатми выборки, должно быть поле (если оно пустое, то там будет надпись - [No Ttitle])
    В конце этого поля будет символ/иконка "шестеренки"
    Нажимаем на этот символ/иконку и выбираем необходимое меню (в нашем случае это - Edit Lens)
                
=====================================================================
* The Triaging Process *
************************

Сортировка оповещений, выполняемая аналитиком Центра операций безопасности (SOC), представляет собой процесс оценки и приоритизации оповещений безопасности, генерируемых различными системами мониторинга и обнаружения, для определения их уровня угрозы и потенциального воздействия на системы и данные организации.
Она включает в себя систематический просмотр и категоризацию оповещений для эффективного распределения ресурсов и реагирования на инциденты безопасности.

Идеальный процесс сортировки выглядит примерно следующим образом:

    1)  Первоначальный обзор оповещения:
            
            -   Тщательно просмотрите первоначальное оповещение, включая метаданные, временную метку, исходный IP, целевой IP, затронутые системы и правило/сигнатуру запуска.
            -   Проанализируйте связанные журналы (сетевой трафик, система, приложение), чтобы понять контекст оповещения.
    
    2)  Классификация оповещения:
    
            -   Классифицируйте оповещение на основе серьезности, воздействия и срочности, используя предопределенную в организации систему классификации.
    
    3)  Корреляция оповещения:
    
            -   Сопоставьте оповещение со связанными оповещениями, событиями или инцидентами, чтобы определить шаблоны, сходства или потенциальные индикаторы компрометации (IOC).
            -   Запросите SIEM или систему управления журналами, чтобы собрать соответствующие данные журнала.
            -   Используйте каналы разведки угроз для проверки известных шаблонов атак или сигнатур вредоносных программ.
    
    4)  Обогащение данных оповещения:
    
            -   Соберите дополнительную информацию для обогащения данных оповещения и получения контекста:
                    *   Соберите захваты сетевых пакетов, дампы памяти или образцы файлов, связанные с оповещением.
                    *   Используйте внешние источники информации об угрозах, инструменты с открытым исходным кодом или песочницы для анализа подозрительных файлов, URL-адресов или IP-адресов.
                    *   Проведите разведку затронутых систем на предмет аномалий (сетевые соединения, процессы, изменения файлов).
    
    5)  Оценка риска:
    
            -   Оцените потенциальный риск и воздействие на критические активы, данные или инфраструктуру:
                    *   Рассмотрите ценность затронутых систем, чувствительность данных, требования соответствия и нормативные последствия.
                    *   Определите вероятность успешной атаки или потенциального бокового перемещения.
    
    6)  Контекстный анализ:
    
            -   Аналитик рассматривает контекст, окружающий оповещение, включая затронутые активы, их критичность и чувствительность данных, с которыми они работают.
            -   Они оценивают имеющиеся средства контроля безопасности, такие как брандмауэры, системы обнаружения/предотвращения вторжений и решения по защите конечных точек, чтобы определить, указывает ли оповещение на потенциальный сбой управления или метод уклонения.
            -   Аналитик оценивает соответствующие требования соответствия, отраслевые правила и договорные обязательства, чтобы понять последствия оповещения для состояния соблюдения правовых и нормативных требований организации.
    
    7)  Планирование реагирования на инциденты:
    
            -   Инициируйте план реагирования на инциденты, если оповещение является существенным:
                    *   Документируйте сведения об оповещениях, затронутых системах, наблюдаемом поведении, потенциальных IOC и обогащенных данных.
                    *   Назначьте членов группы реагирования на инциденты с определенными ролями и обязанностями.
                    *   При необходимости координируйте действия с другими группами (сетевыми операциями, системными администраторами, поставщиками).
    
    8)  Консультации с ИТ-операциями:
    
            -   Оцените потребность в дополнительном контексте или недостающей информации, проконсультировавшись с ИТ-операциями или соответствующими отделами:
                    *   Участвуйте в обсуждениях или встречах для сбора информации о затронутых системах, последних изменениях или текущих мероприятиях по техническому обслуживанию.
                    *   Сотрудничайте, чтобы понять любые известные проблемы, неправильные конфигурации или изменения в сети, которые потенциально могут генерировать ложные срабатывания оповещений.
                    *   Получите целостное понимание среды и любых невредоносных действий, которые могли вызвать оповещение.
                    *   Задокументируйте информацию и выводы, полученные в ходе консультации.
    
    9)  Выполнение реагирования:
    
            -   На основе обзора оповещения, оценки рисков и консультации определите соответствующие ответные действия.
            -   Если дополнительный контекст разрешает оповещение или идентифицирует его как невредоносное событие, примите необходимые меры без эскалации.
            -   Если оповещение по-прежнему указывает на потенциальные проблемы безопасности или требует дальнейшего расследования, приступайте к действиям по реагированию на инцидент.
    
    10) Эскалация:

            -   Определите триггеры для эскалации на основе политик организации и серьезности оповещения:
                    *   Триггерами могут быть компрометация критических систем/активов, продолжающиеся атаки, незнакомые/сложные методы, широко распространенное воздействие или внутренние угрозы.
            
            -   Оцените оповещение на предмет триггеров эскалации, учитывая потенциальные последствия, если не эскалировать.
            -   Соблюдайте внутренний процесс эскалации, уведомляя более высокие уровни команд/руководство, ответственные за реагирование на инциденты.
            -   Предоставьте исчерпывающую сводку оповещения, серьезность, потенциальное воздействие, обогащенные данные и оценку риска.
            -   Документируйте все сообщения, связанные с эскалацией.
            -   В некоторых случаях эскалируйте внешним организациям (правоохранительным органам, поставщикам реагирования на инциденты, CERT) на основе правовых/нормативных требований.

    11) Непрерывный мониторинг:

            -   Постоянно отслеживайте ситуацию и ход реагирования на инциденты.
            -   Поддерживайте открытую связь с эскалированными командами, предоставляя обновления о событиях, результатах или изменениях в серьезности/влиянии.
            -   Тесно сотрудничайте с эскалированными командами для скоординированного реагирования.

    12) Деэскалация:

            -   Оцените необходимость деэскалации по мере того, как реакция на инцидент прогрессирует и ситуация находится под контролем.
            -   Деэскалация проводится, когда риск снижен, инцидент локализован и дальнейшая эскалация не нужна.
            -   Уведомите соответствующие стороны, предоставив сводку предпринятых действий, результатов и извлеченных уроков.

Регулярно пересматривайте и обновляйте процесс, согласовывая его с организационными политиками, процедурами и руководящими принципами.
Адаптируйте процесс для устранения возникающих угроз и меняющихся потребностей.