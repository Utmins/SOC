Splunk — одно из ведущих решений SIEM на рынке, которое позволяет собирать, анализировать и сопоставлять сетевые и машинные журналы в режиме реального времени.

Официальный сайт    -   https://www.splunk.com/
Ознакомьтесь с документацией Splunk по навигации по Splunk здесь    -   https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/NavigatingSplunk


=====================================================================
* SPLUNK Components *
*********************

Splunk имеет три основных компонента, а именно

    -   Forwarder
    -   Indexer
    -   Search Head

    +++++++++++++
    + Forwarder +
    +++++++++++++

    Splunk Forwarder — это легкий агент, установленный на конечной точке, которую предполагается отслеживать
    Его основная задача — собирать данные и отправлять их в экземпляр Splunk.
    Он не влияет на производительность конечной точки, поскольку для его обработки требуется очень мало ресурсов.
    
    Вот некоторые из основных источников данных:

        -   Веб-сервер, генерирующий веб-трафик.
        -   Машина Windows, генерирующая журналы событий Windows, PowerShell и данные Sysmon.
        -   Хост Linux, генерирующий журналы, ориентированные на хост.
        -   База данных, генерирующая запросы на подключение к БД, ответы и ошибки.

    +++++++++++
    + Indexer +
    +++++++++++

    Индексатор Splunk играет главную роль в обработке данных, которые он получает от пересылок.
    Он берет данные, нормализует их в пары поле-значение, определяет тип данных и сохраняет их как события.
    Обработанные данные легко искать и анализировать.

    +++++++++++++++
    + Search Head +
    +++++++++++++++

    Splunk Search Head — это место в приложении Search & Reporting, где пользователи могут выполнять поиск в индексированных журналах.
    Когда пользователь ищет термин или использует язык поиска, известный как язык обработки поиска Splunk, запрос отправляется индексатору, и соответствующие события возвращаются в виде пар «поле-значение».

    Search Head также предоставляет возможность преобразовывать результаты в презентабельные таблицы и визуализации, такие как круговые диаграммы, гистограммы и столбчатые диаграммы

=====================================================================
* Navigating SPLUNK *
*********************

При доступе к Splunk вы увидите домашний экран по умолчанию

    *)  Верхняя панель — Splunk Bar

        На Splunk Bar вы можете

            -   просматривать системные сообщения (Messages)
            -   настраивать экземпляр Splunk (Settingsки)
            -   просматривать ход выполнения заданий (Activity)
            -   различную информацию, такую ​​как руководства (Help), и функцию поиска (Find).

        Возможность переключаться между установленными приложениями Splunk вместо использования панели приложений можно получить из панели Splunk
    
    *)  Далее идет Apps Panel.
        На этой панели вы можете увидеть приложения, установленные для экземпляра Splunk.

        Приложение по умолчанию для каждой установки Splunk — Search & Reporting.
    
    *)  Следующий раздел — Explore Splunk.
        Эта панель содержит быстрые ссылки для:
        
            -   добавления данных в экземпляр Splunk
            -   добавления новых приложений Splunk
            -   доступа к документации Splunk.
    
    *)  Последний раздел — Home Dashboard.
        По умолчанию панели мониторинга не отображаются.
        Вы можете выбрать из ряда панелей мониторинга, доступных в вашем экземпляре Splunk.
        Также можно выбрать панель мониторинга из раскрывающегося меню или посетив страницу со списком панелей мониторинга.

        Вы также можете создавать панели мониторинга и добавлять их на домашнюю панель мониторинга.
        Панели мониторинга, которые вы создаете, можно просматривать отдельно от других панелей мониторинга, нажав на вкладку Ваши.

=====================================================================
* Adding Data *
***************

Splunk может принимать любые данные.
Согласно документации Splunk, когда данные добавляются в Splunk, они обрабатываются и преобразуются в серию отдельных событий.

Источниками данных могут быть журналы событий, журналы веб-сайтов, журналы брандмауэров и т. д.
Источники данных сгруппированы по категориям.
Ниже приведен список диаграмм из документации Splunk, в котором подробно описана каждая категория источников данных.

    Data source	                Description
    Files and directories       Большинство данных, которые могут вас заинтересовать, поступают напрямую из файлов и каталогов.
    Network events              Программное обеспечение Splunk может индексировать удаленные данные с любого сетевого порта и события SNMP с удаленных устройств.
    IT Operations               Данные из ИТ-операций, таких как Nagios, NetApp и Cisco.
    Cloud services              Данные из облачных служб, таких как AWS и Kinesis.
    Database services           Данные из баз данных, таких как Oracle, MySQL и Microsoft SQL Server.
    Security services           Данные из служб безопасности, таких как McAfee, Microsoft Active Directory и Symantec Endpoint Protection.
    Virtualization services     Данные из служб виртуализации, таких как VMWare и XenApp.
    Application servers         Данные из серверов приложений, таких как JMX и JMS, WebLogic и WebSphere.
    Windows sources             Версия программного обеспечения Splunk для Windows принимает широкий спектр входных данных, специфичных для Windows, включая журнал событий Windows, реестр Windows, WMI, Active Directory и мониторинг производительности.
    Other sources               Поддерживаются другие источники входных данных, такие как очереди FIFO и скриптовые входные данные для получения данных из API, а также другие удаленные интерфейсы данных.

Для загрузки данных с нашего локального компьютера необходимо воспользоваться опцией Upload. Загрузите прикрепленный файл журнала и загрузите его на Splunk.
Для успешной загрузки данных требуется всего 5 шагов.

    1)  Select Source       ->  Где мы выбираем Источник журнала.
    2)  Select Source Type  ->  Выберите тип журналов, которые будут приниматься.
    3)  Input Settings      ->  Выберите индекс, куда будут выгружаться эти журналы, и имя хоста, которое будет связано с журналами.
    4)  Review              ->  Просмотр всех gif
    5)  Done                ->  Последний шаг, где данные успешно загружены и готовы к анализу

Существует НАМНОГО больше журналов, которые мы можем добавить в экземпляр Splunk, и Splunk поддерживает различные типы источников.

=====================================================================
* Incedent Handling *
*********************

Incident с точки зрения безопасности — это «Любое событие или действие, которое имеет негативные последствия для безопасности пользователя/компьютера или организации, считается инцидентом безопасности».
Ниже приведены некоторые события, которые могут негативно повлиять на окружающую среду, если они произошли:

    -   Сбой системы
    -   Выполнение нежелательной программы
    -   Доступ к конфиденциальной информации от неавторизованного пользователя
    -   Взлом веб-сайта злоумышленником
    -   Использование USB-устройств при наличии ограничений на использование противоречит политике компании

Как Incident Handler / SOC Analyst, мы стремимся узнать тактику, методы и процедуры атакующих.
Тогда мы сможем остановить/защитить/предотвратить атаку лучшим способом.
Процесс обработки инцидентов делится на четыре различных этапа

    1)  Preparation (Подготовка)

        Фаза подготовки охватывает готовность организации к атаке.
        Это означает документирование требований, определение политик, включение элементов управления безопасностью для мониторинга, таких как EDR / SIEM / IDS / IPS и т. д.
        Она также включает в себя найм/обучение персонала.
    
    2)  Detection and Analysis (Обнаружение и анализ)

        Фаза обнаружения охватывает все, что связано с обнаружением инцидента и процессом анализа инцидента.
        Эта фаза охватывает получение оповещений от элементов управления безопасностью, таких как SIEM/EDR, расследование оповещения для поиска первопричины.
        Она также охватывает поиск неизвестной угрозы внутри организации.
    
    3)  Containment, Eradication, and Recovery (Сдерживание, ликвидация и восстановление)

        Данная фаза охватывает действия, необходимые для предотвращения распространения инцидента и обеспечения безопасности сети.
        Она включает шаги, предпринимаемые для предотвращения распространения атаки в сети, изоляции зараженного хоста, очистки сети от следов заражения и восстановления контроля над атакой.
    
    4)  Post-Incident Activity / Lessons Learnt (Действия после инцидента/Извлеченные уроки)

        Эта фаза включает в себя выявление лазеек в состоянии безопасности организации, которые привели к вторжению, и улучшение, чтобы атака не повторилась в следующий раз.
        Шаги включают в себя выявление слабых мест, которые привели к атаке, добавление правил обнаружения, чтобы подобное нарушение не повторилось, и, что самое важное, обучение персонала, если это необходимо.

