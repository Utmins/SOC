Инструменты Sysinternals — это сборник из более чем 70+ инструментов на базе Windows.
Каждый из инструментов попадает в одну из следующих категорий:

    File and Disk Utilities
    Networking Utilities
    Process Utilities
    Security Utilities
    System Information
    Miscellaneous

Все инструменты из данного набора можно найти по следующим сайтам:

    https://live.sysinternals.com/
    https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite
    https://www.youtube.com/watch?v=A_TPZxuTzBU
    https://www.youtube.com/watch?v=vW8eAqZyWeo

Так как данная утилита содержит огромное количество интсрументов, то ниже будут описаны наиболее часто используемый по каждой категории

*** Почти все утилиты запускаются в комнадной строке используя лишь их название

    +++++++++++++++++++++++++++
    + File and Disk Utilities +
    +++++++++++++++++++++++++++

    Вот краткое содержание всех инструментов из категории File and Disk Utilities   -   https://learn.microsoft.com/en-us/sysinternals/downloads/file-and-disk-utilities

        ////////////////
        /// Sigcheck ///
        ////////////////

        Sigcheck — это утилита командной строки, которая показывает:
            номер версии файла
            информацию о временной метке
            сведения о цифровой подписи, включая цепочки сертификатов.
        
        Она также включает возможность:
            проверки статуса файла на VirusTotal
            загрузки файла для сканирования
        
        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/sigcheck

        К примеру   -   Надо проверит все файлы в папке с БД на VirusTotal

            ~> sigcheck -u -e "C:\path\to\the\folder" -accepteula

                -u  -   Если включена проверка VirusTotal, показывать файлы, которые неизвестны VirusTotal или имеют ненулевое обнаружение, в противном случае показывать только неподписанные файлы
                -e  -   Сканировать только исполняемые образы (независимо от их расширения)
                *** Ключ (-accepteula) не является обязательным, так как он всеголишь позволят автоматически (буз уведомления) принимать EULA соглашение

        ///////////////
        /// Streams ///
        ///////////////

        Файловая система NTFS предоставляет приложениям возможность создавать альтернативные потоки данных.
        По умолчанию все данные хранятся в основном безымянном потоке данных файла, но с помощью синтаксиса 'file:stream' вы можете читать и записывать альтернативы

        Альтернативные потоки данных (ADS) — это атрибут файла, специфичный для Windows NTFS (New Technology File System).
        Каждый файл имеет по крайней мере один поток данных ($DATA), и ADS позволяет файлам содержать более одного потока данных.
        Изначально проводник Windows не отображает ADS для пользователя.
        Существуют сторонние исполняемые файлы, которые можно использовать для просмотра этих данных, но Powershell дает вам возможность просматривать ADS для файлов.

        Авторы вредоносных программ использовали ADS для сокрытия данных в конечной точке, но не все его применения вредоносны.
        Когда вы загружаете файл из Интернета на конечную точку, в ADS записываются идентификаторы, указывающие, что он был загружен из Интернета

        К примеру   -   Надо посмотреть сущетсвуют ли скрытие потоки у исследуемго файта, сколько их и какие данные они содержат

            1)  Сперва проверяем на наличие скрытых потоком с информации
                Существет два способа:
                    
                    A) Powershell
                        Get-Item -Path .\<filename>.<ext> - stream *

                        PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\Users\Administrator\Desktop\file.txt::$DATA
                        PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\Users\Administrator\Desktop
                        PSChildName   : file.txt::$DATA
                        PSDrive       : C
                        PSProvider    : Microsoft.PowerShell.Core\FileSystem
                        PSIsContainer : False
                        FileName      : C:\Users\Administrator\Desktop\file.txt
                        Stream        : :$DATA
                        Length        : 0

                        PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\Users\Administrator\Desktop\file.txt:ads.txt
                        PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\Users\Administrator\Desktop
                        PSChildName   : file.txt:ads.txt
                        PSDrive       : C
                        PSProvider    : Microsoft.PowerShell.Core\FileSystem
                        PSIsContainer : False
                        FileName      : C:\Users\Administrator\Desktop\file.txt
                        Stream        : ads.txt
                        Length        : 26

                    B)  CMD
                        ~> streams C:\path\to\the\file.<ext> -accepteula
            
                        streams v1.60 - Reveal NTFS alternate streams.
                        Copyright (C) 2005-2016 Mark Russinovich
                        Sysinternals - www.sysinternals.com

                        C:\Users\Administrator\Desktop\file.txt:
                                :ads.txt:$DATA 26
            
                Результат от Powershell более детальный и информативный, хотя оба резултата предоставляют одинаково искому информацию
                Как видно из резултата, мы имеем 26 скрытых потоков и файл "ads.txt"
            
            2)  Затем нам надо проверить содержание скртытого файла.
                Можно воспользоваться 2 способами:

                    A)  Powershell
                        ~> Get-Content -Path .\<filename>.<ext> stream <found_hidden_filename>.<ext>

                        I am hiding in the stream.
                        PS C:\Users\Administrator\Desktop>
                    
                    B)  CMD
                        ~> notepad <original_filename>.<ext>:<hidden_filename>.<ext>    -   Для сохранения результат в текстовом файле через notepad
                        ЛИБО
                        ~> more <original_filename>.<ext>:<hidden_filename>.<ext>       -   Для отображения результат в терминале


        
        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/streams

        ////////////////
        /// SDeletes ///
        ////////////////

        SDelete — это утилита командной строки, которая принимает ряд параметров.
        В любом конкретном случае она позволяет вам удалить один или несколько файлов и/или каталогов или очистить свободное место на логическом диске».

        Согласно официальной странице документации, SDelete (Secure Delete) реализовала протокол очистки и дезинфекции Министерства обороны США (DOD 5220.22-M).

        SDelete использовался злоумышленниками и связан с методами MITRE T1485 (уничтожение данных) и T1070.004 (удаление индикатора на хосте: удаление файла).
        Его идентификатор MITRE S0195.

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/sdelete

    ++++++++++++++++++++++++
    + Networking Utilities +
    ++++++++++++++++++++++++

    Вот краткое содержание всех инструментов из категории Networking Utilities   -   https://learn.microsoft.com/en-us/sysinternals/downloads/networking-utilities

        ///////////////
        /// TCPView ///
        ///////////////

        TCPView — это программа Windows, которая покажет вам подробные списки всех конечных точек TCP и UDP в вашей системе, включая локальные и удаленные адреса и состояние TCP-подключений.
        В Windows Server 2008, Vista и XP TCPView также сообщает имя процесса, которому принадлежит конечная точка.
        TCPView предоставляет более информативное и удобно представленное подмножество программы Netstat, которая поставляется с Windows.
        Загрузка TCPView включает Tcpvcon, версию командной строки с той же функциональностью.

        Сейчас самое время упомянуть, что в Windows есть встроенная утилита, которая обеспечивает ту же функциональность.
        Этот инструмент называется Resource Monitor.
        Есть много способов открыть этот инструмент.
        Из командной строки используйте resmon.

        ПРи использование TCPView мы можем применить дополнительную фильтрацию, отключив TCP v4, TCP v6, UDP v4 и UDP v6 на верхней панели инструментов, в зависимости от того, какие протоколы мы хотим отобразить.
        Более того, мы можем нажать на зеленый флаг, чтобы использовать фильтр состояний.
        Нажатие на зеленый флажок открывает Фильтр состояний, который предоставляет обширный список опций для выбора состояний соединения, которые мы хотим отобразить.
        Большинство доступных состояний соединения применимы только к соединениям TCP. (UDP, будучи протоколом без соединения, не может предложить такую ​​гибкость в фильтрации.)

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/tcpview

    +++++++++++++++++++++
    + Process Utilities +
    +++++++++++++++++++++

    Вот краткое содержание всех инструментов из категории Process Utilities   -   https://learn.microsoft.com/en-us/sysinternals/downloads/process-utilities

        ////////////////
        /// Autoruns ///
        ////////////////

        Эта утилита, которая обладает наиболее полными знаниями о местах автозапуска среди всех мониторов автозагрузки
        Она показывает, какие программы настроены для запуска во время загрузки системы или входа в систему, а также при запуске различных встроенных приложений Windows, таких как Internet Explorer, Explorer и медиаплееры.
        Эти программы и драйверы включают те, что находятся в папке автозагрузки, Run, RunOnce и других разделах реестра.
        
        Autoruns сообщает о:
        
            -   расширениях оболочки Explorer
            -   панелях инструментов
            -   объектах вспомогательных функций браузера
            -   уведомлениях Winlogon
            -   службах автозапуска
            -   и многом другом
        
        Autoruns выходит далеко за рамки других утилит автозапуска

        *** Это хороший инструмент для поиска любых вредоносных записей, созданных на локальном компьютере, для установления персистентности.

        ////////////////
        /// ProcDump ///
        ////////////////

        ProcDump — это утилита командной строки, основной целью которой является мониторинг приложения на предмет скачков загрузки ЦП и создание аварийных дампов во время скачков, которые администратор или разработчик может использовать для определения причины скачка

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/procdump

        ////////////////////////
        /// Process Explorer ///
        ////////////////////////

        Дисплей Process Explorer состоит из двух подокнов.
        Верхнее окно всегда показывает список активных в данный момент процессов, включая имена их учетных записей
        Тогда как информация, отображаемая в нижнем окне, зависит от режима, в котором находится Process Explorer:
            -   если он находится в режиме дескрипторов, вы увидите дескрипторы, которые открыл процесс, выбранный в верхнем окне
            -   если Process Explorer находится в режиме DLL, вы увидите библиотеки DLL и отображенные в память файлы, которые загрузил процесс
        
        Для запуска данной утилиты в комнадной строке   -   procexp

        Как упоминалось в описании ProcExp, в нижнем окне мы можем видеть открытые дескрипторы, связанные с процессом.

        В ProcExp есть опция для проверки подписей.
        После включения она отображается как столбец в представлении процесса

        Другие параметры, на которые стоит обратить внимание, включают «Run at Logon» ​​и «Replace Task Manager».

        Вы могли заметить, что некоторые процессы в Process Explorer имеют разные цвета.
        Эти цвета имеют значение:

            -   Green       -   новый процесс, который только что был запущен.
            -   Red         -   процессы, которые только что завершились.
            -   Light Blue  -   процессы, запущенные под той же учетной записью пользователя, что и Procexp.
            -   Pink        -   процессы, содержащие одну или несколько служб Windows.
            -   Dark Grey   -   приостановленные процессы.
                                Это процессы, в которых все потоки приостановлены и не могут быть запланированы для выполнения.
            -   Violet      -   «packed images».
                                Procexp использует простую эвристику для определения программных файлов, которые могут содержать исполняемый код в сжатой форме, зашифрованной форме или и в том, и в другом.
            -   Yellow      -   процессы .NET
                                Это процессы, которые используют Microsoft .NET Framework.
            -   Brown       -   процессы, которые были связаны с заданием.

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer

        ///////////////////////
        /// Process Monitor ///
        ///////////////////////

        Process Monitor — это усовершенствованный инструмент мониторинга для Windows, который в режиме реального времени отображает файловую систему, реестр и активность процессов/потоков.
        Он объединяет функции двух устаревших утилит Filemon и Regmon, и добавляет обширный список улучшений, включая
        
            -   расширенную и неразрушающую фильтрацию
            -   комплексные свойства событий, такие как идентификаторы сеансов и имена пользователей
            -   надежную информацию о процессах
            -   полные стеки потоков с интегрированной поддержкой символов для каждой операции
            -   одновременную запись в файл
            -   и многое другое.
        
        Для запуска данной утилиты в комнадной строке   -   procmon

        К примеру, он позволяет увидеть некоторые из файловых операций, которые были захвачены (отностся к выбранному PID), а также путь к файлу или путь/ключ реестра, по которому произошло действие, и результат операции

        ProcMon будет захватывать тысячи и тысячи событий, происходящих в операционной системе.
        При этом, опцию захвата событий можно включать и выключать.

        *** Для эффективного использования ProcMon необходимо использовать фильтр и правильно его настроить.

        Подробная информация    -   https://adamtheautomator.com/procmon/
                                    https://learn.microsoft.com/en-us/sysinternals/downloads/procmon

        //////////////
        /// PsExec ///
        //////////////

        PsExec — это облегченная замена telnet, которая позволяет вам выполнять процессы на других системах, с полной интерактивностью для консольных приложений, без необходимости вручную устанавливать клиентское программное обеспечение.
        Наиболее мощные возможности PsExec включают запуск интерактивных командных строк на удаленных системах и инструменты удаленного включения, такие как IpConfig, которые в противном случае не имеют возможности отображать информацию об удаленных системах

        PsExec — еще один инструмент, используемый злоумышленниками.
        Этот инструмент связан с методами MITRE T1570 (Lateral Tool Transfer), T1021.002 (Remote Services: SMB/Windows Admin Shares) и T1569.002 (System Services: Service Execution).
        Его идентификатор MITRE — S0029.

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
                                    https://adamtheautomator.com/psexec/

    ++++++++++++++++++++++
    + Security Utilities +
    ++++++++++++++++++++++

    Вот краткое содержание всех инструментов из категории Security Utilities   -   https://learn.microsoft.com/en-us/sysinternals/downloads/security-utilities

        //////////////
        /// Sysmon ///
        //////////////

        Системный монитор (Sysmon) — это системная служба Windows и драйвер устройства, который после установки в системе остается резидентным при перезагрузках системы для мониторинга и регистрации активности системы в журнале событий Windows.
        Он предоставляет подробную информацию о создании процессов, сетевых подключениях и изменениях времени создания файлов.
        
        Собирая события, которые он генерирует, с помощью сбора событий Windows или агентов SIEM и затем анализируя их, вы можете определить вредоносную или аномальную активность и понять, как злоумышленники и вредоносное ПО действуют в вашей сети

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon

    ++++++++++++++++++++++
    + System Information +
    ++++++++++++++++++++++

    Вот краткое содержание всех инструментов из категории System Information   -   https://learn.microsoft.com/en-us/sysinternals/downloads/security-utilities

        //////////////
        /// WinObj ///
        //////////////

        WinObj — это 32-разрядная программа Windows NT, которая использует собственный API Windows NT (предоставляемый NTDLL.DLL) для доступа и отображения информации о пространстве имен диспетчера объектов NT

        Чтобы продемонстрировать этот инструмент, давайте рассмотрим концепцию сеанса 0 и сеанса 1, упомянутую в комнате основных процессов Windows.
        Помните, что сеанс 0 — это сеанс ОС, а сеанс 1 — сеанс пользователя.
        Также помните, что будет запущено не менее 2 процессов csrss.exe, по одному на каждый сеанс.
        Обратите внимание, что сеанс 1 будет для первого пользователя, вошедшего в систему.

        В сеансе 0 в разделе DosDevices есть запись для сетевого диска, который был смонтирован на локальной машине.
            Давайте посмотрим на значение WindowStations для сеанса 1.
                Давайте сравним эту информацию с Process Explorer.
        
        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/winobj

    +++++++++++++++++
    + Miscellaneous +
    +++++++++++++++++

    Вот краткое содержание всех инструментов из категории System Information   -   https://learn.microsoft.com/en-us/sysinternals/downloads/system-information

        //////////////
        /// BgInfo ///
        //////////////

        Он автоматически отображает на рабочем столе соответствующую информацию о компьютере с Windows, такую ​​как имя компьютера, IP-адрес, версию пакета обновления и многое другое

        Это удобная утилита, если вы управляете несколькими машинами.
        Этот инструмент или подобные инструменты обычно используются на серверах.
        Когда пользователь подключается к серверу по RDP, системная информация отображается на обоях, чтобы предоставить быструю информацию о сервере, например, имя сервера.

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/bginfo

        ///////////////
        /// RegJump ///
        ///////////////

        Этот небольшой апплет командной строки берет путь реестра и делает Regedit открытым для этого пути.
        Он принимает корневые ключи в стандартной (например, HKEY_LOCAL_MACHINE) и сокращенной форме (например, HKLM)

        При навигации по реестру с помощью редактора реестра необходимо вручную перейти к ключу, который вы хотите проверить.
        Существует несколько способов запроса реестра Windows без использования редактора реестра
            -   через командную строку (reg query)
            -   PowerShell (Get-Item/Get-ItemProperty).

        Использование Regjump откроет редактор реестра и автоматически откроет редактор непосредственно по пути, поэтому вам не нужно будет перемещаться по нему вручную

        ///////////////
        /// Strings ///
        ///////////////

        Strings просто сканирует файл, который вы ему передаете, на наличие строк UNICODE (или ASCII) длиной по умолчанию 3 или более символов UNICODE (или ASCII).
        Обратите внимание, что он работает и под Windows 95

        Это инструмент, который использовался на 21-й день AoC2 для проверки загадочного двоичного файла.

        К примеру, мы хотим найти интресующий нас набор символов в двоичном файле ZoomIt.exe любой строки, содержащей слово «zoom». 

            ~> strings .\ZoomIt.exe | findstr /i zoom*

        Подробная информация    -   https://learn.microsoft.com/en-us/sysinternals/downloads/strings

