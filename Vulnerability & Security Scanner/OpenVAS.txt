OpenVAS (Open Vulnerability Assessment Scanner) -   приложение, используемое для сканирования конечных точек и веб-приложений с целью выявления и обнаружения уязвимостей.

Это служба в рамках более крупной структуры служб, известной как Greenbone Vulnerability Management (GVM).
Он используется для устройств Greenbone Security Manager и представляет собой полнофункциональный движок сканирования, который выполняет постоянно обновляемую и расширенную подачу тестов на сетевую уязвимость (NVT)

Обычно корпорации используют его в качестве части своих решений по смягчению последствий для быстрого выявления любых пробелов в своих производственных или даже разрабатываемых серверах или приложениях.
Это не решение для всех, но оно может помочь избавиться от любых распространенных уязвимостей, которые могли ускользнуть от внимания.

Существует множество компонентов, которые являются частью архитектуры фреймворка GVM, но мы можем разбить его на три отдельных раздела:

    i)      Front-End
            Это то, с чем вы взаимодействуете, когда переходите в OpenVAS в своем браузере.
            Веб-интерфейсы построены на основе Greenbone Security Assistant и облегчают жизнь аналитику или оператору при работе с OpenVAS или другими формами сканеров через GVM.

    ii)     Back-End
            Инфраструктура бэкэнда — это то, что фактически будет проводить все сканирование уязвимостей и обработку данных и NVTS через OpenVAS и GVM.
            Greenbone Vulnerability Manager будет посредником между сканерами и интерфейсами пользователя фронтэнда.3

    iii)    Vulnerability/Information Feed.
            Этот раздел будет содержать всю информацию и тесты уязвимостей, которые поступают из Greenbone Community Feed, которые будут основной базой для тестирования систем.
            Это также может включать Пользовательские данные, предоставленные пользователем вместо Greenbone NVT и SCAP CERT.

Для получения дополнительной информации об архитектуре фреймворка GVM ознакомьтесь с этой записью на форуме -   https://forum.greenbone.net/t/about-gvm-10-architecture/1231

=====================================================================
* Installation *
****************

Процедура установки OpenVAS может различаться в зависимости от того, как вы решите установить.
Вы можете установить из:

    -   Репозиториев Kali/OpenVAS
        Установка из репозиториев иногда может быть очень простой или очень болезненной.
        Для OpenVAS установка варьируется по сложности и может потребовать много конфигураций.
        Для получения дополнительной информации об этой опции ознакомьтесь с руководствами ниже

            https://geekrewind.com/how-to-install-and-configure-openvas-on-ubuntu-18-04-16-04/
            https://agix.com.au/installing-openvas-on-kali-in-2020/

    -   Установить из исходного кода
        Это наименее предпочтительный вариант для новичков и наименее оптимизированный способ установки OpenVAS из-за предварительных условий и ошибок.
        Для получения дополнительной информации об установке из исходного кода см. INSTALL.MD.

            https://github.com/greenbone/openvas-scanner/blob/main/INSTALL.md

    -   Запустить из контейнера Docker
        Docker — самый простой из всех трех методов установки
        Для этой процедуры установки вам понадобится установленный docker.
        Для получения дополнительной информации об этой процедуре ознакомьтесь с проектом openvas-docker на GitHub и DockerHub.

            https://github.com/mikesplain/openvas-docker
            https://hub.docker.com/r/mikesplain/openvas/dockerfile
    
        Вот список комнад для установки/запуска через докер
        
            1)  apt install docker.io
                Установка докрера
            2)  docker run -d -p 443:443 --name openvas mikesplain/openvas
                Эта команда одновременно вытащит контейнер docker и запустит его.
                Полная настройка и запуск контейнера могут занять несколько минут.
                После завершения вы можете перейти по адресу https://127.0.0.1 в предпочитаемом вами браузере, и OpenVAS будет настроен и готов к работе!
            3)  Ниже приведены учетные данные по умолчанию для доступа к OpenVAS/GVM
                    Username: admin
                    Password: admin

=====================================================================
* Initial Configuration *
*************************

Прежде чем мы сможем начать сканирование и внедрение OpenVAS в наше решение по управлению уязвимостями, нам нужно выполнить небольшое обслуживание и настройку, чтобы OpenVAS работал правильно.
К счастью для нас, OpenVAS делает этот процесс очень простым и включает в себя мастер, чтобы сделать процесс простым.

Начните с перехода в Scans > Tasks и нажмите на значок "фиолетовой волшебной палочки", чтобы запустить базовый мастер настройки.
Мы рекомендуем начать сканирование на 127.0.0.1, чтобы протестировать вашу установку и убедиться, что она работает правильно

Сканирование может занять некоторое время, дайте OpenVAS достаточно времени для завершения сканирования, а затем вы увидите новую панель мониторинга и анализа ваших полных и текущих сканирований.
После завершения сканирования вы можете перейти в раздел Scans > Reports и нажать на ваш недавно созданный отчет из предыдущей задачи.
При правильной настройке вы должны увидеть три различных уязвимости, все из которых исходят от самого OpenVAS.
Это нормальное поведение, и его можно настроить/изменить для поддержания OpSec

=====================================================================
* Scanning Settings *
*********************

Теперь, когда мы знаем, что все работает, мы можем перейти к тонкостям OpenVAS и принципам его работы.
Разверните машину и перейдите в Scans > Tasks, чтобы начать создание задачи для сканирования предоставленной машины.

Чтобы создать настраиваемую задачу, перейдите к значку "ЗВЕЗДОЧКА" (рядом со значком "фиолетовой волшебной палочки") в правом верхнем углу панели задач и выберите New Task.

Для базового (простого) сканирования мы сосредоточимся только на следующих полях:

    -   Name
        Позволяет нам задать имя, под которым сканирование будет известно внутри OpenVAS

    -   Scan Targets
        Цели для сканирования могут включать хосты, порты и учетные данные.
        Чтобы создать новую цель, вам нужно будет следовать другому всплывающему окну.

    -   Scanner
        Сканер, который будет использоваться по умолчанию, будет использовать архитектуру OpenVAS, однако вы можете установить его на любой сканер по вашему выбору в меню настроек.

    -   Scan Config (Конфигурация сканирования)
        OpenVAS имеет семь различных типов сканирования, которые вы можете выбрать, и они будут использоваться в зависимости от того, насколько вы агрессивны или какую информацию вы хотите собрать в ходе сканирования.

Теперь, когда у нас есть область действия цели, мы можем продолжить создание нашей задачи и начать сканирование.
После создания задачи вы вернетесь на панель управления сканированием, где вы сможете отслеживать и запускать свою задачу.
Чтобы запустить задачу, перейдите к значку запуска (зеленый треугольник) в разделе/колонке Actions.

=====================================================================
* Continuous Monitoring Overview *
**********************************

OpenVAS предлагает множество вариантов для непрерывного и запланированного мониторинга/управления уязвимостями.
Если вы работаете в команде или конвейере, это может позволить вам эффективно и быстро оптимизировать ваши текущие решения.
Примерами утилит непрерывного сканирования уязвимостей являются оповещения, расписания и агенты.

    ++++++++++++++++++++++
    + Creating Schedules +
    ++++++++++++++++++++++

    Сперва мы рассмотрим настройку расписаний и оповещений.

    Чтобы начать создание расписания, перейдите в Configuration > Schedules и, как всегда, нажмите на значок "голубой звезды" в верхнем левом углу.
    Заполните основную информацию, такую ​​как:

        -   Name
        -   First Start Time
        -   Period
        -   etc

    После того, как вы создали расписание, вы можете создать новую задачу/сканирование с прикрепленным созданным расписанием.

    +++++++++++++++++++
    + Crafting Alerts +
    +++++++++++++++++++

    Процесс создания оповещений очень похож на создание расписания
    Перейдите в Configuration > Alerts и нажмите на значок "голубой звезды" в верхнем левом углу.

    Вы заметите, что здесь гораздо больше опций, чем в меню расписания
    Основные опции, о которых вам нужно будет беспокоиться, это:
    
        -   Name

        -   Event
            Событие можно настроить на оповещение на основе Status of the Scan или при обнаружении нового NVT/уязвимости

        -   Condition
            Опция Condition гарантирует, что ваш почтовый ящик не будет переполнен оповещениями (это можно изменить на основе серьезности или фильтров).

        -   To Address
            Адрес получателя довольно понятен и отправит электронное письмо с оповещением на указанный адрес электронной почты.
    
    После создания вам снова нужно будет подключить оповещение к новой Task/Scan.
    